import{C as e,D as t,E as l,G as s,H as i,I as a,J as o,o as r,a as n,w as u,h as d,F as c,j as p,n as h,b as f,s as m,f as y,k as g,r as v,l as _,i as b,K as F,e as x,t as k,L as w,m as I,v as T,p as P,d as S,M as C,N as V,O as $}from"./index-C69BgsYY.js";import{_ as j}from"./u-button.CQyuZRx3.js";import{o as L,r as M}from"./uni-app.es.4Bntlf4B.js";import{_ as O}from"./uni-icons.DbPdresR.js";import{_ as E}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as A}from"./u-icon.yGbbo8IR.js";import{_ as U}from"./square-item.CHDz5Yf_.js";import{_ as D}from"./u-popup.CZC_HG1o.js";import{g as B,h as z,i as N}from"./api.ClmPzCnk.js";import{g as R}from"./check.CqE10ALw.js";import"./u-tag.Dl-Gh5KS.js";const J="chooseAndUploadFile:fail";function q(e,t){return e.tempFiles.forEach(((e,l)=>{e.name||(e.name=e.path.substring(e.path.lastIndexOf("/")+1)),t&&(e.fileType=t),e.cloudPath=Date.now()+"_"+l+e.name.substring(e.name.lastIndexOf("."))})),e.tempFilePaths||(e.tempFilePaths=e.tempFiles.map((e=>e.path))),e}function H(t,l=5,s){const i=(t=JSON.parse(JSON.stringify(t))).length;let a=0,o=this;return new Promise((r=>{for(;a<l;)n();function n(){let l=a++;if(l>=i)return void(!t.find((e=>!e.url&&!e.errMsg))&&r(t));const u=t[l],d=o.files.findIndex((e=>e.uuid===u.uuid));u.url="",delete u.errMsg,e.uploadFile({filePath:u.path,cloudPath:u.cloudPath,fileType:u.fileType,onUploadProgress:e=>{e.index=d,s&&s(e)}}).then((e=>{u.url=e.fileID,u.index=d,l<i&&n()})).catch((e=>{u.errMsg=e.errMsg||e.message,u.index=d,l<i&&n()}))}}))}function G(e,{onChooseFile:t,onUploadProgress:l}){return e.then((e=>{if(t){const l=t(e);if(void 0!==l)return Promise.resolve(l).then((t=>void 0===t?e:t))}return e})).then((e=>!1===e?{errMsg:"chooseAndUploadFile:ok",tempFilePaths:[],tempFiles:[]}:e))}function K(e={type:"all"}){return"image"===e.type?G(function(e){const{count:l,sizeType:s=["original","compressed"],sourceType:i,extension:a}=e;return new Promise(((e,o)=>{t({count:l,sizeType:s,sourceType:i,extension:a,success(t){e(q(t,"image"))},fail(e){o({errMsg:e.errMsg.replace("chooseImage:fail",J)})}})}))}(e),e):"video"===e.type?G(function(e){const{count:t,camera:s,compressed:i,maxDuration:a,sourceType:o,extension:r}=e;return new Promise(((e,t)=>{l({camera:s,compressed:i,maxDuration:a,sourceType:o,extension:r,success(t){const{tempFilePath:l,duration:s,size:i,height:a,width:o}=t;e(q({errMsg:"chooseVideo:ok",tempFilePaths:[l],tempFiles:[{name:t.tempFile&&t.tempFile.name||"",path:l,size:i,type:t.tempFile&&t.tempFile.type||"",width:o,height:a,duration:s,fileType:"video",cloudPath:""}]},"video"))},fail(e){t({errMsg:e.errMsg.replace("chooseVideo:fail",J)})}})}))}(e),e):G(function(e){const{count:t,extension:l}=e;return new Promise(((e,i)=>{let a=s;if("undefined"!=typeof wx&&"function"==typeof wx.chooseMessageFile&&(a=wx.chooseMessageFile),"function"!=typeof a)return i({errMsg:J+" 请指定 type 类型，该平台仅支持选择 image 或 video。"});a({type:"all",count:t,extension:l,success(t){e(q(t))},fail(e){i({errMsg:e.errMsg.replace("chooseFile:fail",J)})}})}))}(e),e)}const Q=e=>{const t=e.lastIndexOf("."),l=e.length;return{name:e.substring(0,t),ext:e.substring(t+1,l)}},W=e=>{if(Array.isArray(e))return e;return e.replace(/(\[|\])/g,"").split(",")},X=async(e,t="image")=>{const l=Q(e.name).ext.toLowerCase();let s={name:e.name,uuid:e.uuid,extname:l||"",cloudPath:e.cloudPath,fileType:e.fileType,thumbTempFilePath:e.thumbTempFilePath,url:e.path||e.path,size:e.size,image:{},path:e.path,video:{}};if("image"===t){const t=await(i=e.path,new Promise(((e,t)=>{a({src:i,success(t){e(t)},fail(e){t(e)}})})));delete s.video,s.image.width=t.width,s.image.height=t.height,s.image.location=t.path}else delete s.image;var i;return s};const Y=E({name:"uniFilePicker",components:{uploadImage:E({name:"uploadImage",emits:["uploadFiles","choose","delFile"],props:{filesList:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},disablePreview:{type:Boolean,default:!1},limit:{type:[Number,String],default:9},imageStyles:{type:Object,default:()=>({width:"auto",height:"auto",border:{}})},delIcon:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1}},computed:{styles(){return Object.assign({width:"auto",height:"auto",border:{}},this.imageStyles)},boxStyle(){const{width:e="auto",height:t="auto"}=this.styles;let l={};"auto"===t?"auto"!==e?(l.height=this.value2px(e),l["padding-top"]=0):l.height=0:(l.height=this.value2px(t),l["padding-top"]=0),l.width="auto"===e?"auto"!==t?this.value2px(t):"33.3%":this.value2px(e);let s="";for(let i in l)s+=`${i}:${l[i]};`;return s},borderStyle(){let{border:e}=this.styles,t={};if("boolean"==typeof e)t.border=e?"1px #eee solid":"none";else{let l=e&&e.width||1;l=this.value2px(l);let s=e&&e.radius||3;s=this.value2px(s),t={"border-width":l,"border-style":e&&e.style||"solid","border-color":e&&e.color||"#eee","border-radius":s}}let l="";for(let s in t)l+=`${s}:${t[s]};`;return l}},methods:{uploadFiles(e,t){this.$emit("uploadFiles",e)},choose(){this.$emit("choose")},delFile(e){this.$emit("delFile",e)},prviewImage(e,t){let l=[];1===Number(this.limit)&&this.disablePreview&&!this.disabled&&this.$emit("choose"),this.disablePreview||(this.filesList.forEach((e=>{l.push(e.url)})),o({urls:l,current:t}))},value2px:e=>("number"==typeof e?e+="px":-1===e.indexOf("%")&&(e=-1!==e.indexOf("px")?e:e+"px"),e)}},[["render",function(e,t,l,s,i,a){const o=_,x=b,k=F;return r(),n(x,{class:"uni-file-picker__container"},{default:u((()=>[(r(!0),d(c,null,p(l.filesList,((e,t)=>(r(),n(x,{class:"file-picker__box",key:t,style:h(a.boxStyle)},{default:u((()=>[f(x,{class:"file-picker__box-content",style:h(a.borderStyle)},{default:u((()=>[f(o,{class:"file-image",src:e.url,mode:"aspectFill",onClick:m((l=>a.prviewImage(e,t)),["stop"])},null,8,["src","onClick"]),l.delIcon&&!l.readonly?(r(),n(x,{key:0,class:"icon-del-box",onClick:m((e=>a.delFile(t)),["stop"])},{default:u((()=>[f(x,{class:"icon-del"}),f(x,{class:"icon-del rotate"})])),_:2},1032,["onClick"])):y("",!0),e.progress&&100!==e.progress||0===e.progress?(r(),n(x,{key:1,class:"file-picker__progress"},{default:u((()=>[f(k,{class:"file-picker__progress-item",percent:-1===e.progress?0:e.progress,"stroke-width":"4",backgroundColor:e.errMsg?"#ff5a5f":"#EBEBEB"},null,8,["percent","backgroundColor"])])),_:2},1024)):y("",!0),e.errMsg?(r(),n(x,{key:2,class:"file-picker__mask",onClick:m((l=>a.uploadFiles(e,t)),["stop"])},{default:u((()=>[g(" 点击重试 ")])),_:2},1032,["onClick"])):y("",!0)])),_:2},1032,["style"])])),_:2},1032,["style"])))),128)),l.filesList.length<l.limit&&!l.readonly?(r(),n(x,{key:0,class:"file-picker__box",style:h(a.boxStyle)},{default:u((()=>[f(x,{class:"file-picker__box-content is-add",style:h(a.borderStyle),onClick:a.choose},{default:u((()=>[v(e.$slots,"default",{},(()=>[f(x,{class:"icon-add"}),f(x,{class:"icon-add rotate"})]),!0)])),_:3},8,["style","onClick"])])),_:3},8,["style"])):y("",!0)])),_:3})}],["__scopeId","data-v-86b162f5"]]),uploadFile:E({name:"uploadFile",emits:["uploadFiles","choose","delFile"],props:{filesList:{type:Array,default:()=>[]},delIcon:{type:Boolean,default:!0},limit:{type:[Number,String],default:9},showType:{type:String,default:""},listStyles:{type:Object,default:()=>({border:!0,dividline:!0,borderStyle:{}})},readonly:{type:Boolean,default:!1}},computed:{list(){let e=[];return this.filesList.forEach((t=>{e.push(t)})),e},styles(){return Object.assign({border:!0,dividline:!0,"border-style":{}},this.listStyles)},borderStyle(){let{borderStyle:e,border:t}=this.styles,l={};if(t){let t=e&&e.width||1;t=this.value2px(t);let s=e&&e.radius||5;s=this.value2px(s),l={"border-width":t,"border-style":e&&e.style||"solid","border-color":e&&e.color||"#eee","border-radius":s}}else l.border="none";let s="";for(let i in l)s+=`${i}:${l[i]};`;return s},borderLineStyle(){let e={},{borderStyle:t}=this.styles;if(t&&t.color&&(e["border-color"]=t.color),t&&t.width){let l=t&&t.width||1,s=t&&t.style||0;"number"==typeof l?l+="px":l=l.indexOf("px")?l:l+"px",e["border-width"]=l,"number"==typeof s?s+="px":s=s.indexOf("px")?s:s+"px",e["border-top-style"]=s}let l="";for(let s in e)l+=`${s}:${e[s]};`;return l}},methods:{uploadFiles(e,t){this.$emit("uploadFiles",{item:e,index:t})},choose(){this.$emit("choose")},delFile(e){this.$emit("delFile",e)},value2px:e=>("number"==typeof e?e+="px":e=-1!==e.indexOf("px")?e:e+"px",e)}},[["render",function(e,t,l,s,i,a){const o=b,_=F;return r(),n(o,{class:"uni-file-picker__files"},{default:u((()=>[l.readonly?y("",!0):(r(),n(o,{key:0,class:"files-button",onClick:a.choose},{default:u((()=>[v(e.$slots,"default",{},void 0,!0)])),_:3},8,["onClick"])),a.list.length>0?(r(),n(o,{key:1,class:"uni-file-picker__lists is-text-box",style:h(a.borderStyle)},{default:u((()=>[(r(!0),d(c,null,p(a.list,((e,t)=>(r(),n(o,{class:x(["uni-file-picker__lists-box",{"files-border":0!==t&&a.styles.dividline}]),key:t,style:h(0!==t&&a.styles.dividline&&a.borderLineStyle)},{default:u((()=>[f(o,{class:"uni-file-picker__item"},{default:u((()=>[f(o,{class:"files__name"},{default:u((()=>[g(k(e.name),1)])),_:2},1024),l.delIcon&&!l.readonly?(r(),n(o,{key:0,class:"icon-del-box icon-files",onClick:e=>a.delFile(t)},{default:u((()=>[f(o,{class:"icon-del icon-files"}),f(o,{class:"icon-del rotate"})])),_:2},1032,["onClick"])):y("",!0)])),_:2},1024),e.progress&&100!==e.progress||0===e.progress?(r(),n(o,{key:0,class:"file-picker__progress"},{default:u((()=>[f(_,{class:"file-picker__progress-item",percent:-1===e.progress?0:e.progress,"stroke-width":"4",backgroundColor:e.errMsg?"#ff5a5f":"#EBEBEB"},null,8,["percent","backgroundColor"])])),_:2},1024)):y("",!0),"error"===e.status?(r(),n(o,{key:1,class:"file-picker__mask",onClick:m((l=>a.uploadFiles(e,t)),["stop"])},{default:u((()=>[g(" 点击重试 ")])),_:2},1032,["onClick"])):y("",!0)])),_:2},1032,["class","style"])))),128))])),_:1},8,["style"])):y("",!0)])),_:3})}],["__scopeId","data-v-5d376bd5"]])},options:{virtualHost:!0},emits:["select","success","fail","progress","delete","update:modelValue","input"],props:{modelValue:{type:[Array,Object],default:()=>[]},disabled:{type:Boolean,default:!1},disablePreview:{type:Boolean,default:!1},delIcon:{type:Boolean,default:!0},autoUpload:{type:Boolean,default:!0},limit:{type:[Number,String],default:9},mode:{type:String,default:"grid"},fileMediatype:{type:String,default:"image"},fileExtname:{type:[Array,String],default:()=>[]},title:{type:String,default:""},listStyles:{type:Object,default:()=>({border:!0,dividline:!0,borderStyle:{}})},imageStyles:{type:Object,default:()=>({width:"auto",height:"auto"})},readonly:{type:Boolean,default:!1},returnType:{type:String,default:"array"},sizeType:{type:Array,default:()=>["original","compressed"]},sourceType:{type:Array,default:()=>["album","camera"]},provider:{type:String,default:""}},data:()=>({files:[],localValue:[]}),watch:{modelValue:{handler(e,t){this.setValue(e,t)},immediate:!0}},computed:{filesList(){let e=[];return this.files.forEach((t=>{e.push(t)})),e},showType(){return"image"===this.fileMediatype?this.mode:"list"},limitLength(){return"object"===this.returnType?1:this.limit?this.limit>=9?9:this.limit:1}},created(){e.config&&e.config.provider||(this.noSpace=!0,e.chooseAndUploadFile=K),this.form=this.getForm("uniForms"),this.formItem=this.getForm("uniFormsItem"),this.form&&this.formItem&&this.formItem.name&&(this.rename=this.formItem.name,this.form.inputChildrens.push(this))},methods:{clearFiles(e){0===e||e?this.files.splice(e,1):(this.files=[],this.$nextTick((()=>{this.setEmit()}))),this.$nextTick((()=>{this.setEmit()}))},upload(){let e=[];return this.files.forEach(((t,l)=>{"ready"!==t.status&&"error"!==t.status||e.push(Object.assign({},t))})),this.uploadFiles(e)},async setValue(e,t){const l=async e=>{let t="";return t=e.fileID?e.fileID:e.url,/cloud:\/\/([\w.]+\/?)\S*/.test(t)&&(e.fileID=t,e.url=await this.getTempFileURL(t)),e.url&&(e.path=e.url),e};if("object"===this.returnType)e?await l(e):e={};else{e||(e=[]);for(let t=0;t<e.length;t++){let s=e[t];await l(s)}}this.localValue=e,this.form&&this.formItem&&!this.is_reset&&(this.is_reset=!1,this.formItem.setValue(this.localValue));let s=Object.keys(e).length>0?e:[];this.files=[].concat(s)},choose(){this.disabled||(this.files.length>=Number(this.limitLength)&&"grid"!==this.showType&&"array"===this.returnType?i({title:`您最多选择 ${this.limitLength} 个文件`,icon:"none"}):this.chooseFiles())},chooseFiles(){const t=W(this.fileExtname);e.chooseAndUploadFile({type:this.fileMediatype,compressed:!1,sizeType:this.sizeType,sourceType:this.sourceType,extension:t.length>0?t:void 0,count:this.limitLength-this.files.length,onChooseFile:this.chooseFileCallback,onUploadProgress:e=>{this.setProgress(e,e.index)}}).then((e=>{this.setSuccessAndError(e.tempFiles)})).catch((e=>{console.log("选择失败",e)}))},async chooseFileCallback(e){const t=W(this.fileExtname);(1===Number(this.limitLength)&&this.disablePreview&&!this.disabled||"object"===this.returnType)&&(this.files=[]);let{filePaths:l,files:s}=((e,t)=>{let l=[],s=[];return t&&0!==t.length?(e.tempFiles.forEach((e=>{const i=Q(e.name).ext.toLowerCase();-1!==t.indexOf(i)&&(s.push(e),l.push(e.path))})),s.length!==e.tempFiles.length&&i({title:`当前选择了${e.tempFiles.length}个文件 ，${e.tempFiles.length-s.length} 个文件格式不正确`,icon:"none",duration:5e3}),{filePaths:l,files:s}):{filePaths:l,files:s}})(e,t);t&&t.length>0||(l=e.tempFilePaths,s=e.tempFiles);let a=[];for(let i=0;i<s.length&&!(this.limitLength-this.files.length<=0);i++){s[i].uuid=Date.now();let e=await X(s[i],this.fileMediatype);e.progress=0,e.status="ready",this.files.push(e),a.push({...e,file:s[i]})}this.$emit("select",{tempFiles:a,tempFilePaths:l}),e.tempFiles=s,this.autoUpload&&!this.noSpace||(e.tempFiles=[]),e.tempFiles.forEach(((e,t)=>{this.provider&&(e.provider=this.provider);const l=e.name.split("."),s=l.pop(),i=l.join(".").replace(/[\s\/\?<>\\:\*\|":]/g,"_");e.cloudPath=i+"_"+Date.now()+"_"+t+"."+s}))},uploadFiles(e){return e=[].concat(e),H.call(this,e,5,(e=>{this.setProgress(e,e.index,!0)})).then((e=>(this.setSuccessAndError(e),e))).catch((e=>{console.log(e)}))},async setSuccessAndError(e,t){let l=[],s=[],i=[],a=[];for(let o=0;o<e.length;o++){const t=e[o],r=t.uuid?this.files.findIndex((e=>e.uuid===t.uuid)):t.index;if(-1===r||!this.files)break;if("request:fail"===t.errMsg)this.files[r].url=t.path,this.files[r].status="error",this.files[r].errMsg=t.errMsg,s.push(this.files[r]),a.push(this.files[r].url);else{this.files[r].errMsg="",this.files[r].fileID=t.url;/cloud:\/\/([\w.]+\/?)\S*/.test(t.url)?this.files[r].url=await this.getTempFileURL(t.url):this.files[r].url=t.url,this.files[r].status="success",this.files[r].progress+=1,l.push(this.files[r]),i.push(this.files[r].fileID)}}l.length>0&&(this.setEmit(),this.$emit("success",{tempFiles:this.backObject(l),tempFilePaths:i})),s.length>0&&this.$emit("fail",{tempFiles:this.backObject(s),tempFilePaths:a})},setProgress(e,t,l){this.files.length;const s=Math.round(100*e.loaded/e.total);let i=t;l||(i=this.files.findIndex((t=>t.uuid===e.tempFile.uuid))),-1!==i&&this.files[i]&&(this.files[i].progress=s-1,this.$emit("progress",{index:i,progress:parseInt(s),tempFile:this.files[i]}))},delFile(e){this.$emit("delete",{index:e,tempFile:this.files[e],tempFilePath:this.files[e].url,num:this.files}),this.files.splice(e,1),this.$nextTick((()=>{this.setEmit()}))},getFileExt(e){const t=e.lastIndexOf("."),l=e.length;return{name:e.substring(0,t),ext:e.substring(t+1,l)}},setEmit(){let e=[];"object"===this.returnType?(e=this.backObject(this.files)[0],this.localValue=e||null):(e=this.backObject(this.files),this.localValue||(this.localValue=[]),this.localValue=[...e]),this.$emit("update:modelValue",this.localValue)},backObject(e){let t=[];return e.forEach((e=>{t.push({extname:e.extname,fileType:e.fileType,image:e.image,name:e.name,path:e.path,size:e.size,fileID:e.fileID,url:e.url,uuid:e.uuid,status:e.status,cloudPath:e.cloudPath})})),t},async getTempFileURL(t){t={fileList:[].concat(t)};return(await e.getTempFileURL(t)).fileList[0].tempFileURL||""},getForm(e="uniForms"){let t=this.$parent,l=t.$options.name;for(;l!==e;){if(t=t.$parent,!t)return!1;l=t.$options.name}return t}}},[["render",function(e,t,l,s,i,a){const o=I,d=b,c=w("upload-image"),p=T,h=w("upload-file");return r(),n(d,{class:"uni-file-picker"},{default:u((()=>[l.title?(r(),n(d,{key:0,class:"uni-file-picker__header"},{default:u((()=>[f(o,{class:"file-title"},{default:u((()=>[g(k(l.title),1)])),_:1}),f(o,{class:"file-count"},{default:u((()=>[g(k(a.filesList.length)+"/"+k(a.limitLength),1)])),_:1})])),_:1})):y("",!0),"image"===l.fileMediatype&&"grid"===a.showType?(r(),n(c,{key:1,readonly:l.readonly,"image-styles":l.imageStyles,"files-list":a.filesList,limit:a.limitLength,disablePreview:l.disablePreview,delIcon:l.delIcon,onUploadFiles:a.uploadFiles,onChoose:a.choose,onDelFile:a.delFile},{default:u((()=>[v(e.$slots,"default",{},(()=>[f(d,{class:"is-add"},{default:u((()=>[f(d,{class:"icon-add"}),f(d,{class:"icon-add rotate"})])),_:1})]),!0)])),_:3},8,["readonly","image-styles","files-list","limit","disablePreview","delIcon","onUploadFiles","onChoose","onDelFile"])):y("",!0),"image"!==l.fileMediatype||"grid"!==a.showType?(r(),n(h,{key:2,readonly:l.readonly,"list-styles":l.listStyles,"files-list":a.filesList,showType:a.showType,delIcon:l.delIcon,onUploadFiles:a.uploadFiles,onChoose:a.choose,onDelFile:a.delFile},{default:u((()=>[v(e.$slots,"default",{},(()=>[f(p,{type:"primary",size:"mini"},{default:u((()=>[g("选择文件")])),_:1})]),!0)])),_:3},8,["readonly","list-styles","files-list","showType","delIcon","onUploadFiles","onChoose","onDelFile"])):y("",!0)])),_:3})}],["__scopeId","data-v-53a41653"]]),Z=E({__name:"addArt",setup(e){const t=P([]),l=P([]),s=P(null),i=P(!1),a=P(""),o=P("未选择"),d=P({title:"",user_id:"",taxonmoy_id:"",content:"",art_status:!0,view_count:0,is_sticky:!1,coverImg:[],coverVideo:[],Carousel:!1}),c=P("img"),p=P(!1),h=P(0);function m(e){t.value=t.value.filter((t=>t.url!==e.tempFilePath))}function v(){d.value.title?d.value.taxonmoy_id?async function(){var e,l;if(d.value.title,d.value.content,null==(l=null==(e=vk.getVuex("$user.userInfo"))?void 0:e.wx_openid)||l["mp-weixin"],p.value){const e=await R();e.isT?(d.value.coverImg=t.value.map((e=>e.url)),await z(d.value),vk.toast("文章修改成功,即将跳转首页"),setTimeout((()=>{vk.navigateTo("/pages/index/index")}),1e3)):vk.toast(e.msg)}else{const e=await R();e.isT?(d.value.coverImg=t.value.map((e=>e.url)),await N(d.value),vk.toast("发布成功"),setTimeout((()=>{C(1)}),1e3)):vk.toast(e.msg)}}():vk.toast("至少选择一个分类目录"):vk.toast("文章标题不能为空")}function _(){i.value=!0}function F(e){i.value=!1,a.value=e.name,o.value="已选择",d.value.taxonmoy_id=e.id}function x(e){c.value=e,"img"===e?d.value.coverImg=[]:"tv"===e&&(d.value.coverVideo="")}function w(){d.value.content=""}async function I(e){for(let t of e.tempFiles)await E(t,"image")}async function T(e){await E(e.tempFiles[0],"video")}async function E(e,s){try{await vk.uploadFile({title:"文件上传中...",file:e,provider:"extStorage",success:i=>{var a;"image"===s?t.value.push({url:i.url,name:e.name}):"video"===s&&(l.value=[{url:i.url,name:e.name}],a={tempFiles:[{url:i.url}]},d.value.coverVideo=a.tempFiles[0].url)}})}catch(i){vk.toast("上传失败，请重试")}}return L((async e=>{if(e&&e.id){h.value=e.id;const s=await B({id:h.value});Object.assign(d.value,s.result.rows[0]),o.value=s.result.rows[0].taxonmoy_info.name,t.value=s.result.rows[0].coverImg.map((e=>({url:e}))),l.value=s.result.rows[0].coverVideo.map((e=>({url:e,name:"视频"}))),p.value=!0}if(e.item){let t=JSON.parse(e.item);d.value.taxonmoy_id=t.id,a.value=t.name}vk.userCenter.getCurrentUserInfo({success:e=>{d.value.user_id=e.userInfo._id}})})),(e,p)=>{const h=b,P=M(S("u-button"),j),C=V,L=$,E=M(S("uni-icons"),O),B=M(S("uni-file-picker"),Y),z=M(S("u-icon"),A),N=M(S("square-item"),U),R=M(S("u-popup"),D);return r(),n(h,{class:"addArt"},{default:u((()=>[f(h,{class:"addArt-C"},{default:u((()=>[f(h,{class:"addArt-I"},{default:u((()=>[f(h,{class:"head"},{default:u((()=>[f(h,{class:"reset",onClick:w},{default:u((()=>[g("重置")])),_:1}),f(P,{onClick:v,size:"mini",type:"primary",class:"addArt-btn"},{default:u((()=>[g("发布")])),_:1})])),_:1})])),_:1}),f(h,{class:"addArt-I"},{default:u((()=>[f(C,{modelValue:d.value.title,"onUpdate:modelValue":p[0]||(p[0]=e=>d.value.title=e),placeholder:"请输入标题",class:"title"},null,8,["modelValue"])])),_:1}),f(h,{class:"addArt-I"},{default:u((()=>[f(L,{modelValue:d.value.content,"onUpdate:modelValue":p[1]||(p[1]=e=>d.value.content=e),"auto-height":"",maxlength:"-1",class:"content",placeholder:"输入要发布的内容"},null,8,["modelValue"])])),_:1}),f(h,{class:"addArt-I"},{default:u((()=>[f(h,{class:"upIcon"},{default:u((()=>[f(h,{class:"upimg",onClick:p[2]||(p[2]=e=>x("img"))},{default:u((()=>[f(E,{type:"images",size:"33",color:"img"===c.value?"#03A9F4":""},null,8,["color"])])),_:1}),f(h,{class:"uptv",onClick:p[3]||(p[3]=e=>x("tv"))},{default:u((()=>[f(E,{type:"videocam",size:"33",color:"tv"===c.value?"#03A9F4":""},null,8,["color"])])),_:1})])),_:1}),f(h,{class:"upBtn"},{default:u((()=>["img"===c.value?(r(),n(h,{key:0,class:"img"},{default:u((()=>[f(B,{ref_key:"files",ref:s,modelValue:t.value,"onUpdate:modelValue":p[4]||(p[4]=e=>t.value=e),"auto-upload":!1,fileMediatype:"image",mode:"grid","file-extname":"png,jpg",onSelect:I,onDelete:m,limit:9,title:"上传图片"},{default:u((()=>[f(E,{type:"plusempty",size:"20"})])),_:1},8,["modelValue"])])),_:1})):y("",!0),"tv"===c.value?(r(),n(h,{key:1,class:"tv"},{default:u((()=>[f(B,{ref_key:"files",ref:s,modelValue:l.value,"onUpdate:modelValue":p[5]||(p[5]=e=>l.value=e),"auto-upload":!1,fileMediatype:"video",onSelect:T,onDelete:e.delTv,limit:1},{default:u((()=>[f(h,{class:"tvCss"},{default:u((()=>[g("+")])),_:1})])),_:1},8,["modelValue","onDelete"])])),_:1})):y("",!0)])),_:1})])),_:1}),f(h,{class:"addArt-I"},{default:u((()=>[f(h,{class:"cell"},{default:u((()=>[f(h,{class:"cell-item",onClick:_},{default:u((()=>[f(h,{class:"cell-L"},{default:u((()=>[f(z,{class:"iconL",name:"moments",color:"#16D46B",size:"38"}),g(" "+k(o.value),1)])),_:1}),f(h,{class:"cell-R"},{default:u((()=>[g(k(a.value),1),f(z,{class:"iconR",name:"arrow-right",size:"28"})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),f(R,{mode:"bottom",modelValue:i.value,"onUpdate:modelValue":p[6]||(p[6]=e=>i.value=e)},{default:u((()=>[f(h,{class:"popup-ctx"},{default:u((()=>[f(h,{class:"pop-title"},{default:u((()=>[g("选择圈子")])),_:1}),f(N,{type:"sel",onCallBack:F})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}},[["__scopeId","data-v-6046a80a"]]);export{Z as default};
