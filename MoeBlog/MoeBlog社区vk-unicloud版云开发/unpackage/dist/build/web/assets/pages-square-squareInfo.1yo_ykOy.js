import{h as e,k as a,a as s,w as l,o as u,b as t,m as r,d as o,t as i,p as n,q as d,F as c,e as f,i as v,f as _,s as p,S as m,u as g}from"./index-BcbBmaH1.js";import{_ as k}from"./uni-icons.DNeyR9zY.js";import{o as q,a as x,b as y,c as j,r as I}from"./uni-app.es.CDgP4_Nc.js";import{_ as h}from"./art-item.BtrXExoi.js";import{_ as C}from"./z-paging.DJjrhKoD.js";import{u as H,a as V}from"./utils.qqFolnPJ.js";import{j as U,k as F,l as $,m as z,n as b}from"./api.D6LgEBnm.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-icon.C0MRo5fe.js";import"./u-action-sheet.ukLITz2J.js";import"./u-popup.Blx2ASJN.js";import"./square.DS5UtVkO.js";import"./like.DUCAGHvM.js";const B=A({__name:"squareInfo",setup(A){q((e=>{w.value=e.id})),x((e=>{})),y((e=>{})),j((()=>{}));const B=e(null),w=e({id:""}),S=e({}),T=e([]),N=e(0),D=e(0),E=e([]),G=e(!1),J=e(null);function L(e,a){!function(){let e={id:w.value,user_id:"_id"in vk.getVuex("$user.userInfo")?vk.getVuex("$user.userInfo")._id:""};$(e).then((e=>{S.value=e.result[0],D.value=e.result[0].fans_count,N.value=e.result[0].ArtCount,console.log(S.value),"FavoriteInfo"in S.value&&"_id"in S.value.FavoriteInfo?G.value=!0:G.value=!1}))}(),function(){let e={id:w.value,pageIndex:1};F(e).then((e=>{E.value=e.result.rows,console.log(E.value)}))}();let s={pageNo:e,pageSize:a,id:w.value};U(s).then((e=>{B.value.complete(e.result.rows)}))}function M(){if(G.value){let e={_id:S.value.FavoriteInfo._id,user_id:vk.getVuex("$user.userInfo")._id,taxonomy_id:w.value},a=E.value.findIndex((e=>e._id===vk.getVuex("$user.userInfo")._id));E.value.splice(a,1),z(e).then((e=>{G.value=!1,D.value-=1}))}else{let e={_id:vk.getVuex("$user.userInfo")._id,username:H(vk.getVuex("$user.userInfo")),avatar:V(vk.getVuex("$user.userInfo"))};E.value.push(e),console.log(E.value),b({id:w.value,taxonomy_id:w.value}).then((e=>{G.value=!0,D.value+=1,J.value=e.result}))}}function O(){let e={_id:S.value._id,name:S.value.name},a=JSON.stringify(e);vk.navigateTo("/pages/art/addArt?item="+a)}return(e,q)=>{const x=f,y=v,j=_,U=I(a("uni-icons"),k),F=p,$=m,z=I(a("art-item"),h),b=I(a("z-paging"),C);return u(),s(b,{ref_key:"paging",ref:B,modelValue:T.value,"onUpdate:modelValue":q[1]||(q[1]=e=>T.value=e),onQuery:L},{default:l((()=>[t(y,{class:"square-info"},{default:l((()=>[t(y,{class:"square-C"},{default:l((()=>[t(y,{class:"square-H"},{default:l((()=>[t(y,{class:"square-H-bj"},{default:l((()=>[S.value.backgroundUrl?(u(),s(x,{key:0,mode:"aspectFill",src:S.value.backgroundUrl},null,8,["src"])):r("",!0)])),_:1}),t(y,{class:"square-H-C"},{default:l((()=>[t(y,{class:"avatar"},{default:l((()=>[S.value.avatarUrl?(u(),s(x,{key:0,mode:"aspectFill",src:S.value.avatarUrl},null,8,["src"])):r("",!0)])),_:1}),t(y,{class:"info"},{default:l((()=>[t(y,{class:"title"},{default:l((()=>[o(i(S.value.name),1)])),_:1}),t(y,{class:"desc"},{default:l((()=>[o(i(S.value.description),1)])),_:1})])),_:1})])),_:1}),t(y,{class:"square-H-B"},{default:l((()=>[t(y,{class:"square-H-B-L"},{default:l((()=>[t(j,null,{default:l((()=>[o(i(D.value)+"成员",1)])),_:1}),o(" · "),t(j,null,{default:l((()=>[o(i(N.value)+"条内容",1)])),_:1})])),_:1}),t(y,{class:"square-H-B-R"},{default:l((()=>[t(y,{class:"gz",onClick:M},{default:l((()=>[o(i(G.value?"已关注":"关注"),1)])),_:1}),t(y,{class:"share"},{default:l((()=>[t(F,{"open-type":"share"},{default:l((()=>[t(U,{type:"upload",size:"30",color:"#fff"})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),t(y,{class:"square-A"},{default:l((()=>[t(y,{class:"square-A-C"},{default:l((()=>[t(y,{class:"square-user"},{default:l((()=>[t(y,{class:"square-user-H"},{default:l((()=>[t(y,{class:"square-user-H-1"},{default:l((()=>[o("圈子成员")])),_:1}),t(y,{class:"square-user-H-2",onClick:q[0]||(q[0]=e=>{return a=S.value._id,vk.navigateTo("/pages/square/squareUser?id="+a),void console.log(a);var a})},{default:l((()=>[o("查看更多 >")])),_:1})])),_:1}),t(y,{class:"square-user-U"},{default:l((()=>[E.value.length>0?(u(),s($,{key:0,"scroll-x":"",class:"scroll-x"},{default:l((()=>[t(y,{class:"square-user-U-C"},{default:l((()=>[(u(!0),n(c,null,d(E.value,(e=>(u(),s(y,{class:"square-user-U-I",key:e._id,onClick:a=>{return s=e._id,void vk.navigateTo("/pages/userinfo/userinfo?id="+s);var s}},{default:l((()=>[t(x,{mode:"aspectFill",src:g(V)(e)},null,8,["src"]),t(y,{class:"name"},{default:l((()=>[o(i(g(H)(e)),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):(u(),s(y,{key:1,style:{padding:"25rpx",display:"flex","align-items":"center","justify-content":"center"}},{default:l((()=>[o(" 暂无用户关注 ")])),_:1}))])),_:1})])),_:1}),t(y,{class:"square-art"},{default:l((()=>[(u(!0),n(c,null,d(T.value,((e,a)=>(u(),s(z,{key:e._id,item:e},null,8,["item"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),t(y,{class:"add",onClick:O},{default:l((()=>[o(" + ")])),_:1})])),_:1})])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-62fcd53c"]]);export{B as default};
