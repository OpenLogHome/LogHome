import{h as e,k as a,a as s,w as l,o as u,b as t,u as r,d as i,t as o,m as n,p as f,q as d,F as m,e as c,i as _,f as v}from"./index-BcbBmaH1.js";import{_ as p}from"./avatar-item.CHKnCc0x.js";import{o as g,c as k,r as j}from"./uni-app.es.CDgP4_Nc.js";import{_ as w}from"./u-tag.BFInBbI9.js";import{_ as h}from"./art-item.BtrXExoi.js";import{_ as I}from"./z-paging.DJjrhKoD.js";import{_ as N}from"./art_icon.Iz8j59mQ.js";import{u as x,v as y,w as T,x as V}from"./api.D6LgEBnm.js";import{b as F,a as z,f as $,u as b,g as q}from"./utils.qqFolnPJ.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-icon.C0MRo5fe.js";import"./u-action-sheet.ukLITz2J.js";import"./u-popup.Blx2ASJN.js";import"./square.DS5UtVkO.js";import"./like.DUCAGHvM.js";const L=C({__name:"userinfo",setup(C){g((e=>{L.value=e.id,function(){let e={id:L.value,currentUserId:vk.getVuex("$user.userInfo")._id?vk.getVuex("$user.userInfo")._id:""};x(e).then((e=>{H.value=e.result.rows[0],D.value.fansNum=e.followingNum,D.value.concernNum=e.followerNum,"LikeInfo"in e.result.rows[0]&&(B.value._id=e.result.rows[0].LikeInfo._id,B.value.isT=!0)}))}()})),k((()=>{}));const L=e(""),G=e(vk.getVuex("$user.userInfo")._id||""),H=e({}),M=e([]),U=e(null),B=e({_id:"",isT:!1}),D=e({artNum:"",fansNum:"",concernNum:""});function E(e,a){let s={pageNo:e,pageSize:a,_id:L.value};y(s).then((e=>{D.value.artNum=e.result.total,U.value.complete(e.result.rows)}))}function J(){if(!("gender"in H.value))return"Genderunknown";switch(H.value.gender){case 0:return"man";case 1:return"woman"}}function Q(){let e={follower_id:vk.getVuex("$user.userInfo")._id,following_id:L.value};if(B.value.isT)T({id:B.value._id}).then((e=>{B.value.isT=!1,B.value._id="",D.value.fansNum-=1}));else{if(!vk.checkToken())return void vk.toast("请登陆后在操作");0!=e.follower_id.length&&0!=e.following_id.length?V(e).then((e=>{B.value._id=e.result,B.value.isT=!0,D.value.fansNum+=1})):vk.toast("请登陆")}}return(e,g)=>{const k=c,x=_,y=j(a("avatar-item"),p),T=j(a("u-tag"),w),V=v,C=j(a("art-item"),h),R=j(a("z-paging"),I);return u(),s(R,{ref_key:"paging",ref:U,modelValue:M.value,"onUpdate:modelValue":g[0]||(g[0]=e=>M.value=e),onQuery:E},{default:l((()=>[t(x,{class:"userinfo"},{default:l((()=>[t(x,{class:"userinfo-ctx"},{default:l((()=>[t(x,{class:"userinfo-bj"},{default:l((()=>[t(k,{mode:"aspectFill",src:r(F)(H.value)},null,8,["src"])])),_:1}),t(x,{class:"userinfo-C"},{default:l((()=>[t(x,{class:"userinfo-H"},{default:l((()=>[t(x,{class:"avatar"},{default:l((()=>[t(y,{height:220,width:220,avatar:r(z)(H.value),frame:r($)(H.value)},null,8,["avatar","frame"])])),_:1}),t(x,{class:"info"},{default:l((()=>[t(x,{class:"name info-I"},{default:l((()=>[i(o(r(b)(H.value))+" ",1),t(k,{mode:"aspectFill",src:`../../static/img/${J()}.png`},null,8,["src"])])),_:1}),t(x,{class:"gender info-I"}),t(x,{class:"timer info-I"},{default:l((()=>[i(o(e.vk.pubfn.timeFormat(H.value.register_date,"yyyy-MM-dd"))+"注册 ",1)])),_:1})])),_:1}),L.value!=G.value?(u(),s(x,{key:0,class:"gz",onClick:Q},{default:l((()=>[t(T,{text:B.value.isT?"已关注":"关注",shape:"square"},null,8,["text"])])),_:1})):n("",!0)])),_:1}),t(x,{class:"infos"},{default:l((()=>[t(x,{class:"infos-I"},{default:l((()=>[t(V,null,{default:l((()=>[i(o(D.value.concernNum),1)])),_:1}),i("关注 ")])),_:1}),t(x,{class:"infos-I"},{default:l((()=>[t(V,null,{default:l((()=>[i(o(D.value.fansNum),1)])),_:1}),i("粉丝 ")])),_:1}),t(x,{class:"infos-I"},{default:l((()=>[t(V,null,{default:l((()=>[i(o(D.value.artNum),1)])),_:1}),i("帖子 ")])),_:1})])),_:1}),t(x,{class:"gxqm"},{default:l((()=>[t(V,null,{default:l((()=>[i("个性签名")])),_:1}),i(" "+o(r(q)(H.value)),1)])),_:1})])),_:1}),t(x,{class:"art"},{default:l((()=>[t(x,{class:"title"},{default:l((()=>[t(k,{mode:"aspectFill",src:N}),i(" 最新动态 ")])),_:1}),t(x,{class:"art-C"},{default:l((()=>[(u(!0),f(m,null,d(M.value,(e=>(u(),s(C,{key:e._id,item:e},null,8,["item"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-97803a69"]]);export{L as default};
