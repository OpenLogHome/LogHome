import{o as e,a as t,w as s,b as a,h as l,F as u,j as i,i as n,r,e as o,n as c,k as d,t as f,l as m,m as _,p,P as v,d as h,u as y,f as g,Q as k,R as j,x as w,J as x,T as I}from"./index-C69BgsYY.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{o as b,c as F,r as S}from"./uni-app.es.4Bntlf4B.js";import{_ as $}from"./u-icon.yGbbo8IR.js";import{_ as A,a as E}from"./comments-send-item.Cdm-1mwX.js";import{_ as N,a as P,b as V}from"./like.DUCAGHvM.js";import{_ as J}from"./square.DS5UtVkO.js";import{g as R,o as q}from"./api.ClmPzCnk.js";import{a as L,u as B,g as H}from"./utils.qqFolnPJ.js";import"./uni-icons.DbPdresR.js";import"./u-button.CQyuZRx3.js";import"./u-popup.CZC_HG1o.js";import"./check.CqE10ALw.js";const T=C({},[["render",function(r,o){const c=n;return e(),t(c,{class:"Skeleton-item"},{default:s((()=>[a(c,{class:"banner"}),a(c,{class:"list"},{default:s((()=>[(e(),l(u,null,i(10,((e,t)=>a(c,{class:"list-item",key:t},{default:s((()=>[a(c,{class:"list-item-1"}),a(c,{class:"list-item-2"})])),_:2},1024))),64))])),_:1}),a(c,{class:"art"},{default:s((()=>[(e(),l(u,null,i(4,((e,t)=>a(c,{class:"art-item",key:t},{default:s((()=>[a(c,{class:"art-item-1"}),a(c,{class:"art-item-2"}),a(c,{class:"art-item-3"},{default:s((()=>[a(c,{class:"art-item-3-avatar"}),a(c,{class:"art-item-3-name"})])),_:1})])),_:2},1024))),64))])),_:1})])),_:1})}],["__scopeId","data-v-1b922e16"]]);const z=C({name:"u-col",emits:["click"],props:{span:{type:[Number,String],default:12},offset:{type:[Number,String],default:0},justify:{type:String,default:"start"},align:{type:String,default:"center"},textAlign:{type:String,default:"left"},stop:{type:Boolean,default:!0}},data:()=>({gutter:20}),created(){this.parent=!1},mounted(){this.parent=this.$u.$parent.call(this,"u-row"),this.parent&&(this.gutter=this.parent.gutter)},computed:{uJustify(){return"end"==this.justify||"start"==this.justify?"flex-"+this.justify:"around"==this.justify||"between"==this.justify?"space-"+this.justify:this.justify},uAlignItem(){return"top"==this.align?"flex-start":"bottom"==this.align?"flex-end":this.align}},methods:{click(e){this.$emit("click",e)}}},[["render",function(a,l,u,i,d,f){const m=n;return e(),t(m,{class:o(["u-col",["u-col-"+u.span]]),style:c({padding:"0 "+(Number(d.gutter)/2+"rpx"),marginLeft:100/12*u.offset+"%",flex:`0 0 ${100/12*u.span}%`,alignItems:f.uAlignItem,justifyContent:f.uJustify,textAlign:u.textAlign}),onClick:f.click},{default:s((()=>[r(a.$slots,"default",{},void 0,!0)])),_:3},8,["class","style","onClick"])}],["__scopeId","data-v-7a986216"]]);const D=C({name:"u-row",emits:["click"],props:{gutter:{type:[String,Number],default:20},justify:{type:String,default:"start"},align:{type:String,default:"center"},stop:{type:Boolean,default:!0}},computed:{uJustify(){return"end"==this.justify||"start"==this.justify?"flex-"+this.justify:"around"==this.justify||"between"==this.justify?"space-"+this.justify:this.justify},uAlignItem(){return"top"==this.align?"flex-start":"bottom"==this.align?"flex-end":this.align}},methods:{click(e){this.$emit("click",e)}}},[["render",function(a,l,u,i,o,d){const f=n;return e(),t(f,{class:"u-row",style:c({alignItems:d.uAlignItem,justifyContent:d.uJustify}),onClick:d.click},{default:s((()=>[r(a.$slots,"default",{},void 0,!0)])),_:3},8,["style","onClick"])}],["__scopeId","data-v-c792c2be"]]),G=C({__name:"Empty-item",props:{mode:{type:String,default:"data"}},setup(l){const{mode:u}=l;function i(){switch(u){case"comments":return"暂无评论，快来抢沙发吧";case"art":return"暂无文章，快去发布一篇";case"like":return"暂无喜欢，快去收藏一篇";case"square":return"暂无圈子，快去创建一个吧";case"user":return"暂无关注粉丝或关注";case"none":return"暂无内容";default:return"数据"}}return(u,r)=>{const o=m,c=_,p=n;return e(),t(p,{class:"empty-item"},{default:s((()=>[a(p,{class:"empty-I"},{default:s((()=>[a(o,{mode:"widthFix",src:`https://404.kim/api/img/${l.mode}-empty.png`},null,8,["src"]),a(c,null,{default:s((()=>[d(f(i()),1)])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-52849c66"]]),K=C({__name:"art",setup(r){const{proxy:c}=w();b((e=>{_.value=e.id,K.value.artid=e.id,function(){let e={id:_.value,need_user_info:!0};R(e).then((e=>{U.value=!1,e.result.rows[0].like_info&&e.result.rows[0].like_info._id&&e.result.rows[0].like_info.user_id==vk.getVuex("$user.userInfo")._id?(console.log("存在点赞"),K.value.like_info=e.result.rows[0].like_info._id):K.value.like_info="",Q.value=e.result.rows[0],console.log(0==Q.value.coverVideo.length&&0==Q.value.coverImg.length),v({title:e.result.rows[0].title||"暂无标题"})}))}(),se()})),F((()=>{W.value||(M.value+=1,se())}));const _=p(""),C=p(null),K=p({artid:_.value,level:0,parent_id:"",username:"",commentsN:0,commentsL:""}),Q=p({}),U=p(!0),M=p(1),O=p([]),W=p(!1),X=p(null),Y=p("");function Z(e){x({urls:Q.value.coverImg,current:e})}function ee(e){switch(e){case 0:return 12;case 1:case 2:return 6;default:return 4}}function te(e){switch(e){case 0:return"col";case 1:case 2:return"col-6";default:return"col-4"}}function se(){let e={pageIndex:M.value,art_id:_.value};q(e).then((e=>{if(1==M.value&&(X.value=e.result.total,K.value.commentsN=e.result.total),0==e.result.rows.length)return void(W.value=!0);let t=e.result.rows.filter((e=>""==e.parent_id||null==e.parent_id)).map((e=>({...e,children:[]})));t.forEach((t=>{e.result.rows.forEach((e=>{t._id==e.parent_id&&t.children.push(e)}))})),O.value=[...O.value,...t]}))}function ae(e){Y.value=e?"1":"",K.value={artid:_.value,level:0,parent_id:"",username:"",commentsN:X.value,commentsL:Y.value}}function le(e){X.value+=1,0==e.parent_id.length?O.value.push(e):O.value.forEach((t=>{t._id==e.parent_id&&t.children.push(t)})),ae()}function ue(e){X.value-=1;let t=O.value.findIndex((t=>t._id==e));O.value.splice(t,1)}return(r,_)=>{const p=S(h("Skeleton-item"),T),v=n,w=m,x=S(h("u-icon"),$),b=S(h("u-col"),z),F=S(h("u-row"),D),R=k,q=I,M=j,W=S(h("comment-list-item"),A),X=S(h("Empty-item"),G),Y=S(h("comments-send-item"),E);return e(),t(v,{class:"art"},{default:s((()=>[U.value?(e(),t(v,{key:0},{default:s((()=>[a(p)])),_:1})):(e(),t(v,{key:1,class:"art-ctx"},{default:s((()=>[a(v,{class:"user",onClick:_[0]||(_[0]=e=>{return t=Q.value.userinfo._id,void c.$framePostman.send({type:"USER_PAGE",id:t});var t})},{default:s((()=>[Q.value.userinfo?(e(),t(v,{key:0,class:"user-R"},{default:s((()=>[a(w,{src:y(L)(Q.value.userinfo),mode:"aspectFill"},null,8,["src"]),a(v,{class:"user-R-info"},{default:s((()=>[a(v,{class:"name"},{default:s((()=>[d(f(y(B)(Q.value.userinfo)),1)])),_:1}),a(v,{class:"gxqm"},{default:s((()=>[d(f(y(H)(Q.value.userinfo)),1)])),_:1})])),_:1})])),_:1})):g("",!0),a(v,{class:"user-L"},{default:s((()=>[a(x,{name:"arrow-right"})])),_:1})])),_:1}),a(v,{style:{height:"124rpx"}}),Q.value.Carousel?(e(),t(v,{key:1,class:"art-B"},{default:s((()=>[0!=Q.value.coverImg.length&&0==Q.value.coverVideo.length?(e(),t(M,{key:0,class:"swiper","indicator-dots":"",circular:!0,"indicator-active-color":"#ffffff"},{default:s((()=>[(e(!0),l(u,null,i(Q.value.coverImg,((l,u)=>(e(),t(q,{class:"swiper-item",key:u},{default:s((()=>[a(w,{onClick:e=>Z(u),mode:"aspectFill",src:l},null,8,["onClick","src"])])),_:2},1024)))),128))])),_:1})):g("",!0),0!=Q.value.coverVideo.length?(e(),t(v,{key:1,class:"tv"},{default:s((()=>[a(R,{src:Q.value.coverVideo[0]},null,8,["src"])])),_:1})):g("",!0),a(v,{class:"title"},{default:s((()=>[d(f(Q.value.title),1)])),_:1}),a(v,{class:"content"},{default:s((()=>[d(f(Q.value.content),1)])),_:1}),a(v,{class:"timer"},{default:s((()=>[d(" 发布于: "+f(Q.value._add_time_str.slice(0,10)),1)])),_:1}),a(v,{class:"artinfo"},{default:s((()=>[a(v,{class:"artinfo-item"},{default:s((()=>[a(w,{mode:"aspectFill",src:N}),d(" "+f(Q.value.view_count),1)])),_:1}),a(v,{class:"artinfo-item"},{default:s((()=>[a(w,{mode:"aspectFill",src:P}),d(" "+f(Q.value.comment_count),1)])),_:1}),a(v,{class:"artinfo-item"},{default:s((()=>[a(w,{mode:"aspectFill",src:V}),d(" "+f(Q.value.like_count),1)])),_:1})])),_:1})])),_:1})):(e(),t(v,{key:0,class:"art-C"},{default:s((()=>[a(v,{class:"title"},{default:s((()=>[d(f(Q.value.title),1)])),_:1}),a(v,{class:"content"},{default:s((()=>[d(f(Q.value.content),1)])),_:1}),0==Q.value.coverVideo.length?(e(),t(v,{key:0,class:"img"},{default:s((()=>[a(v,{class:"imgRow"},{default:s((()=>[a(F,{class:"row"},{default:s((()=>[(e(!0),l(u,null,i(Q.value.coverImg,((l,u)=>(e(),t(b,{class:o(["col",te(u)]),span:ee(u),key:u},{default:s((()=>[a(w,{onClick:e=>Z(u),mode:"aspectFill",src:l},null,8,["onClick","src"])])),_:2},1032,["span","class"])))),128))])),_:1})])),_:1})])),_:1})):(e(),t(v,{key:1,class:"tv"},{default:s((()=>[a(R,{src:Q.value.coverVideo},null,8,["src"])])),_:1})),a(v,{class:"timer"},{default:s((()=>[d(" 发布于: "+f(Q.value._add_time_str.slice(0,10)),1)])),_:1}),a(v,{class:"artinfo"},{default:s((()=>[a(v,{class:"artinfo-item"},{default:s((()=>[a(w,{mode:"aspectFill",src:N}),d(" "+f(Q.value.view_count),1)])),_:1}),a(v,{class:"artinfo-item"},{default:s((()=>[a(w,{mode:"aspectFill",src:P}),d(" "+f(Q.value.comment_count),1)])),_:1}),a(v,{class:"artinfo-item"},{default:s((()=>[a(w,{mode:"aspectFill",src:V}),d(" "+f(Q.value.like_count),1)])),_:1})])),_:1})])),_:1})),a(v,{class:"share"},{default:s((()=>[a(v,{class:"share-item",onClick:_[1]||(_[1]=e=>{return t=Q.value.taxonmoy_id,void vk.navigateTo("/pages/square/squareInfo?id="+t);var t})},{default:s((()=>[a(v,null,{default:s((()=>[a(w,{mode:"aspectFill",src:J})])),_:1}),a(v,{class:"share-item-text"},{default:s((()=>[d(f(Q.value.taxonmoy_info.name),1)])),_:1})])),_:1})])),_:1}),a(v,{class:"comments"},{default:s((()=>[a(v,{class:"comments-H"},{default:s((()=>[d("全部评论")])),_:1}),0!=O.value.length?(e(),t(v,{key:0},{default:s((()=>[(e(!0),l(u,null,i(O.value,((a,l)=>(e(),t(v,{onClick:e=>{return t=a,K.value.parent_id=t._id,K.value.username=B(t.userinfo),K.value.level=1,void(C.value&&C.value.openPop());var t}},{default:s((()=>[(e(),t(W,{onDelComment:ue,item:a,key:a._id},null,8,["item"]))])),_:2},1032,["onClick"])))),256))])),_:1})):(e(),t(v,{key:1},{default:s((()=>[a(X,{mode:"comments"})])),_:1}))])),_:1}),a(v,{class:"comments-content"},{default:s((()=>[a(Y,{ref_key:"commentsPop",ref:C,artInfo:K.value,onPopColse:ae,onCommentSc:le},null,8,["artInfo"])])),_:1})])),_:1}))])),_:1})}}},[["__scopeId","data-v-b444dde1"]]);export{K as default};
