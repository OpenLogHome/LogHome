{"version":3,"file":"pages/read/collections.js","sources":["webpack:///./pages/read/collections.vue","webpack:///./pages/read/collections.vue?687b","webpack:///./pages/read/collections.vue?85f2","webpack:///./pages/read/collections.vue?d1b5","webpack:///./pages/read/collections.vue?6a9f","webpack:///./pages/read/collections.vue?ab31"],"sourcesContent":["\nexport default {\n  head() {\n    return {\n      title: `${this.title || '小说集合'} - 原木社区`,\n      meta: [\n        { hid: 'description', name: 'description', content: `原木社区 - ${this.title || '小说集合'} 分类下的热门小说列表` }\n      ]\n    }\n  },\n  data() {\n    return {\n      title: '',\n      novels: [],\n      loading: true,\n      error: null\n    }\n  },\n  async asyncData({ query, $api, error }) {\n    try {\n      const title = query.title || '人气最佳'\n      \n      // 加载小说集合数据\n      const novels = await $api.novels.getCollectionNovels(title, 1, 100)\n      \n      return {\n        title,\n        novels: novels || [],\n        loading: false\n      }\n    } catch (err) {\n      console.error('加载集合数据失败:', err)\n      return {\n        title: query.title || '人气最佳',\n        novels: [],\n        loading: false,\n        error: `加载集合数据失败: ${err.message || '未知错误'}`\n      }\n    }\n  },\n  watch: {\n    '$route.query.title': {\n      handler(newTitle) {\n        if (newTitle && newTitle !== this.title) {\n          this.title = newTitle\n          this.refreshCollections()\n        }\n      },\n      immediate: true\n    }\n  },\n  mounted() {\n    // 调试信息\n    console.log('Collections页面挂载, 当前title:', this.title)\n    \n    // 检查页面路由和数据\n    this.checkPageData()\n  },\n  methods: {\n    // 刷新小说集合\n    async refreshCollections() {\n      this.loading = true\n      this.error = null\n      \n      try {\n        this.novels = await this.$api.novels.getCollectionNovels(this.title, 1, 100)\n      } catch (err) {\n        console.error('刷新集合数据失败:', err)\n        this.error = '刷新集合数据失败，请稍后重试'\n      } finally {\n        this.loading = false\n      }\n    },\n    \n    // 截断文本\n    truncateText(text, maxLength) {\n      if (!text) return ''\n      if (text.length <= maxLength) return text\n      return text.substring(0, maxLength) + '...'\n    },\n    \n    // 格式化数字\n    formatNumber(num) {\n      if (!num) return '0'\n      if (num >= 10000) {\n        return (num / 10000).toFixed(1) + '万'\n      } else if (num >= 1000) {\n        return (num / 1000).toFixed(1) + 'k'\n      }\n      return num.toString()\n    },\n    \n    // 格式化日期时间\n    formatDateTime(dateStr) {\n      if (!dateStr) return ''\n      const date = new Date(dateStr)\n      const now = new Date()\n      \n      const diffTime = Math.abs(now - date)\n      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24))\n      \n      if (diffDays < 1) {\n        return '今天'\n      } else if (diffDays < 7) {\n        return `${diffDays}天前`\n      } else {\n        return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`\n      }\n    },\n    \n    // 检查页面数据\n    checkPageData() {\n      // 检查URL参数是否存在\n      const urlParams = new URLSearchParams(window.location.search);\n      const titleParam = urlParams.get('title');\n      \n      console.log('URL参数检查 - title:', titleParam)\n      \n      // 如果URL有title参数但页面没有加载数据，尝试刷新\n      if (titleParam && this.novels.length === 0 && !this.loading && !this.error) {\n        console.log('URL有title参数但没有加载数据，尝试重新加载')\n        this.title = decodeURIComponent(titleParam)\n        this.refreshCollections()\n      }\n    }\n  }\n}\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./collections.vue?vue&type=style&index=0&id=506dad66&prod&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"d5017de0\", content, true, context)\n};","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./collections.vue?vue&type=style&index=0&id=506dad66&prod&lang=scss&scoped=true\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".collections-page[data-v-506dad66]{max-width:1200px;margin:0 auto;padding:20px;background-color:#fff;min-height:calc(100vh - 140px)}.page-header[data-v-506dad66]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:15px;border-bottom:1px solid #e0e0e0}.page-header .page-title[data-v-506dad66]{font-size:24px;font-weight:bold;color:#947358;margin:0}.page-header .back-button[data-v-506dad66]{padding:8px 16px;background-color:#947358;color:#fff;border-radius:4px;text-decoration:none;font-size:14px;transition:background-color .3s}.page-header .back-button[data-v-506dad66]:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}.loading-container[data-v-506dad66],.error-container[data-v-506dad66],.empty-container[data-v-506dad66]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px}.loading-container p[data-v-506dad66],.error-container p[data-v-506dad66],.empty-container p[data-v-506dad66]{margin-top:20px;color:#666;font-size:16px}.loading-spinner[data-v-506dad66]{width:50px;height:50px;border:5px solid rgba(148,115,88,.2);border-top-color:#947358;border-radius:50%;animation:spin-506dad66 1s linear infinite}@keyframes spin-506dad66{to{transform:rotate(360deg)}}.retry-button[data-v-506dad66]{margin-top:15px;padding:8px 20px;background-color:#947358;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:14px}.retry-button[data-v-506dad66]:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}.novels-grid[data-v-506dad66]{display:grid;grid-template-columns:repeat(auto-fill, minmax(300px, 1fr));gap:25px;margin-top:20px}.novel-card[data-v-506dad66]{display:flex;flex-direction:column;border-radius:8px;overflow:hidden;box-shadow:0 2px 12px rgba(0,0,0,.08);transition:transform .3s,box-shadow .3s;background-color:#fff;height:100%}.novel-card[data-v-506dad66]:hover{transform:translateY(-5px);box-shadow:0 5px 15px rgba(0,0,0,.1)}.novel-cover[data-v-506dad66]{height:180px;background-size:cover;background-position:center;position:relative}.novel-cover .novel-category[data-v-506dad66]{position:absolute;top:10px;right:10px;background-color:rgba(0,0,0,.7);color:#fff;padding:3px 8px;border-radius:4px;font-size:12px}.novel-info[data-v-506dad66]{padding:15px;display:flex;flex-direction:column;flex-grow:1}.novel-title[data-v-506dad66]{font-size:18px;font-weight:bold;margin:0 0 10px;color:#333;line-height:1.4;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical}.novel-author-info[data-v-506dad66]{display:flex;align-items:center;margin-bottom:12px}.novel-author-info .author-avatar[data-v-506dad66]{width:24px;height:24px;border-radius:50%;margin-right:8px;object-fit:cover}.novel-author-info .author-name[data-v-506dad66]{font-size:14px;color:#666}.novel-desc[data-v-506dad66]{font-size:14px;color:#666;margin:0 0 15px;line-height:1.5;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;flex-grow:1}.novel-stats[data-v-506dad66]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:8px}.novel-stats span[data-v-506dad66]{font-size:12px;color:#666}.novel-update-time[data-v-506dad66]{font-size:12px;color:#666;margin-bottom:15px}.read-button[data-v-506dad66]{padding:8px 0;background-color:#947358;color:#fff;border-radius:4px;text-align:center;text-decoration:none;font-size:14px;transition:background-color .3s}.read-button[data-v-506dad66]:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}@media(max-width: 768px){.novels-grid[data-v-506dad66]{grid-template-columns:repeat(auto-fill, minmax(250px, 1fr))}}@media(max-width: 480px){.novels-grid[data-v-506dad66]{grid-template-columns:1fr}}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./collections.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./collections.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./collections.vue?vue&type=template&id=506dad66&scoped=true\"\nimport script from \"./collections.vue?vue&type=script&lang=js\"\nexport * from \"./collections.vue?vue&type=script&lang=js\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./collections.vue?vue&type=style&index=0&id=506dad66&prod&lang=scss&scoped=true\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"506dad66\",\n  \"6729a7aa\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACXA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AHNA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;;AIFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}