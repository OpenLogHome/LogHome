{"version":3,"file":"pages/read/collections.js","sources":["webpack:///./pages/read/collections.vue","webpack:///./pages/read/collections.vue?b56b","webpack:///./pages/read/collections.vue?50be","webpack:///./pages/read/collections.vue?bcad","webpack:///./pages/read/collections.vue?6a9f","webpack:///./pages/read/collections.vue?ab31"],"sourcesContent":["\r\nexport default {\r\n  head() {\r\n    return {\r\n      title: `${this.title || '小说集合'} - 原木社区`,\r\n      meta: [\r\n        { hid: 'description', name: 'description', content: `原木社区 - ${this.title || '小说集合'} 分类下的热门小说列表` }\r\n      ]\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      title: '',\r\n      novels: [],\r\n      loading: true,\r\n      error: null\r\n    }\r\n  },\r\n  async asyncData({ query, $api, error }) {\r\n    try {\r\n      const title = query.title || '人气最佳'\r\n      \r\n      // 加载小说集合数据\r\n      const novels = await $api.novels.getCollectionNovels(title, 1, 100)\r\n      \r\n      return {\r\n        title,\r\n        novels: novels || [],\r\n        loading: false\r\n      }\r\n    } catch (err) {\r\n      console.error('加载集合数据失败:', err)\r\n      return {\r\n        title: query.title || '人气最佳',\r\n        novels: [],\r\n        loading: false,\r\n        error: `加载集合数据失败: ${err.message || '未知错误'}`\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    '$route.query.title': {\r\n      handler(newTitle) {\r\n        if (newTitle && newTitle !== this.title) {\r\n          this.title = newTitle\r\n          this.refreshCollections()\r\n        }\r\n      },\r\n      immediate: true\r\n    }\r\n  },\r\n  mounted() {\r\n    // 调试信息\r\n    console.log('Collections页面挂载, 当前title:', this.title)\r\n    \r\n    // 检查页面路由和数据\r\n    this.checkPageData()\r\n  },\r\n  methods: {\r\n    // 刷新小说集合\r\n    async refreshCollections() {\r\n      this.loading = true\r\n      this.error = null\r\n      \r\n      try {\r\n        this.novels = await this.$api.novels.getCollectionNovels(this.title, 1, 100)\r\n      } catch (err) {\r\n        console.error('刷新集合数据失败:', err)\r\n        this.error = '刷新集合数据失败，请稍后重试'\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    \r\n    // 截断文本\r\n    truncateText(text, maxLength) {\r\n      if (!text) return ''\r\n      if (text.length <= maxLength) return text\r\n      return text.substring(0, maxLength) + '...'\r\n    },\r\n    \r\n    // 格式化数字\r\n    formatNumber(num) {\r\n      if (!num) return '0'\r\n      if (num >= 10000) {\r\n        return (num / 10000).toFixed(1) + '万'\r\n      } else if (num >= 1000) {\r\n        return (num / 1000).toFixed(1) + 'k'\r\n      }\r\n      return num.toString()\r\n    },\r\n    \r\n    // 格式化日期时间\r\n    formatDateTime(dateStr) {\r\n      if (!dateStr) return ''\r\n      const date = new Date(dateStr)\r\n      const now = new Date()\r\n      \r\n      const diffTime = Math.abs(now - date)\r\n      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24))\r\n      \r\n      if (diffDays < 1) {\r\n        return '今天'\r\n      } else if (diffDays < 7) {\r\n        return `${diffDays}天前`\r\n      } else {\r\n        return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`\r\n      }\r\n    },\r\n    \r\n    // 检查页面数据\r\n    checkPageData() {\r\n      // 检查URL参数是否存在\r\n      const urlParams = new URLSearchParams(window.location.search);\r\n      const titleParam = urlParams.get('title');\r\n      \r\n      console.log('URL参数检查 - title:', titleParam)\r\n      \r\n      // 如果URL有title参数但页面没有加载数据，尝试刷新\r\n      if (titleParam && this.novels.length === 0 && !this.loading && !this.error) {\r\n        console.log('URL有title参数但没有加载数据，尝试重新加载')\r\n        this.title = decodeURIComponent(titleParam)\r\n        this.refreshCollections()\r\n      }\r\n    }\r\n  }\r\n}\r\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./collections.vue?vue&type=style&index=0&id=0b72b0e3&prod&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"627ad04a\", content, true, context)\n};","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./collections.vue?vue&type=style&index=0&id=0b72b0e3&prod&lang=scss&scoped=true\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".collections-page[data-v-0b72b0e3]{max-width:1200px;margin:0 auto;padding:20px;background-color:#fff;min-height:calc(100vh - 140px)}.page-header[data-v-0b72b0e3]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:15px;border-bottom:1px solid #e0e0e0}.page-header .page-title[data-v-0b72b0e3]{font-size:24px;font-weight:bold;color:#947358;margin:0}.page-header .back-button[data-v-0b72b0e3]{padding:8px 16px;background-color:#947358;color:#fff;border-radius:4px;text-decoration:none;font-size:14px;transition:background-color .3s}.page-header .back-button[data-v-0b72b0e3]:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}.loading-container[data-v-0b72b0e3],.error-container[data-v-0b72b0e3],.empty-container[data-v-0b72b0e3]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px}.loading-container p[data-v-0b72b0e3],.error-container p[data-v-0b72b0e3],.empty-container p[data-v-0b72b0e3]{margin-top:20px;color:#666;font-size:16px}.loading-spinner[data-v-0b72b0e3]{width:50px;height:50px;border:5px solid rgba(148,115,88,.2);border-top-color:#947358;border-radius:50%;animation:spin-0b72b0e3 1s linear infinite}@keyframes spin-0b72b0e3{to{transform:rotate(360deg)}}.retry-button[data-v-0b72b0e3]{margin-top:15px;padding:8px 20px;background-color:#947358;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:14px}.retry-button[data-v-0b72b0e3]:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}.novels-grid[data-v-0b72b0e3]{display:grid;grid-template-columns:repeat(auto-fill, minmax(300px, 1fr));gap:25px;margin-top:20px}.novel-card[data-v-0b72b0e3]{display:flex;flex-direction:column;border-radius:8px;overflow:hidden;box-shadow:0 2px 12px rgba(0,0,0,.08);transition:transform .3s,box-shadow .3s;background-color:#fff;height:100%}.novel-card[data-v-0b72b0e3]:hover{transform:translateY(-5px);box-shadow:0 5px 15px rgba(0,0,0,.1)}.novel-cover[data-v-0b72b0e3]{height:180px;background-size:cover;background-position:center;position:relative}.novel-cover .novel-category[data-v-0b72b0e3]{position:absolute;top:10px;right:10px;background-color:rgba(0,0,0,.7);color:#fff;padding:3px 8px;border-radius:4px;font-size:12px}.novel-info[data-v-0b72b0e3]{padding:15px;display:flex;flex-direction:column;flex-grow:1}.novel-title[data-v-0b72b0e3]{font-size:18px;font-weight:bold;margin:0 0 10px;color:#333;line-height:1.4;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical}.novel-author-info[data-v-0b72b0e3]{display:flex;align-items:center;margin-bottom:12px}.novel-author-info .author-avatar[data-v-0b72b0e3]{width:24px;height:24px;border-radius:50%;margin-right:8px;object-fit:cover}.novel-author-info .author-name[data-v-0b72b0e3]{font-size:14px;color:#666}.novel-desc[data-v-0b72b0e3]{font-size:14px;color:#666;margin:0 0 15px;line-height:1.5;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;flex-grow:1}.novel-stats[data-v-0b72b0e3]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:8px}.novel-stats span[data-v-0b72b0e3]{font-size:12px;color:#666}.novel-update-time[data-v-0b72b0e3]{font-size:12px;color:#666;margin-bottom:15px}.read-button[data-v-0b72b0e3]{padding:8px 0;background-color:#947358;color:#fff;border-radius:4px;text-align:center;text-decoration:none;font-size:14px;transition:background-color .3s}.read-button[data-v-0b72b0e3]:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}@media(max-width: 768px){.novels-grid[data-v-0b72b0e3]{grid-template-columns:repeat(auto-fill, minmax(250px, 1fr))}}@media(max-width: 480px){.novels-grid[data-v-0b72b0e3]{grid-template-columns:1fr}}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./collections.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./collections.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./collections.vue?vue&type=template&id=0b72b0e3&scoped=true\"\nimport script from \"./collections.vue?vue&type=script&lang=js\"\nexport * from \"./collections.vue?vue&type=script&lang=js\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./collections.vue?vue&type=style&index=0&id=0b72b0e3&prod&lang=scss&scoped=true\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"0b72b0e3\",\n  \"6729a7aa\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACXA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AHNA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;;AIFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}