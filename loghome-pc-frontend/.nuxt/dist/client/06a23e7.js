(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{372:function(n,t,e){var content=e(404);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[n.i,content,""]]),content.locals&&(n.exports=content.locals);(0,e(33).default)("295baf2c",content,!0,{sourceMap:!1})},403:function(n,t,e){"use strict";e(372)},404:function(n,t,e){var r=e(32)(!1);r.push([n.i,'@keyframes spin-7a16d500{to{transform:rotate(360deg)}}.fans-page[data-v-7a16d500]{max-width:1000px;margin:0 auto;padding:0 20px}.fans-page .page-header[data-v-7a16d500]{display:flex;align-items:center;margin:20px 0}.fans-page .page-header .back-link[data-v-7a16d500]{color:#666;text-decoration:none;margin-right:15px}.fans-page .page-header .back-link[data-v-7a16d500]:hover{color:#ea7034}.fans-page .page-header .back-link .back-icon[data-v-7a16d500]{font-size:20px;margin-right:5px}.fans-page .page-header .page-title[data-v-7a16d500]{margin:0;font-size:24px;color:#333}.fans-page .loading-container[data-v-7a16d500],.fans-page .error-container[data-v-7a16d500]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:50px;text-align:center}.fans-page .loading-spinner[data-v-7a16d500]{width:50px;height:50px;border:5px solid rgba(148,115,88,.2);border-top-color:#947358;border-radius:50%;animation:spin-7a16d500 1s linear infinite;margin-bottom:20px}.fans-page .back-button[data-v-7a16d500]{padding:8px 16px;border-radius:4px;cursor:pointer;transition:all .3s ease;font-size:14px;background-color:#947358;color:#fff;text-decoration:none;margin-top:20px;border:none}.fans-page .fans-container[data-v-7a16d500]{background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.1);padding:20px;margin-bottom:40px}.fans-page .fans-container .novel-info[data-v-7a16d500]{display:flex;margin-bottom:30px}.fans-page .fans-container .novel-info .novel-cover[data-v-7a16d500]{width:120px;height:160px;background-size:cover;background-position:center;border-radius:8px;margin-right:20px;flex-shrink:0;box-shadow:0 4px 8px rgba(0,0,0,.15)}.fans-page .fans-container .novel-info .novel-details[data-v-7a16d500]{flex:1}.fans-page .fans-container .novel-info .novel-details .novel-title[data-v-7a16d500]{font-size:20px;font-weight:bold;margin:0 0 15px 0;color:#333}.fans-page .fans-container .novel-info .novel-details .novel-author[data-v-7a16d500]{display:flex;align-items:center;cursor:pointer}.fans-page .fans-container .novel-info .novel-details .novel-author .author-avatar[data-v-7a16d500],.fans-page .fans-container .novel-info .novel-details .novel-author .author-avatar-placeholder[data-v-7a16d500]{width:30px;height:30px;border-radius:50%;margin-right:10px}.fans-page .fans-container .novel-info .novel-details .novel-author .author-avatar[data-v-7a16d500]{object-fit:cover}.fans-page .fans-container .novel-info .novel-details .novel-author .author-avatar-placeholder[data-v-7a16d500]{display:flex;align-items:center;justify-content:center;background-color:#947358;color:#fff;font-weight:bold}.fans-page .fans-container .novel-info .novel-details .novel-author .author-name[data-v-7a16d500]{font-size:16px;color:#666}.fans-page .fans-container .novel-info .novel-details .novel-author .author-name[data-v-7a16d500]:hover{color:#947358}.fans-page .fans-container .fans-list-container[data-v-7a16d500]{margin-bottom:60px}.fans-page .fans-container .fans-list-container .section-title[data-v-7a16d500]{font-size:18px;color:#704c35;margin-bottom:20px;padding-bottom:10px;border-bottom:1px solid #eee}.fans-page .fans-container .fans-list-container .fans-list .fan-item[data-v-7a16d500]{display:flex;align-items:center;padding:15px 10px;border-bottom:1px solid #f5f5f5}.fans-page .fans-container .fans-list-container .fans-list .fan-item[data-v-7a16d500]:last-child{border-bottom:none}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank[data-v-7a16d500]{width:40px;display:flex;justify-content:center;align-items:center}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-number[data-v-7a16d500]{font-size:16px;font-weight:bold;color:#666}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-first[data-v-7a16d500],.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-second[data-v-7a16d500],.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-third[data-v-7a16d500]{width:24px;height:24px;display:flex;justify-content:center;align-items:center;color:#fff;font-weight:bold;font-size:14px;border-radius:50%}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-first[data-v-7a16d500]{background-color:#ff6b6b}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-second[data-v-7a16d500]{background-color:#ffb347}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-third[data-v-7a16d500]{background-color:#59c2a7}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-avatar[data-v-7a16d500]{margin:0 15px}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-avatar img[data-v-7a16d500]{width:50px;height:50px;border-radius:50%;object-fit:cover;cursor:pointer;transition:transform .2s}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-avatar img[data-v-7a16d500]:hover{transform:scale(1.05)}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details[data-v-7a16d500]{flex:1}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-info[data-v-7a16d500]{display:flex;justify-content:space-between;margin-bottom:8px}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-info .fan-name[data-v-7a16d500]{font-weight:bold;color:#ea7034;cursor:pointer}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-info .fan-name[data-v-7a16d500]:hover{text-decoration:underline}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-info .fan-value[data-v-7a16d500]{font-weight:bold;color:#ea7034}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-message[data-v-7a16d500]{padding:8px 12px;background-color:rgba(234,112,52,.1);border-radius:8px;font-size:14px;color:#666;position:relative}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-message[data-v-7a16d500]:before{content:"";position:absolute;top:-8px;left:15px;border-width:0 8px 8px;border-style:solid;border-color:rgba(0,0,0,0) rgba(0,0,0,0) rgba(234,112,52,.1)}.fans-page .fans-container .my-info-wrapper[data-v-7a16d500]{position:fixed;bottom:0;left:0;width:100%;z-index:10}.fans-page .fans-container .my-info-wrapper .my-info-rank[data-v-7a16d500]{background-color:rgba(0,0,0,.8);color:#fff;padding:6px 15px;border-top-right-radius:20px;font-size:14px;display:inline-block}.fans-page .fans-container .my-info-wrapper .my-info[data-v-7a16d500]{display:flex;align-items:center;background-color:rgba(0,0,0,.8);padding:10px 15px}.fans-page .fans-container .my-info-wrapper .my-info .my-avatar[data-v-7a16d500]{margin-right:15px}.fans-page .fans-container .my-info-wrapper .my-info .my-avatar img[data-v-7a16d500]{width:40px;height:40px;border-radius:50%;object-fit:cover}.fans-page .fans-container .my-info-wrapper .my-info .my-details[data-v-7a16d500]{display:flex;flex:1;justify-content:space-between;align-items:center}.fans-page .fans-container .my-info-wrapper .my-info .my-details .my-name[data-v-7a16d500]{color:#fff;font-weight:bold}.fans-page .fans-container .my-info-wrapper .my-info .my-details .my-value[data-v-7a16d500]{color:#ea7034;font-weight:bold}',""]),n.exports=r},429:function(n,t,e){"use strict";e.r(t);e(27);var r=e(12),o=e(0);e(37),e(21),e(28),e(51),e(52),e(34);function f(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function l(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?f(Object(e),!0).forEach((function(t){Object(r.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):f(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var c={asyncData:function(n){return Object(o.a)(regeneratorRuntime.mark((function t(){var e,r,o,f,l,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.params,r=n.query,o=n.$api,f=n.error,l=r.id||e.id){t.next=4;break}return t.abrupt("return",f({statusCode:404,message:"未找到小说ID"}));case 4:return t.prev=4,t.next=7,o.novels.getNovelById(l);case 7:if((c=t.sent)&&0!==c.length){t.next=10;break}return t.abrupt("return",f({statusCode:404,message:"找不到该小说"}));case 10:return t.next=12,o.novels.getNovelFans(l);case 12:return d=t.sent,t.abrupt("return",{loading:!1,error:null,novelId:l,novel:c[0],fansList:d||[]});case 16:return t.prev=16,t.t0=t.catch(4),console.error("加载粉丝榜失败",t.t0),t.abrupt("return",{loading:!1,error:"加载粉丝榜失败，请稍后重试",novelId:l,novel:{},fansList:[]});case 20:case"end":return t.stop()}}),t,null,[[4,16]])})))()},data:function(){return{loading:!1,error:null,novelId:null,novel:{},fansList:[],myInfo:{rank:"未上榜",fans_value:0,name:"",avatar_url:""},rankClasses:["rank-first","rank-second","rank-third"]}},head:function(){var n;return{title:null!==(n=this.novel)&&void 0!==n&&n.name?"".concat(this.novel.name," - 粉丝榜 - 原木社区"):"粉丝榜 - 原木社区"}},mounted:function(){var n=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!localStorage.getItem("token")){t.next=3;break}return t.next=3,n.getMyInfo();case 3:case"end":return t.stop()}}),t)})))()},methods:{getMyInfo:function(){var n=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=n.$auth.user){t.next=4;break}return t.abrupt("return");case 4:n.myInfo=l(l(l({},n.myInfo),e),{},{avatar_url:e.avatar,name:e.name||e.username}),i=0;case 6:if(!(i<n.fansList.length)){t.next=14;break}if(n.fansList[i].user_id!=e.id){t.next=11;break}return n.myInfo.rank="第 ".concat(i+1," 名"),n.myInfo.fans_value=n.fansList[i].fans_value,t.abrupt("break",14);case 11:i++,t.next=6;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("获取当前用户粉丝信息失败",t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()},gotoUserProfile:function(n){this.$router.push("/user/".concat(n))}}},d=(e(403),e(10)),component=Object(d.a)(c,(function(){var n=this,t=n._self._c;return t("div",{staticClass:"fans-page"},[t("div",{staticClass:"page-header"},[t("nuxt-link",{staticClass:"back-link",attrs:{to:"/read"}},[t("span",{staticClass:"back-icon"},[n._v("←")]),n._v(" 返回书库\n    ")]),n._v(" "),t("h1",{staticClass:"page-title"},[n._v(n._s(n.novel.name)+" - 粉丝榜")])],1),n._v(" "),n.loading?t("div",{staticClass:"loading-container"},[t("div",{staticClass:"loading-spinner"}),n._v(" "),t("p",[n._v("正在加载粉丝榜...")])]):n.error?t("div",{staticClass:"error-container"},[t("p",[n._v(n._s(n.error))]),n._v(" "),t("nuxt-link",{staticClass:"back-button",attrs:{to:"/novel/".concat(n.novelId)}},[n._v("返回小说详情")])],1):t("div",{staticClass:"fans-container"},[t("div",{staticClass:"novel-info"},[n.novel.picUrl?t("div",{staticClass:"novel-cover",style:"background-image: url(".concat(n.novel.picUrl,")")}):t("div",{staticClass:"novel-cover",style:"background-color: hsl(".concat(30*n.novel.novel_id%360,", 70%, 80%)")}),n._v(" "),t("div",{staticClass:"novel-details"},[t("h2",{staticClass:"novel-title"},[n._v(n._s(n.novel.name))]),n._v(" "),t("div",{staticClass:"novel-author",on:{click:function(t){return n.gotoUserProfile(n.novel.auther_id)}}},[n.novel.auther_avatar?t("img",{staticClass:"author-avatar",attrs:{src:n.novel.auther_avatar,alt:"作者头像"}}):t("div",{staticClass:"author-avatar-placeholder"},[n._v(n._s(n.novel.author_name?n.novel.author_name.charAt(0):"作"))]),n._v(" "),t("span",{staticClass:"author-name"},[n._v(n._s(n.novel.author_name||"佚名"))])])])]),n._v(" "),t("div",{staticClass:"fans-list-container"},[t("h3",{staticClass:"section-title"},[n._v("原木力榜 - 粉丝贡献排行")]),n._v(" "),t("div",{staticClass:"fans-list"},n._l(n.fansList,(function(e,r){return t("div",{key:e.user_id,staticClass:"fan-item"},[t("div",{staticClass:"fan-rank"},[t("div",{class:r<=2?n.rankClasses[r]:"rank-number"},[n._v(n._s(r+1))])]),n._v(" "),t("div",{staticClass:"fan-avatar"},[t("img",{attrs:{src:e.avatar_url,alt:"头像"},on:{click:function(t){return n.gotoUserProfile(e.user_id)}}})]),n._v(" "),t("div",{staticClass:"fan-details"},[t("div",{staticClass:"fan-info"},[t("span",{staticClass:"fan-name",on:{click:function(t){return n.gotoUserProfile(e.user_id)}}},[n._v(n._s(e.user_name))]),n._v(" "),t("span",{staticClass:"fan-value"},[n._v(n._s(e.fans_value))])]),n._v(" "),t("div",{staticClass:"fan-message"},[n._v("\n              此书只应天上有，当赏当赏！\n            ")])])])})),0)]),n._v(" "),n.$auth.loggedIn&&n.myInfo.name?t("div",{staticClass:"my-info-wrapper"},[t("div",{staticClass:"my-info-rank"},[n._v("\n        "+n._s(n.myInfo.rank)+"\n      ")]),n._v(" "),t("div",{staticClass:"my-info"},[t("div",{staticClass:"my-avatar"},[t("img",{attrs:{src:n.myInfo.avatar_url,alt:"我的头像"}})]),n._v(" "),t("div",{staticClass:"my-details"},[t("span",{staticClass:"my-name"},[n._v(n._s(n.myInfo.name))]),n._v(" "),t("span",{staticClass:"my-value"},[n._v(n._s(n.myInfo.fans_value))])])])]):n._e()])])}),[],!1,null,"7a16d500",null);t.default=component.exports}}]);