(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{522:function(n,e,t){var content=t(573);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[n.i,content,""]]),content.locals&&(n.exports=content.locals);(0,t(26).default)("6ad73c85",content,!0,{sourceMap:!1})},572:function(n,e,t){"use strict";t(522)},573:function(n,e,t){var r=t(25)(!1);r.push([n.i,'@keyframes spin-3681e4d4{to{transform:rotate(360deg)}}.fans-page[data-v-3681e4d4]{max-width:1000px;margin:0 auto;padding:0 20px}.fans-page .page-header[data-v-3681e4d4]{display:flex;align-items:center;margin:20px 0}.fans-page .page-header .back-link[data-v-3681e4d4]{color:#666;text-decoration:none;margin-right:15px}.fans-page .page-header .back-link[data-v-3681e4d4]:hover{color:#ea7034}.fans-page .page-header .back-link .back-icon[data-v-3681e4d4]{font-size:20px;margin-right:5px}.fans-page .page-header .page-title[data-v-3681e4d4]{margin:0;font-size:24px;color:#333}.fans-page .loading-container[data-v-3681e4d4],.fans-page .error-container[data-v-3681e4d4]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:50px;text-align:center}.fans-page .loading-spinner[data-v-3681e4d4]{width:50px;height:50px;border:5px solid rgba(148,115,88,.2);border-top-color:#947358;border-radius:50%;animation:spin-3681e4d4 1s linear infinite;margin-bottom:20px}.fans-page .back-button[data-v-3681e4d4]{padding:8px 16px;border-radius:4px;cursor:pointer;transition:all .3s ease;font-size:14px;background-color:#947358;color:#fff;text-decoration:none;margin-top:20px;border:none}.fans-page .fans-container[data-v-3681e4d4]{background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.1);padding:20px;margin-bottom:40px}.fans-page .fans-container .novel-info[data-v-3681e4d4]{display:flex;margin-bottom:30px}.fans-page .fans-container .novel-info .novel-cover[data-v-3681e4d4]{width:120px;height:160px;background-size:cover;background-position:center;border-radius:8px;margin-right:20px;flex-shrink:0;box-shadow:0 4px 8px rgba(0,0,0,.15)}.fans-page .fans-container .novel-info .novel-details[data-v-3681e4d4]{flex:1}.fans-page .fans-container .novel-info .novel-details .novel-title[data-v-3681e4d4]{font-size:20px;font-weight:bold;margin:0 0 15px 0;color:#333}.fans-page .fans-container .novel-info .novel-details .novel-author[data-v-3681e4d4]{display:flex;align-items:center;cursor:pointer}.fans-page .fans-container .novel-info .novel-details .novel-author .author-avatar[data-v-3681e4d4],.fans-page .fans-container .novel-info .novel-details .novel-author .author-avatar-placeholder[data-v-3681e4d4]{width:30px;height:30px;border-radius:50%;margin-right:10px}.fans-page .fans-container .novel-info .novel-details .novel-author .author-avatar[data-v-3681e4d4]{object-fit:cover}.fans-page .fans-container .novel-info .novel-details .novel-author .author-avatar-placeholder[data-v-3681e4d4]{display:flex;align-items:center;justify-content:center;background-color:#947358;color:#fff;font-weight:bold}.fans-page .fans-container .novel-info .novel-details .novel-author .author-name[data-v-3681e4d4]{font-size:16px;color:#666}.fans-page .fans-container .novel-info .novel-details .novel-author .author-name[data-v-3681e4d4]:hover{color:#947358}.fans-page .fans-container .fans-list-container[data-v-3681e4d4]{margin-bottom:60px}.fans-page .fans-container .fans-list-container .section-title[data-v-3681e4d4]{font-size:18px;color:#704c35;margin-bottom:20px;padding-bottom:10px;border-bottom:1px solid #eee}.fans-page .fans-container .fans-list-container .fans-list .fan-item[data-v-3681e4d4]{display:flex;align-items:center;padding:15px 10px;border-bottom:1px solid #f5f5f5}.fans-page .fans-container .fans-list-container .fans-list .fan-item[data-v-3681e4d4]:last-child{border-bottom:none}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank[data-v-3681e4d4]{width:40px;display:flex;justify-content:center;align-items:center}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-number[data-v-3681e4d4]{font-size:16px;font-weight:bold;color:#666}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-first[data-v-3681e4d4],.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-second[data-v-3681e4d4],.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-third[data-v-3681e4d4]{width:24px;height:24px;display:flex;justify-content:center;align-items:center;color:#fff;font-weight:bold;font-size:14px;border-radius:50%}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-first[data-v-3681e4d4]{background-color:#ff6b6b}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-second[data-v-3681e4d4]{background-color:#ffb347}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-rank .rank-third[data-v-3681e4d4]{background-color:#59c2a7}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-avatar[data-v-3681e4d4]{margin:0 15px}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-avatar img[data-v-3681e4d4]{width:50px;height:50px;border-radius:50%;object-fit:cover;cursor:pointer;transition:transform .2s}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-avatar img[data-v-3681e4d4]:hover{transform:scale(1.05)}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details[data-v-3681e4d4]{flex:1}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-info[data-v-3681e4d4]{display:flex;justify-content:space-between;margin-bottom:8px}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-info .fan-name[data-v-3681e4d4]{font-weight:bold;color:#ea7034;cursor:pointer}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-info .fan-name[data-v-3681e4d4]:hover{text-decoration:underline}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-info .fan-value[data-v-3681e4d4]{font-weight:bold;color:#ea7034}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-message[data-v-3681e4d4]{padding:8px 12px;background-color:rgba(234,112,52,.1);border-radius:8px;font-size:14px;color:#666;position:relative}.fans-page .fans-container .fans-list-container .fans-list .fan-item .fan-details .fan-message[data-v-3681e4d4]:before{content:"";position:absolute;top:-8px;left:15px;border-width:0 8px 8px;border-style:solid;border-color:rgba(0,0,0,0) rgba(0,0,0,0) rgba(234,112,52,.1)}.fans-page .fans-container .my-info-wrapper[data-v-3681e4d4]{position:fixed;bottom:0;left:0;width:100%;z-index:10}.fans-page .fans-container .my-info-wrapper .my-info-rank[data-v-3681e4d4]{background-color:rgba(0,0,0,.8);color:#fff;padding:6px 15px;border-top-right-radius:20px;font-size:14px;display:inline-block}.fans-page .fans-container .my-info-wrapper .my-info[data-v-3681e4d4]{display:flex;align-items:center;background-color:rgba(0,0,0,.8);padding:10px 15px}.fans-page .fans-container .my-info-wrapper .my-info .my-avatar[data-v-3681e4d4]{margin-right:15px}.fans-page .fans-container .my-info-wrapper .my-info .my-avatar img[data-v-3681e4d4]{width:40px;height:40px;border-radius:50%;object-fit:cover}.fans-page .fans-container .my-info-wrapper .my-info .my-details[data-v-3681e4d4]{display:flex;flex:1;justify-content:space-between;align-items:center}.fans-page .fans-container .my-info-wrapper .my-info .my-details .my-name[data-v-3681e4d4]{color:#fff;font-weight:bold}.fans-page .fans-container .my-info-wrapper .my-info .my-details .my-value[data-v-3681e4d4]{color:#ea7034;font-weight:bold}',""]),n.exports=r},624:function(n,e,t){"use strict";t.r(e);t(27);var r=t(9),o=t(0);t(20),t(17),t(18),t(36),t(37),t(6);function f(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function l(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?f(Object(t),!0).forEach((function(e){Object(r.a)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var c={asyncData:function(n){return Object(o.a)(regeneratorRuntime.mark((function e(){var t,r,o,f,l,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.params,r=n.query,o=n.$api,f=n.error,l=r.id||t.id){e.next=4;break}return e.abrupt("return",f({statusCode:404,message:"未找到小说ID"}));case 4:return e.prev=4,e.next=7,o.novels.getNovelById(l);case 7:if((c=e.sent)&&0!==c.length){e.next=10;break}return e.abrupt("return",f({statusCode:404,message:"找不到该小说"}));case 10:return e.next=12,o.novels.getNovelFans(l);case 12:return d=e.sent,e.abrupt("return",{loading:!1,error:null,novelId:l,novel:c[0],fansList:d||[]});case 16:return e.prev=16,e.t0=e.catch(4),console.error("加载粉丝榜失败",e.t0),e.abrupt("return",{loading:!1,error:"加载粉丝榜失败，请稍后重试",novelId:l,novel:{},fansList:[]});case 20:case"end":return e.stop()}}),e,null,[[4,16]])})))()},data:function(){return{loading:!1,error:null,novelId:null,novel:{},fansList:[],myInfo:{rank:"未上榜",fans_value:0,name:"",avatar_url:""},rankClasses:["rank-first","rank-second","rank-third"],isLogin:!1,userInfo:null}},head:function(){var n;return{title:null!==(n=this.novel)&&void 0!==n&&n.name?"".concat(this.novel.name," - 粉丝榜 - 原木社区"):"粉丝榜 - 原木社区"}},mounted:function(){var n=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.checkLoginStatus(),!n.isLogin){e.next=6;break}return e.next=4,n.getUserInfo();case 4:return e.next=6,n.getMyInfo();case 6:case"end":return e.stop()}}),e)})))()},methods:{checkLoginStatus:function(){var n=localStorage.getItem("token");return this.isLogin=!!n,this.isLogin},getUserInfo:function(){var n=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.isLogin){e.next=2;break}return e.abrupt("return",null);case 2:if(e.prev=2,n.userInfo){e.next=8;break}return e.next=6,n.$api.users.getUserProfile();case 6:(t=e.sent)&&(n.userInfo=t);case 8:return e.abrupt("return",n.userInfo);case 11:return e.prev=11,e.t0=e.catch(2),console.error("获取用户信息失败",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))()},getMyInfo:function(){var n=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n.userInfo){e.next=3;break}return e.abrupt("return");case 3:n.myInfo=l(l(l({},n.myInfo),n.userInfo),{},{avatar_url:n.userInfo.avatar,name:n.userInfo.name||n.userInfo.username}),i=0;case 5:if(!(i<n.fansList.length)){e.next=13;break}if(n.fansList[i].user_id!=n.userInfo.id){e.next=10;break}return n.myInfo.rank="第 ".concat(i+1," 名"),n.myInfo.fans_value=n.fansList[i].fans_value,e.abrupt("break",13);case 10:i++,e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("获取当前用户粉丝信息失败",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))()},gotoUserProfile:function(n){this.$router.push("/users/".concat(n))}}},d=(t(572),t(12)),component=Object(d.a)(c,(function(){var n=this,e=n._self._c;return e("div",{staticClass:"fans-page"},[e("div",{staticClass:"page-header"},[e("nuxt-link",{staticClass:"back-link",attrs:{to:"/read"}},[e("span",{staticClass:"back-icon"},[n._v("←")]),n._v(" 返回书库\n    ")]),n._v(" "),e("h1",{staticClass:"page-title"},[n._v(n._s(n.novel.name)+" - 粉丝榜")])],1),n._v(" "),n.loading?e("div",{staticClass:"loading-container"},[e("div",{staticClass:"loading-spinner"}),n._v(" "),e("p",[n._v("正在加载粉丝榜...")])]):n.error?e("div",{staticClass:"error-container"},[e("p",[n._v(n._s(n.error))]),n._v(" "),e("nuxt-link",{staticClass:"back-button",attrs:{to:"/novel/".concat(n.novelId)}},[n._v("返回小说详情")])],1):e("div",{staticClass:"fans-container"},[e("div",{staticClass:"novel-info"},[n.novel.picUrl?e("div",{staticClass:"novel-cover",style:"background-image: url(".concat(n.novel.picUrl,")")}):e("div",{staticClass:"novel-cover",style:"background-color: hsl(".concat(30*n.novel.novel_id%360,", 70%, 80%)")}),n._v(" "),e("div",{staticClass:"novel-details"},[e("h2",{staticClass:"novel-title"},[n._v(n._s(n.novel.name))]),n._v(" "),e("div",{staticClass:"novel-author",on:{click:function(e){return n.gotoUserProfile(n.novel.auther_id)}}},[n.novel.auther_avatar?e("img",{staticClass:"author-avatar",attrs:{src:n.novel.auther_avatar,alt:"作者头像"}}):e("div",{staticClass:"author-avatar-placeholder"},[n._v(n._s(n.novel.author_name?n.novel.author_name.charAt(0):"作"))]),n._v(" "),e("span",{staticClass:"author-name"},[n._v(n._s(n.novel.author_name||"佚名"))])])])]),n._v(" "),e("div",{staticClass:"fans-list-container"},[e("h3",{staticClass:"section-title"},[n._v("原木力榜 - 粉丝贡献排行")]),n._v(" "),e("div",{staticClass:"fans-list"},n._l(n.fansList,(function(t,r){return e("div",{key:t.user_id,staticClass:"fan-item"},[e("div",{staticClass:"fan-rank"},[e("div",{class:r<=2?n.rankClasses[r]:"rank-number"},[n._v(n._s(r+1))])]),n._v(" "),e("div",{staticClass:"fan-avatar"},[e("img",{attrs:{src:t.avatar_url,alt:"头像"},on:{click:function(e){return n.gotoUserProfile(t.user_id)}}})]),n._v(" "),e("div",{staticClass:"fan-details"},[e("div",{staticClass:"fan-info"},[e("span",{staticClass:"fan-name",on:{click:function(e){return n.gotoUserProfile(t.user_id)}}},[n._v(n._s(t.user_name))]),n._v(" "),e("span",{staticClass:"fan-value"},[n._v(n._s(t.fans_value))])]),n._v(" "),e("div",{staticClass:"fan-message"},[n._v("\n              此书只应天上有，当赏当赏！\n            ")])])])})),0)]),n._v(" "),n.isLogin&&n.myInfo.name?e("div",{staticClass:"my-info-wrapper"},[e("div",{staticClass:"my-info-rank"},[n._v("\n        "+n._s(n.myInfo.rank)+"\n      ")]),n._v(" "),e("div",{staticClass:"my-info"},[e("div",{staticClass:"my-avatar"},[e("img",{attrs:{src:n.myInfo.avatar_url,alt:"我的头像"}})]),n._v(" "),e("div",{staticClass:"my-details"},[e("span",{staticClass:"my-name"},[n._v(n._s(n.myInfo.name))]),n._v(" "),e("span",{staticClass:"my-value"},[n._v(n._s(n.myInfo.fans_value))])])])]):n._e()])])}),[],!1,null,"3681e4d4",null);e.default=component.exports}}]);