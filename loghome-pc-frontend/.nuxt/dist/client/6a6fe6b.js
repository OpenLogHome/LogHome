(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{524:function(e,t,r){var content=r(582);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(26).default)("0019bd7d",content,!0,{sourceMap:!1})},581:function(e,t,r){"use strict";r(524)},582:function(e,t,r){var n=r(25)(!1);n.push([e.i,'.new-work-page[data-v-a41543ac]{width:100%}.new-work-page .page-header[data-v-a41543ac]{margin-bottom:30px}.new-work-page .page-title[data-v-a41543ac]{font-size:32px;color:#704c35}.new-work-page .form-container[data-v-a41543ac]{display:grid;grid-template-columns:1fr 300px;gap:30px}.new-work-page .form-section[data-v-a41543ac]{background-color:#fff;border-radius:8px;padding:30px;box-shadow:0 2px 4px rgba(0,0,0,.1)}.new-work-page .form-group[data-v-a41543ac]{margin-bottom:25px}.new-work-page .form-label[data-v-a41543ac]{display:block;font-size:16px;font-weight:600;color:#333;margin-bottom:8px}.new-work-page .form-input[data-v-a41543ac],.new-work-page .form-textarea[data-v-a41543ac]{width:100%;padding:12px 15px;border:1px solid #eee;border-radius:4px;font-size:16px;color:#333;transition:border-color .3s ease}.new-work-page .form-input[data-v-a41543ac]:focus,.new-work-page .form-textarea[data-v-a41543ac]:focus{outline:none;border-color:#947358}.new-work-page .form-textarea[data-v-a41543ac]{resize:vertical;min-height:120px}.new-work-page .word-count[data-v-a41543ac]{text-align:right;font-size:14px;color:#888;margin-top:5px}.new-work-page .tags-select[data-v-a41543ac]{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}.new-work-page .tag-item[data-v-a41543ac]{padding:8px 15px;background-color:#f5f5f5;border-radius:4px;font-size:14px;color:#333;cursor:pointer;transition:all .3s ease;position:relative}.new-work-page .tag-item[data-v-a41543ac]:hover{background-color:hsl(0,0%,91.0784313725%)}.new-work-page .tag-item.selected[data-v-a41543ac]{background-color:hsl(18.2320441989,95.7671957672%,87.9411764706%);color:#fa6c2e;border:1px solid #fb7d46}.new-work-page .tag-item .activity-badge[data-v-a41543ac]{position:absolute;top:-8px;right:-8px;background-color:#fb7d46;color:#fff;font-size:12px;padding:2px 6px;border-radius:10px}.new-work-page .no-tags[data-v-a41543ac]{width:100%;padding:20px;text-align:center;color:#888;background-color:#f5f5f5;border-radius:4px}.new-work-page .agreement-group[data-v-a41543ac]{margin-top:30px}.new-work-page .checkbox-container[data-v-a41543ac]{display:flex;align-items:center;position:relative;padding-left:30px;cursor:pointer;font-size:16px;user-select:none}.new-work-page .checkbox-container input[data-v-a41543ac]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.new-work-page .checkbox-container .checkmark[data-v-a41543ac]{position:absolute;top:0;left:0;height:20px;width:20px;background-color:#f5f5f5;border:1px solid #eee;border-radius:3px}.new-work-page .checkbox-container:hover input~.checkmark[data-v-a41543ac]{background-color:hsl(0,0%,91.0784313725%)}.new-work-page .checkbox-container input:checked~.checkmark[data-v-a41543ac]{background-color:#fb7d46;border-color:#fb7d46}.new-work-page .checkbox-container .checkmark[data-v-a41543ac]:after{content:"";position:absolute;display:none}.new-work-page .checkbox-container input:checked~.checkmark[data-v-a41543ac]:after{display:block}.new-work-page .checkbox-container .checkmark[data-v-a41543ac]:after{left:7px;top:3px;width:5px;height:10px;border:solid #fff;border-width:0 2px 2px 0;transform:rotate(45deg)}.new-work-page .agreement-text[data-v-a41543ac]{font-size:15px;color:#333}.new-work-page .agreement-link[data-v-a41543ac]{color:#fb7d46;text-decoration:none}.new-work-page .agreement-link[data-v-a41543ac]:hover{text-decoration:underline}.new-work-page .form-actions[data-v-a41543ac]{display:flex;justify-content:flex-end;gap:15px;margin-top:30px}.new-work-page .cancel-button[data-v-a41543ac],.new-work-page .submit-button[data-v-a41543ac]{padding:12px 25px;border-radius:4px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease}.new-work-page .cancel-button[data-v-a41543ac]{background-color:#f5f5f5;color:#333;border:none}.new-work-page .cancel-button[data-v-a41543ac]:hover{background-color:hsl(0,0%,91.0784313725%)}.new-work-page .submit-button[data-v-a41543ac]{background-color:#fb7d46;color:#fff;border:none}.new-work-page .submit-button[data-v-a41543ac]:hover{background-color:#fa6c2e}.new-work-page .submit-button[data-v-a41543ac]:disabled{background-color:hsl(18.2320441989,95.7671957672%,82.9411764706%);cursor:not-allowed}.new-work-page .sidebar-section[data-v-a41543ac]{background-color:#fff;border-radius:8px;padding:20px;box-shadow:0 2px 4px rgba(0,0,0,.1)}.new-work-page .sidebar-title[data-v-a41543ac]{font-size:18px;color:#704c35;margin-bottom:15px;padding-bottom:10px;border-bottom:1px solid #eee}.new-work-page .tips-list[data-v-a41543ac]{list-style:none;padding:0;margin:0}.new-work-page .tip-item[data-v-a41543ac]{position:relative;padding:10px 0 10px 25px;border-bottom:1px solid #f5f5f5;color:#666;font-size:14px;line-height:1.5}.new-work-page .tip-item[data-v-a41543ac]:last-child{border-bottom:none}.new-work-page .tip-item[data-v-a41543ac]:before{content:"";position:absolute;left:0;top:14px;width:6px;height:6px;border-radius:50%;background-color:#fb7d46}@media(max-width: 992px){.new-work-page .form-container[data-v-a41543ac]{grid-template-columns:1fr}}',""]),e.exports=n},633:function(e,t,r){"use strict";r.r(t);r(61),r(62),r(28);var n=r(0);r(6),r(18),r(10),r(27),r(17),r(41),r(33),r(34);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,a){if(e){if("string"==typeof e)return c(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,l=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw l}}}}function c(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,r=Array(a);t<a;t++)r[t]=e[t];return r}var l={head:function(){return{title:"创建新作品 - 原木社区"}},data:function(){return{title:"",content:"",checked:!1,isSubmitting:!1,suggested_tags:[],selectedTags:[],novel_id:0}},mounted:function(){this.getSuggestedTags()},methods:{getSuggestedTags:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$api.library.getSuggestedTags(e.novel_id);case 3:r=t.sent,e.suggested_tags=r||[],e.suggested_tags.length>0&&(e.suggested_tags=e.suggested_tags.filter((function(e){return e.is_activity_tag}))),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("获取推荐标签失败:",t.t0),e.$notify.error({title:"错误",message:"获取推荐标签失败"}),e.suggested_tags=[];case 13:case"end":return t.stop()}}),t,null,[[0,8]])})))()},toggleTag:function(e){this.selectedTags.includes(e)?this.selectedTags=this.selectedTags.filter((function(t){return t!==e})):this.selectedTags.push(e)},addTag:function(e,t){var r=this;return Object(n.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==t.trim()){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,n.next=5,r.$api.library.addNovelTag(e,t);case 5:n.next=11;break;case 7:n.prev=7,n.t0=n.catch(2),console.error("添加标签失败:",n.t0),r.$notify.error({title:"错误",message:"添加标签失败: "+(n.t0.message||"未知错误")});case 11:case"end":return n.stop()}}),n,null,[[2,7]])})))()},submit:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,c,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.checked){t.next=3;break}return e.$notify.warning({title:"提示",message:"请先阅读并接受《原木社区用户内容上传协议》"}),t.abrupt("return");case 3:if(e.title.trim()){t.next=6;break}return e.$notify.warning({title:"提示",message:"请输入作品名称"}),t.abrupt("return");case 6:if(e.content.trim()){t.next=9;break}return e.$notify.warning({title:"提示",message:"请输入作品简介"}),t.abrupt("return");case 9:if(!e.isSubmitting){t.next=11;break}return t.abrupt("return");case 11:return e.isSubmitting=!0,t.prev=12,t.next=15,e.$api.essays.addNovel(e.title.trim(),e.content.trim());case 15:if(r=t.sent,!(e.selectedTags.length>0&&r&&r.insertId)){t.next=35;break}n=r.insertId,c=o(e.selectedTags),t.prev=19,c.s();case 21:if((l=c.n()).done){t.next=27;break}return d=l.value,t.next=25,e.addTag(n,d);case 25:t.next=21;break;case 27:t.next=32;break;case 29:t.prev=29,t.t0=t.catch(19),c.e(t.t0);case 32:return t.prev=32,c.f(),t.finish(32);case 35:e.$notify.success({title:"成功",message:"作品创建成功"}),setTimeout((function(){e.$router.push("/write")}),1500),t.next=43;break;case 39:t.prev=39,t.t1=t.catch(12),console.error("创建作品失败:",t.t1),e.$notify.error({title:"错误",message:"创建作品失败: "+(t.t1.message||"未知错误")});case 43:return t.prev=43,e.isSubmitting=!1,t.finish(43);case 46:case"end":return t.stop()}}),t,null,[[12,39,43,46],[19,29,32,35]])})))()}}},d=(r(581),r(12)),component=Object(d.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"new-work-page"},[e._m(0),e._v(" "),t("div",{staticClass:"form-container"},[t("div",{staticClass:"form-section"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("作品名称")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],staticClass:"form-input",attrs:{type:"text",placeholder:"请输入作品名称（不超过15个字符）",maxlength:"15"},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}}),e._v(" "),t("div",{staticClass:"word-count"},[e._v(e._s(e.title.length)+"/15")])]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("作品简介")]),e._v(" "),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],staticClass:"form-textarea",attrs:{placeholder:"请输入作品简介（不超过300个字符）",maxlength:"300",rows:"4"},domProps:{value:e.content},on:{input:function(t){t.target.composing||(e.content=t.target.value)}}}),e._v(" "),t("div",{staticClass:"word-count"},[e._v(e._s(e.content.length)+"/300")])]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("选择标签")]),e._v(" "),t("div",{staticClass:"tags-select"},[e._l(e.suggested_tags,(function(r){return t("div",{key:r.tag_id,staticClass:"tag-item",class:{selected:e.selectedTags.includes(r.tag_name)},on:{click:function(t){return e.toggleTag(r.tag_name)}}},[e._v("\n            "+e._s(r.tag_name)+"\n            "),r.is_activity_tag?t("span",{staticClass:"activity-badge"},[e._v("活动")]):e._e()])})),e._v(" "),e.suggested_tags.length?e._e():t("div",{staticClass:"no-tags"},[e._v("暂无推荐标签")])],2)]),e._v(" "),t("div",{staticClass:"form-group agreement-group"},[t("label",{staticClass:"checkbox-container"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"checked"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.checked)?e._i(e.checked,null)>-1:e.checked},on:{change:function(t){var r=e.checked,n=t.target,o=!!n.checked;if(Array.isArray(r)){var c=e._i(r,null);n.checked?c<0&&(e.checked=r.concat([null])):c>-1&&(e.checked=r.slice(0,c).concat(r.slice(c+1)))}else e.checked=o}}}),e._v(" "),t("span",{staticClass:"checkmark"}),e._v(" "),t("span",{staticClass:"agreement-text"},[e._v("我已经阅读并接受\n            "),t("nuxt-link",{staticClass:"agreement-link",attrs:{to:"/agreement/content"}},[e._v("《原木社区用户内容上传协议》")])],1)])]),e._v(" "),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"cancel-button",on:{click:function(t){return e.$router.push("/write")}}},[e._v("取消")]),e._v(" "),t("button",{staticClass:"submit-button",attrs:{disabled:e.isSubmitting},on:{click:e.submit}},[e._v(e._s(e.isSubmitting?"创建中...":"创建作品"))])])]),e._v(" "),e._m(1)])])}),[function(){var e=this._self._c;return e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[this._v("创建新作品")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"sidebar"},[t("div",{staticClass:"sidebar-section"},[t("h3",{staticClass:"sidebar-title"},[e._v("创作提示")]),e._v(" "),t("ul",{staticClass:"tips-list"},[t("li",{staticClass:"tip-item"},[e._v("作品名称简洁明了，容易记忆")]),e._v(" "),t("li",{staticClass:"tip-item"},[e._v("作品简介应当概括故事核心，吸引读者")]),e._v(" "),t("li",{staticClass:"tip-item"},[e._v("选择合适的标签有助于读者发现您的作品")]),e._v(" "),t("li",{staticClass:"tip-item"},[e._v("创建后可以在设置中修改作品信息")])])])])}],!1,null,"a41543ac",null);t.default=component.exports}}]);