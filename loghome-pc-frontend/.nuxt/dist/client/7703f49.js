(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{504:function(t,e,r){var map={"./af":363,"./af.js":363,"./ar":364,"./ar-dz":365,"./ar-dz.js":365,"./ar-kw":366,"./ar-kw.js":366,"./ar-ly":367,"./ar-ly.js":367,"./ar-ma":368,"./ar-ma.js":368,"./ar-ps":369,"./ar-ps.js":369,"./ar-sa":370,"./ar-sa.js":370,"./ar-tn":371,"./ar-tn.js":371,"./ar.js":364,"./az":372,"./az.js":372,"./be":373,"./be.js":373,"./bg":374,"./bg.js":374,"./bm":375,"./bm.js":375,"./bn":376,"./bn-bd":377,"./bn-bd.js":377,"./bn.js":376,"./bo":378,"./bo.js":378,"./br":379,"./br.js":379,"./bs":380,"./bs.js":380,"./ca":381,"./ca.js":381,"./cs":382,"./cs.js":382,"./cv":383,"./cv.js":383,"./cy":384,"./cy.js":384,"./da":385,"./da.js":385,"./de":386,"./de-at":387,"./de-at.js":387,"./de-ch":388,"./de-ch.js":388,"./de.js":386,"./dv":389,"./dv.js":389,"./el":390,"./el.js":390,"./en-au":391,"./en-au.js":391,"./en-ca":392,"./en-ca.js":392,"./en-gb":393,"./en-gb.js":393,"./en-ie":394,"./en-ie.js":394,"./en-il":395,"./en-il.js":395,"./en-in":396,"./en-in.js":396,"./en-nz":397,"./en-nz.js":397,"./en-sg":398,"./en-sg.js":398,"./eo":399,"./eo.js":399,"./es":400,"./es-do":401,"./es-do.js":401,"./es-mx":402,"./es-mx.js":402,"./es-us":403,"./es-us.js":403,"./es.js":400,"./et":404,"./et.js":404,"./eu":405,"./eu.js":405,"./fa":406,"./fa.js":406,"./fi":407,"./fi.js":407,"./fil":408,"./fil.js":408,"./fo":409,"./fo.js":409,"./fr":410,"./fr-ca":411,"./fr-ca.js":411,"./fr-ch":412,"./fr-ch.js":412,"./fr.js":410,"./fy":413,"./fy.js":413,"./ga":414,"./ga.js":414,"./gd":415,"./gd.js":415,"./gl":416,"./gl.js":416,"./gom-deva":417,"./gom-deva.js":417,"./gom-latn":418,"./gom-latn.js":418,"./gu":419,"./gu.js":419,"./he":420,"./he.js":420,"./hi":421,"./hi.js":421,"./hr":422,"./hr.js":422,"./hu":423,"./hu.js":423,"./hy-am":424,"./hy-am.js":424,"./id":425,"./id.js":425,"./is":426,"./is.js":426,"./it":427,"./it-ch":428,"./it-ch.js":428,"./it.js":427,"./ja":429,"./ja.js":429,"./jv":430,"./jv.js":430,"./ka":431,"./ka.js":431,"./kk":432,"./kk.js":432,"./km":433,"./km.js":433,"./kn":434,"./kn.js":434,"./ko":435,"./ko.js":435,"./ku":436,"./ku-kmr":437,"./ku-kmr.js":437,"./ku.js":436,"./ky":438,"./ky.js":438,"./lb":439,"./lb.js":439,"./lo":440,"./lo.js":440,"./lt":441,"./lt.js":441,"./lv":442,"./lv.js":442,"./me":443,"./me.js":443,"./mi":444,"./mi.js":444,"./mk":445,"./mk.js":445,"./ml":446,"./ml.js":446,"./mn":447,"./mn.js":447,"./mr":448,"./mr.js":448,"./ms":449,"./ms-my":450,"./ms-my.js":450,"./ms.js":449,"./mt":451,"./mt.js":451,"./my":452,"./my.js":452,"./nb":453,"./nb.js":453,"./ne":454,"./ne.js":454,"./nl":455,"./nl-be":456,"./nl-be.js":456,"./nl.js":455,"./nn":457,"./nn.js":457,"./oc-lnc":458,"./oc-lnc.js":458,"./pa-in":459,"./pa-in.js":459,"./pl":460,"./pl.js":460,"./pt":461,"./pt-br":462,"./pt-br.js":462,"./pt.js":461,"./ro":463,"./ro.js":463,"./ru":464,"./ru.js":464,"./sd":465,"./sd.js":465,"./se":466,"./se.js":466,"./si":467,"./si.js":467,"./sk":468,"./sk.js":468,"./sl":469,"./sl.js":469,"./sq":470,"./sq.js":470,"./sr":471,"./sr-cyrl":472,"./sr-cyrl.js":472,"./sr.js":471,"./ss":473,"./ss.js":473,"./sv":474,"./sv.js":474,"./sw":475,"./sw.js":475,"./ta":476,"./ta.js":476,"./te":477,"./te.js":477,"./tet":478,"./tet.js":478,"./tg":479,"./tg.js":479,"./th":480,"./th.js":480,"./tk":481,"./tk.js":481,"./tl-ph":482,"./tl-ph.js":482,"./tlh":483,"./tlh.js":483,"./tr":484,"./tr.js":484,"./tzl":485,"./tzl.js":485,"./tzm":486,"./tzm-latn":487,"./tzm-latn.js":487,"./tzm.js":486,"./ug-cn":488,"./ug-cn.js":488,"./uk":489,"./uk.js":489,"./ur":490,"./ur.js":490,"./uz":491,"./uz-latn":492,"./uz-latn.js":492,"./uz.js":491,"./vi":493,"./vi.js":493,"./x-pseudo":494,"./x-pseudo.js":494,"./yo":495,"./yo.js":495,"./zh-cn":496,"./zh-cn.js":496,"./zh-hk":497,"./zh-hk.js":497,"./zh-mo":498,"./zh-mo.js":498,"./zh-tw":499,"./zh-tw.js":499};function o(t){var e=n(t);return r(e)}function n(t){if(!r.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}o.keys=function(){return Object.keys(map)},o.resolve=n,t.exports=o,o.id=504},537:function(t,e,r){var content=r(604);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(26).default)("77dd0e56",content,!0,{sourceMap:!1})},603:function(t,e,r){"use strict";r(537)},604:function(t,e,r){var o=r(25)(!1);o.push([t.i,".user-profile-page[data-v-0b8b423c]{max-width:1200px;margin:0 auto;padding:20px;background-color:#f8f9fa}.profile-header[data-v-0b8b423c]{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,.08);margin-bottom:24px}.cover-container[data-v-0b8b423c]{position:relative;height:300px;overflow:hidden}.cover-container .cover-image[data-v-0b8b423c]{width:100%;height:100%;object-fit:cover;cursor:pointer;transition:transform .3s ease}.cover-container .cover-image[data-v-0b8b423c]:hover{transform:scale(1.02)}.cover-container .cover-overlay[data-v-0b8b423c]{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center;flex-direction:column;color:#fff;cursor:pointer;opacity:0;transition:opacity .3s ease}.cover-container .cover-overlay[data-v-0b8b423c]:hover{opacity:1}.cover-container .cover-overlay i[data-v-0b8b423c]{font-size:32px;margin-bottom:8px}.cover-container .cover-overlay span[data-v-0b8b423c]{font-size:16px}.user-info-section[data-v-0b8b423c]{padding:30px;display:flex;justify-content:space-between;align-items:flex-start;margin-top:-80px;position:relative;z-index:2}.user-basic-info[data-v-0b8b423c]{display:flex;align-items:flex-start;flex:1}.avatar-container[data-v-0b8b423c]{margin-right:24px}.avatar-container .user-avatar[data-v-0b8b423c]{width:120px;height:120px;border-radius:12px;border:4px solid #fff;object-fit:cover;cursor:pointer;box-shadow:0 4px 16px rgba(0,0,0,.1);transition:transform .3s ease}.avatar-container .user-avatar[data-v-0b8b423c]:hover{transform:scale(1.05)}.user-details[data-v-0b8b423c]{flex:1;padding-top:20px}.user-name-section[data-v-0b8b423c]{margin-bottom:16px}.user-name-section .user-name[data-v-0b8b423c]{font-size:32px;font-weight:bold;color:#2c3e50;margin:0 0 8px 0}.user-name-section .user-id[data-v-0b8b423c]{background:rgba(0,0,0,.1);color:#666;padding:4px 12px;border-radius:16px;font-size:14px;margin-right:12px}.user-groups[data-v-0b8b423c]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;margin-top:8px}.user-groups .user-group[data-v-0b8b423c]{padding:4px 12px;border-radius:16px;font-size:12px;font-weight:500}.user-groups .user-group.founder[data-v-0b8b423c]{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:#fff}.user-groups .user-group.copemate[data-v-0b8b423c]{background:linear-gradient(135deg, #f093fb 0%, #f5576c 100%);color:#fff}.user-groups .user-group.nonTitle[data-v-0b8b423c]{display:none}.user-groups .admin-badge[data-v-0b8b423c]{background:#5af;color:#fff;padding:4px 12px;border-radius:16px;font-size:12px;display:flex;align-items:center}.user-groups .admin-badge .admin-icon[data-v-0b8b423c]{width:16px;height:16px;margin-right:4px}.user-motto[data-v-0b8b423c]{color:#666;font-size:16px;line-height:1.5;margin-bottom:20px}.follow-stats[data-v-0b8b423c]{display:flex;gap:32px}.follow-stats .stat-item[data-v-0b8b423c]{cursor:pointer;transition:transform .2s ease}.follow-stats .stat-item[data-v-0b8b423c]:hover{transform:translateY(-2px)}.follow-stats .stat-item .stat-number[data-v-0b8b423c]{display:block;font-size:24px;font-weight:bold;color:#2c3e50}.follow-stats .stat-item .stat-label[data-v-0b8b423c]{display:block;font-size:14px;color:#666;margin-top:4px}.action-buttons[data-v-0b8b423c]{display:flex;gap:12px;align-items:flex-start;padding-top:20px}.content-tabs[data-v-0b8b423c]{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,.08)}.tab-header[data-v-0b8b423c]{display:flex;border-bottom:1px solid #eee}.tab-header .tab-item[data-v-0b8b423c]{flex:1;padding:20px;text-align:center;font-size:16px;font-weight:500;color:#666;cursor:pointer;transition:all .3s ease;border-bottom:3px solid rgba(0,0,0,0)}.tab-header .tab-item[data-v-0b8b423c]:hover{color:#947358;background:#f8f9fa}.tab-header .tab-item.active[data-v-0b8b423c]{color:#947358;border-bottom-color:#947358;background:#fff}.tab-content[data-v-0b8b423c]{min-height:400px;padding:30px}.works-grid[data-v-0b8b423c]{display:grid;grid-template-columns:repeat(auto-fill, minmax(200px, 1fr));gap:24px}.works-grid .work-item[data-v-0b8b423c]{cursor:pointer;transition:transform .3s ease}.works-grid .work-item[data-v-0b8b423c]:hover{transform:translateY(-4px)}.works-grid .work-item .work-cover[data-v-0b8b423c]{width:100%;height:280px;object-fit:cover;border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,.1)}.works-grid .work-item .work-info[data-v-0b8b423c]{padding:12px 0}.works-grid .work-item .work-info .work-title[data-v-0b8b423c]{font-size:16px;font-weight:500;color:#2c3e50;margin:0;text-align:center}.posts-list .post-item[data-v-0b8b423c]{background:#f8f9fa;border-radius:12px;padding:24px;margin-bottom:20px;cursor:pointer;transition:all .3s ease}.posts-list .post-item[data-v-0b8b423c]:hover{background:#f0f1f3;transform:translateY(-2px)}.posts-list .post-item .post-header[data-v-0b8b423c]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.posts-list .post-item .post-header .post-circle[data-v-0b8b423c]{background:#947358;color:#fff;padding:4px 12px;border-radius:16px;font-size:12px;cursor:pointer}.posts-list .post-item .post-header .post-circle[data-v-0b8b423c]:hover{background:#826347}.posts-list .post-item .post-header .post-time[data-v-0b8b423c]{color:#999;font-size:14px}.posts-list .post-item .post-content[data-v-0b8b423c]{margin-bottom:16px}.posts-list .post-item .post-content .post-title[data-v-0b8b423c]{font-size:18px;font-weight:600;color:#2c3e50;margin:0 0 8px 0}.posts-list .post-item .post-content .post-text[data-v-0b8b423c]{color:#666;line-height:1.6;margin:0;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;overflow:hidden}.posts-list .post-item .post-images[data-v-0b8b423c]{margin:16px 0}.posts-list .post-item .post-images .image-grid[data-v-0b8b423c]{display:grid;gap:8px}.posts-list .post-item .post-images .image-grid.grid-1[data-v-0b8b423c]{grid-template-columns:1fr;max-width:400px}.posts-list .post-item .post-images .image-grid.grid-1 .post-image[data-v-0b8b423c]{height:300px}.posts-list .post-item .post-images .image-grid.grid-2[data-v-0b8b423c]{grid-template-columns:repeat(2, 1fr)}.posts-list .post-item .post-images .image-grid.grid-2 .post-image[data-v-0b8b423c]{height:200px}.posts-list .post-item .post-images .image-grid.grid-3[data-v-0b8b423c],.posts-list .post-item .post-images .image-grid.grid-multi[data-v-0b8b423c]{grid-template-columns:repeat(3, 1fr)}.posts-list .post-item .post-images .image-grid.grid-3 .post-image[data-v-0b8b423c],.posts-list .post-item .post-images .image-grid.grid-multi .post-image[data-v-0b8b423c]{height:150px}.posts-list .post-item .post-images .image-grid .post-image[data-v-0b8b423c]{width:100%;object-fit:cover;border-radius:8px;cursor:pointer;transition:transform .3s ease}.posts-list .post-item .post-images .image-grid .post-image[data-v-0b8b423c]:hover{transform:scale(1.02)}.posts-list .post-item .post-images .image-grid .image-count[data-v-0b8b423c]{position:absolute;right:8px;bottom:8px;background:rgba(0,0,0,.7);color:#fff;padding:4px 8px;border-radius:12px;font-size:12px}.posts-list .post-item .post-footer[data-v-0b8b423c]{display:flex;gap:24px;padding-top:16px;border-top:1px solid #eee}.posts-list .post-item .post-footer .post-action[data-v-0b8b423c]{display:flex;align-items:center;color:#666;font-size:14px}.posts-list .post-item .post-footer .post-action i[data-v-0b8b423c]{margin-right:6px;font-size:16px}.worlds-grid[data-v-0b8b423c]{display:grid;grid-template-columns:repeat(auto-fill, minmax(200px, 1fr));gap:24px}.worlds-grid .world-item[data-v-0b8b423c]{cursor:pointer;transition:transform .3s ease}.worlds-grid .world-item[data-v-0b8b423c]:hover{transform:translateY(-4px)}.worlds-grid .world-item .world-cover[data-v-0b8b423c]{width:100%;height:280px;object-fit:cover;border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,.1)}.worlds-grid .world-item .world-info[data-v-0b8b423c]{padding:12px 0}.worlds-grid .world-item .world-info .world-title[data-v-0b8b423c]{font-size:16px;font-weight:500;color:#2c3e50;margin:0;text-align:center}.empty-state[data-v-0b8b423c]{text-align:center;padding:60px 20px;color:#999}.empty-state i[data-v-0b8b423c]{font-size:64px;margin-bottom:16px;display:block}.empty-state p[data-v-0b8b423c]{font-size:16px;margin:0}.load-more[data-v-0b8b423c]{text-align:center;padding:30px 0}@media(min-width: 1200px){.user-profile-page[data-v-0b8b423c]{max-width:1400px;padding:30px}.works-grid[data-v-0b8b423c],.worlds-grid[data-v-0b8b423c]{grid-template-columns:repeat(auto-fill, minmax(220px, 1fr))}.cover-container[data-v-0b8b423c]{height:350px}}@media(max-width: 1199px)and (min-width: 992px){.user-profile-page[data-v-0b8b423c]{max-width:100%;padding:25px}.works-grid[data-v-0b8b423c],.worlds-grid[data-v-0b8b423c]{grid-template-columns:repeat(auto-fill, minmax(180px, 1fr))}}@media(max-width: 991px)and (min-width: 768px){.user-profile-page[data-v-0b8b423c]{padding:20px}.user-info-section[data-v-0b8b423c]{padding:25px}.user-name[data-v-0b8b423c]{font-size:28px !important}.user-avatar[data-v-0b8b423c]{width:100px !important;height:100px !important}.works-grid[data-v-0b8b423c],.worlds-grid[data-v-0b8b423c]{grid-template-columns:repeat(auto-fill, minmax(160px, 1fr));gap:20px}.cover-container[data-v-0b8b423c]{height:250px}}@media(max-width: 767px){.user-profile-page[data-v-0b8b423c]{padding:10px}.user-info-section[data-v-0b8b423c]{flex-direction:column;align-items:stretch;padding:20px;margin-top:-60px}.user-basic-info[data-v-0b8b423c]{flex-direction:column;align-items:center;text-align:center;margin-bottom:20px}.avatar-container[data-v-0b8b423c]{margin-right:0;margin-bottom:16px}.avatar-container .user-avatar[data-v-0b8b423c]{width:80px;height:80px}.user-name[data-v-0b8b423c]{font-size:24px !important}.action-buttons[data-v-0b8b423c]{justify-content:center;padding-top:0;flex-wrap:wrap}.follow-stats[data-v-0b8b423c]{justify-content:center;gap:20px}.works-grid[data-v-0b8b423c],.worlds-grid[data-v-0b8b423c]{grid-template-columns:repeat(auto-fill, minmax(140px, 1fr));gap:16px}.tab-content[data-v-0b8b423c]{padding:20px}.tab-header .tab-item[data-v-0b8b423c]{padding:16px 12px;font-size:14px}.cover-container[data-v-0b8b423c]{height:200px}.post-item[data-v-0b8b423c]{padding:16px}.post-item .post-title[data-v-0b8b423c]{font-size:16px !important}}@media(max-width: 480px){.user-profile-page[data-v-0b8b423c]{padding:8px}.user-info-section[data-v-0b8b423c]{padding:16px}.works-grid[data-v-0b8b423c],.worlds-grid[data-v-0b8b423c]{grid-template-columns:repeat(2, 1fr);gap:12px}.tab-content[data-v-0b8b423c]{padding:16px}.action-buttons .el-button[data-v-0b8b423c]{font-size:12px;padding:8px 12px}}",""]),t.exports=o},637:function(t,e,r){"use strict";r.r(e);r(27),r(28);var o=r(502),n=r(0),c=(r(151),r(52),r(6),r(72),r(359)),d=r.n(c),l={name:"UserProfile",layout:"default",data:function(){return{uid:null,user:{},userGroups:[],myUserInfo:{},fans:0,follows:0,isFollowing:!1,followLoading:!1,currentTab:0,userWorks:[],userPosts:[],postsPage:1,postsPageSize:10,postsHasMore:!0,postsLoading:!1,userWorlds:[],group2class:{"社区奠基人":"founder","原木体验官":"copemate","用户":"nonTitle","社区管理员":"nonTitle","系统消息":"nonTitle"}}},computed:{isCurrentUser:function(){return this.myUserInfo.user_id&&this.uid==this.myUserInfo.user_id}},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.uid=t.$route.params.id,e.next=3,t.loadUserInfo();case 3:return e.next=5,t.loadMyUserInfo();case 5:return e.next=7,t.loadUserStats();case 7:return e.next=9,t.loadUserWorks();case 9:return e.next=11,t.loadUserWorlds();case 11:case"end":return e.stop()}}),e)})))()},methods:{loadUserInfo:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.users.getUserInfo(t.uid);case 3:if(0!==(r=e.sent).code){e.next=9;break}t.user=r.data,t.user.user_group&&(t.userGroups=t.user.user_group.split(",")),e.next=10;break;case 9:throw new Error(r.message||"获取用户信息失败");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("加载用户信息失败",e.t0),t.$message.error("用户信息加载失败");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},loadMyUserInfo:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.users.getUserProfile();case 3:t.myUserInfo=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),e.t0.response&&401===e.t0.response.status&&localStorage.removeItem("token");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()},loadUserStats:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.users.getUserFans(t.uid);case 3:return 0===(r=e.sent).code&&(t.fans=r.data.length),e.next=7,t.$api.users.getUserFollows(t.uid);case 7:0===(o=e.sent).code&&(t.follows=o.data.length),t.myUserInfo.user_id&&!t.isCurrentUser&&t.checkFollowStatus(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("加载用户统计数据失败",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))()},checkFollowStatus:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.users.checkFollowStatus(t.uid);case 3:0===(r=e.sent).code&&(t.isFollowing=r.data.isFollowing),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("检查关注状态失败",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},loadUserWorks:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.users.getUserNovels(t.uid);case 3:if(0!==(r=e.sent).code){e.next=8;break}t.userWorks=r.data||[],e.next=9;break;case 8:throw new Error(r.message||"获取作品失败");case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("加载用户作品失败",e.t0),t.$message.error("作品信息加载失败");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},loadUserWorlds:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.users.getUserWorlds(t.uid);case 3:if(0!==(r=e.sent).code){e.next=8;break}t.userWorlds=r.data||[],e.next=9;break;case 8:throw new Error(r.message||"获取世界设定失败");case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("加载用户世界失败",e.t0),t.$message.error("世界信息加载失败");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},loadUserPosts:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.postsLoading&&t.postsHasMore){e.next=2;break}return e.abrupt("return");case 2:return t.postsLoading=!0,e.prev=3,e.next=6,t.$api.users.getUserPosts(t.uid,{page:t.postsPage,pageSize:t.postsPageSize});case 6:if(0!==(r=e.sent).code||!r.data||!r.data.list){e.next=14;break}n=r.data.list.map((function(t){if(t.media_urls&&"string"==typeof t.media_urls)try{t.media_urls=JSON.parse(t.media_urls)}catch(e){t.media_urls=[]}return t})),1===t.postsPage?t.userPosts=n:t.userPosts=[].concat(Object(o.a)(t.userPosts),Object(o.a)(n)),t.postsPage++,t.postsHasMore=t.userPosts.length<r.data.total,e.next=15;break;case 14:throw new Error(r.message||"获取动态失败");case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),console.error("加载用户动态失败",e.t0),t.$message.error("加载用户动态失败");case 21:return e.prev=21,t.postsLoading=!1,e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[3,17,21,24]])})))()},loadMorePosts:function(){this.loadUserPosts()},switchTab:function(t){this.currentTab=t,1===t&&0===this.userPosts.length&&this.loadUserPosts()},toggleFollow:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.myUserInfo.user_id){e.next=4;break}return t.$message.warning("请先登录"),t.$router.push("/login"),e.abrupt("return");case 4:if(t.myUserInfo.user_id!==t.uid){e.next=7;break}return t.$message.warning("不能关注自己"),e.abrupt("return");case 7:if(t.followLoading=!0,e.prev=8,!t.isFollowing){e.next=15;break}return e.next=12,t.$api.users.unfollowUser(t.uid);case 12:r=e.sent,e.next=18;break;case 15:return e.next=17,t.$api.users.followUser(t.uid);case 17:r=e.sent;case 18:if(0!==r.code){e.next=24;break}t.isFollowing=!t.isFollowing,t.fans+=t.isFollowing?1:-1,t.$message.success(t.isFollowing?"关注成功":"取消关注成功"),e.next=25;break;case 24:throw new Error(r.message||"操作失败");case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(8),console.error("关注操作失败",e.t0),t.$message.error("操作失败，请重试");case 31:return e.prev=31,t.followLoading=!1,e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[8,27,31,34]])})))()},sendPrivateMessage:function(){if(!this.myUserInfo.user_id)return this.$message.warning("请先登录"),void this.$router.push("/login");this.$router.push("/community/chat?id=".concat(this.uid))},editProfile:function(){this.$router.push("/users/change_user_info")},changeCoverImage:function(){this.$router.push("/users/top_pic_upload?noneAnimation=1")},previewCoverImage:function(){this.user.top_pic_url&&this.$preview([this.user.top_pic_url])},previewAvatar:function(){this.user.avatar_url&&this.$preview([this.user.avatar_url])},previewPostImages:function(t,e){this.$preview(t,e)},navigateToFriends:function(t){this.$router.push("/community/friends?id=".concat(this.uid,"&tab=").concat(t))},navigateToWork:function(t){t>0&&this.$router.push("/novel/".concat(t))},navigateToPost:function(t){this.$router.push("/community/post/".concat(t))},navigateToCircle:function(t){t&&0!==t?this.$router.push("/community/circle/".concat(t)):this.$message.warning("圈子不存在")},navigateToWorld:function(t){this.$router.push("/world/".concat(t))},getGroupClass:function(t){return this.group2class[t]||"nonTitle"},getImageGridClass:function(t){return 1===t?"grid-1":2===t?"grid-2":3===t?"grid-3":"grid-multi"},formatTime:function(time){var t=d()(),e=d()(time),r=t.diff(e,"minutes");if(r<1)return"刚刚";if(r<60)return"".concat(r,"分钟前");var o=t.diff(e,"hours");if(o<24)return"".concat(o,"小时前");var n=t.diff(e,"days");return n<30?"".concat(n,"天前"):e.format("YYYY-MM-DD")},getToken:function(){return JSON.parse(localStorage.getItem("token")||"{}").tk||null}}},m=(r(603),r(12)),component=Object(m.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-profile-page"},[e("div",{staticClass:"profile-header"},[e("div",{staticClass:"cover-container"},[e("img",{staticClass:"cover-image",attrs:{src:t.user.top_pic_url||"https://i.loli.net/2021/11/29/BxFmtyrS7GolgqM.jpg",alt:"背景封面"},on:{click:t.previewCoverImage}}),t._v(" "),t.isCurrentUser?e("div",{staticClass:"cover-overlay",on:{click:t.changeCoverImage}},[e("i",{staticClass:"el-icon-camera"}),t._v(" "),e("span",[t._v("更换封面")])]):t._e()]),t._v(" "),e("div",{staticClass:"user-info-section"},[e("div",{staticClass:"user-basic-info"},[e("div",{staticClass:"avatar-container"},[e("img",{staticClass:"user-avatar",attrs:{src:t.user.avatar_url||"/static/default-avatar.png",alt:"用户头像"},on:{click:t.previewAvatar}})]),t._v(" "),e("div",{staticClass:"user-details"},[e("div",{staticClass:"user-name-section"},[e("h1",{staticClass:"user-name"},[t._v(t._s(t.user.name))]),t._v(" "),e("span",{staticClass:"user-id"},[t._v("ID: "+t._s(t.uid))]),t._v(" "),e("div",{staticClass:"user-groups"},[t._l(t.userGroups,(function(r){return e("span",{key:r,staticClass:"user-group",class:t.getGroupClass(r)},[t._v("\n                "+t._s(r)+"\n              ")])})),t._v(" "),t.user.is_admin?e("span",{staticClass:"admin-badge"},[e("img",{staticClass:"admin-icon",attrs:{src:"/static/icons/admin.gif",alt:"管理员"}}),t._v("\n                社区管理员\n              ")]):t._e()],2)]),t._v(" "),e("div",{staticClass:"user-motto"},[t._v("\n            "+t._s(t.user.motto||"暂无简介")+"\n          ")]),t._v(" "),e("div",{staticClass:"follow-stats"},[e("div",{staticClass:"stat-item",on:{click:function(e){return t.navigateToFriends(1)}}},[e("span",{staticClass:"stat-number"},[t._v(t._s(t.fans))]),t._v(" "),e("span",{staticClass:"stat-label"},[t._v("粉丝")])]),t._v(" "),e("div",{staticClass:"stat-item",on:{click:function(e){return t.navigateToFriends(0)}}},[e("span",{staticClass:"stat-number"},[t._v(t._s(t.follows))]),t._v(" "),e("span",{staticClass:"stat-label"},[t._v("关注")])])])])]),t._v(" "),e("div",{staticClass:"action-buttons"},[t.isCurrentUser?t._e():e("el-button",{attrs:{type:t.isFollowing?"default":"primary",loading:t.followLoading},on:{click:t.toggleFollow}},[t._v("\n          "+t._s(t.isFollowing?"已关注":"关注")+"\n        ")]),t._v(" "),t.isCurrentUser?e("el-button",{attrs:{type:"primary"},on:{click:t.editProfile}},[t._v("\n          编辑资料\n        ")]):t._e(),t._v(" "),t.isCurrentUser?t._e():e("el-button",{on:{click:t.sendPrivateMessage}},[t._v("\n          私信\n        ")])],1)])]),t._v(" "),e("div",{staticClass:"content-tabs"},[e("div",{staticClass:"tab-header"},[e("div",{staticClass:"tab-item",class:{active:0===t.currentTab},on:{click:function(e){return t.switchTab(0)}}},[t._v("\n        作品\n      ")]),t._v(" "),e("div",{staticClass:"tab-item",class:{active:1===t.currentTab},on:{click:function(e){return t.switchTab(1)}}},[t._v("\n        动态\n      ")]),t._v(" "),e("div",{staticClass:"tab-item",class:{active:2===t.currentTab},on:{click:function(e){return t.switchTab(2)}}},[t._v("\n        世界\n      ")])]),t._v(" "),e("div",{staticClass:"tab-content"},[e("div",{directives:[{name:"show",rawName:"v-show",value:0===t.currentTab,expression:"currentTab === 0"}],staticClass:"works-content"},[t.userWorks.length>0?e("div",{staticClass:"works-grid"},t._l(t.userWorks,(function(r){return e("div",{directives:[{name:"show",rawName:"v-show",value:!r.is_personal,expression:"!work.is_personal"}],key:r.novel_id,staticClass:"work-item",on:{click:function(e){return t.navigateToWork(r.novel_id)}}},[e("img",{staticClass:"work-cover",attrs:{src:r.picUrl,alt:"作品封面"}}),t._v(" "),e("div",{staticClass:"work-info"},[e("h3",{staticClass:"work-title"},[t._v(t._s(r.name))])])])})),0):e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-document"}),t._v(" "),e("p",[t._v("暂无作品")])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.currentTab,expression:"currentTab === 1"}],staticClass:"posts-content"},[t.userPosts.length>0?e("div",{staticClass:"posts-list"},t._l(t.userPosts,(function(r){return e("div",{key:r.post_id,staticClass:"post-item",on:{click:function(e){return t.navigateToPost(r.post_id)}}},[e("div",{staticClass:"post-header"},[e("div",{staticClass:"post-circle",on:{click:function(e){return e.stopPropagation(),t.navigateToCircle(r.circle_id)}}},[t._v("\n                "+t._s(r.circle_name)+"\n              ")]),t._v(" "),e("div",{staticClass:"post-time"},[t._v(t._s(t.formatTime(r.create_time)))])]),t._v(" "),e("div",{staticClass:"post-content"},[e("h3",{staticClass:"post-title"},[t._v(t._s(r.title))]),t._v(" "),e("p",{staticClass:"post-text"},[t._v(t._s(r.content))])]),t._v(" "),r.media_urls&&r.media_urls.length>0?e("div",{staticClass:"post-images"},[e("div",{staticClass:"image-grid",class:t.getImageGridClass(r.media_urls.length)},[t._l(r.media_urls.slice(0,9),(function(img,o){return e("img",{key:o,staticClass:"post-image",attrs:{src:img,alt:"帖子图片"},on:{click:function(e){return e.stopPropagation(),t.previewPostImages(r.media_urls,o)}}})})),t._v(" "),r.media_urls.length>9?e("div",{staticClass:"image-count"},[t._v("\n                  +"+t._s(r.media_urls.length-9)+"\n                ")]):t._e()],2)]):t._e(),t._v(" "),e("div",{staticClass:"post-footer"},[e("div",{staticClass:"post-action"},[e("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" "),e("span",[t._v(t._s(r.comment_count||0))])]),t._v(" "),e("div",{staticClass:"post-action"},[e("i",{staticClass:"el-icon-star-off"}),t._v(" "),e("span",[t._v(t._s(r.like_count||0))])])])])})),0):e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" "),e("p",[t._v("暂无动态")])]),t._v(" "),t.postsHasMore&&t.userPosts.length>0?e("div",{staticClass:"load-more"},[e("el-button",{attrs:{loading:t.postsLoading},on:{click:t.loadMorePosts}},[t._v("\n            "+t._s(t.postsLoading?"加载中...":"加载更多")+"\n          ")])],1):t._e()]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2===t.currentTab,expression:"currentTab === 2"}],staticClass:"worlds-content"},[t.userWorlds.length>0?e("div",{staticClass:"worlds-grid"},t._l(t.userWorlds,(function(r){return e("div",{key:r.world_id,staticClass:"world-item",on:{click:function(e){return t.navigateToWorld(r.world_id)}}},[e("img",{staticClass:"world-cover",attrs:{src:r.picUrl,alt:"世界封面"}}),t._v(" "),e("div",{staticClass:"world-info"},[e("h3",{staticClass:"world-title"},[t._v(t._s(r.name))])])])})),0):e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-place"}),t._v(" "),e("p",[t._v("暂无世界")])])])])])])}),[],!1,null,"0b8b423c",null);e.default=component.exports}}]);