(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{500:function(e,t,r){"use strict";var n=r(3),o=r(501),c=r(221),l=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(c);n(n.P+n.F*l,"String",{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},501:function(e,t,r){var n=r(24),o=r(222),c=r(51);e.exports=function(e,t,r,l){var m=String(c(e)),d=m.length,h=void 0===r?" ":String(r),f=n(t);if(f<=d||""==h)return m;var v=f-d,x=o.call(h,Math.ceil(v/h.length));return x.length>v&&(x=x.slice(0,v)),l?x+m:m+x}},534:function(e,t,r){var content=r(597);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(26).default)("888ec344",content,!0,{sourceMap:!1})},596:function(e,t,r){"use strict";r(534)},597:function(e,t,r){var n=r(25)(!1);n.push([e.i,"@keyframes spin{to{transform:rotate(360deg)}}@keyframes slideDown{from{transform:translateY(-100%)}to{transform:translateY(0)}}@keyframes slideUp{from{transform:translateY(0)}to{transform:translateY(-100%)}}.article-page{max-width:1200px;margin:0 auto;padding:0;min-height:100vh;background-color:#f8f9fa}.article-page .loading-container,.article-page .error-container{display:flex;align-items:center;justify-content:center;flex-direction:column;min-height:300px;text-align:center;padding:50px}.article-page .loading-spinner{width:50px;height:50px;border:5px solid rgba(148,115,88,.2);border-top-color:#947358;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px}.article-page .back-button{padding:8px 16px;border-radius:4px;cursor:pointer;transition:all .3s ease;border:none;font-size:14px;background-color:#947358;color:#fff;padding:10px 20px;margin-top:20px}.article-page .article-container{position:relative}.article-page .article-header{background-color:hsla(0,0%,100%,.98);box-shadow:0 2px 8px rgba(0,0,0,.1);position:sticky;top:0;z-index:100;transition:transform .3s ease}.article-page .article-header.sticky .header-content{padding:10px 20px;display:flex;align-items:center;justify-content:space-between;max-width:1200px;margin:0 auto}.article-page .article-header.hidden{transform:translateY(-100%)}.article-page .novel-info{display:flex;align-items:center;justify-content:space-between;flex:1}.article-page .novel-title{color:#947358;font-size:18px;font-weight:bold;cursor:pointer;margin-right:20px}.article-page .novel-title:hover{text-decoration:underline}.article-page .reading-controls{margin-left:20px;display:flex;gap:20px;align-items:center}.article-page .reading-controls .control-item{display:flex;align-items:center}.article-page .reading-controls .control-item .control-label{color:#666;margin-right:8px;font-size:14px}.article-page .reading-controls .control-item .control-buttons{display:flex}.article-page .reading-controls .control-item .control-buttons button{padding:5px 10px;border:1px solid #ddd;background:none;margin:0 2px;cursor:pointer;border-radius:3px;font-size:14px}.article-page .reading-controls .control-item .control-buttons button.active{background-color:#947358;color:#fff;border-color:#947358}.article-page .theme-controls{display:flex;gap:8px}.article-page .theme-btn{width:24px;height:24px;border-radius:50%;cursor:pointer;border:2px solid rgba(0,0,0,0)}.article-page .theme-btn.active{border-color:#947358}.article-page .theme-btn.light{background-color:#fff;border:1px solid #ddd}.article-page .theme-btn.sepia{background-color:#f8f0e0}.article-page .theme-btn.dark{background-color:#282c35}.article-page .article-content-wrapper{padding:0;background-color:#fff;margin:0 auto}.article-page .article-content-wrapper.light{background-color:#fff;color:#333}.article-page .article-content-wrapper.sepia{background-color:#f8f0e0;color:#5b4636}.article-page .article-content-wrapper.dark{background-color:#282c35;color:#bbb}.article-page .article-title-container{text-align:center;padding:40px 20px 20px}.article-page .article-title-container .article-title{font-size:28px;font-weight:bold;margin-bottom:10px}.article-page .article-title-container .article-meta{font-size:14px}.article-page .article-title-container .article-meta span{margin:0 10px}.article-page .article-content{padding:30px 60px 60px;width:100%;line-height:1.8}.article-page .article-content p{margin-bottom:1.5em}.article-page .article-content .article-image{margin:2em 0;text-align:center}.article-page .article-content .article-image img{max-width:60%;height:auto;border-radius:4px;box-shadow:0 2px 8px rgba(0,0,0,.1)}.article-page .article-content .article-paragraph{transition:background-color .3s;border-radius:4px;padding:5px;position:relative}.article-page .article-content .article-paragraph.selected{background-color:rgba(148,115,88,.1)}.article-page .article-content .article-paragraph:hover{background-color:rgba(148,115,88,.05)}.article-page .article-content .article-paragraph .paragraph-comment-icon{display:inline-flex;align-items:center;justify-content:center;margin-left:8px;padding:3px 6px;border-radius:10px;background-color:rgba(148,115,88,.1);color:#947358;font-size:12px;cursor:pointer;white-space:nowrap;vertical-align:middle;transition:all .2s ease}.article-page .article-content .article-paragraph .paragraph-comment-icon i{margin-right:3px;font-size:14px}.article-page .article-content .article-paragraph .paragraph-comment-icon:hover{background-color:#947358;color:#fff}.article-page .empty-content{color:#888;font-style:italic;text-align:center;padding:60px 0}.article-page .article-footer{padding:20px;display:flex;align-items:center;justify-content:space-between;border-top:1px solid #eee;margin-top:50px;background-color:hsla(0,0%,100%,.95)}.article-page .chapter-nav{display:flex;gap:10px}.article-page .chapter-nav button{padding:8px 16px;border-radius:4px;cursor:pointer;transition:all .3s ease;border:none;font-size:14px}.article-page .chapter-nav button.nav-btn{background-color:#f5f5f5;color:#333}.article-page .chapter-nav button.nav-btn:hover:not(:disabled){background-color:#e9e9e9}.article-page .chapter-nav button.nav-btn:disabled{opacity:.5;cursor:not-allowed}.article-page .chapter-nav button.chapter-btn{background-color:#947358;color:#fff}.article-page .chapter-nav button.chapter-btn:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}.article-page .nav-icon{font-size:16px}.article-page .like-btn{padding:8px 16px;border-radius:4px;cursor:pointer;transition:all .3s ease;border:none;font-size:14px;display:flex;align-items:center;gap:8px;background-color:#fff0f0;color:#ff6b6b;border:1px solid #ff6b6b}.article-page .like-btn:hover{background-color:#ffe0e0}.article-page .like-btn.active{background-color:#ff6b6b;color:#fff}.article-page .like-icon{font-size:16px}.article-page .comment-section{margin:0 auto;padding:30px 40px;background-color:#fff;box-shadow:0 2px 12px rgba(0,0,0,.05);margin-top:20px;border-radius:8px}.article-page .comment-section h3{font-size:18px;font-weight:bold;color:#704c35;margin-bottom:20px;padding-bottom:10px;border-bottom:1px solid #f5f5f5}.article-page .comment-section h3 span{font-size:14px;color:#888;font-weight:normal}.article-page .comment-input{margin-bottom:30px}.article-page .comment-input .comment-textarea{width:100%;padding:15px;border:1px solid #ddd;border-radius:4px;resize:vertical;margin-bottom:10px;font-size:14px}.article-page .comment-input .comment-textarea:focus{border-color:#947358;outline:none}.article-page .comment-input .submit-comment-btn{padding:8px 16px;border-radius:4px;cursor:pointer;transition:all .3s ease;border:none;font-size:14px;background-color:#947358;color:#fff;float:right}.article-page .comment-input .submit-comment-btn:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}.article-page .comment-loading{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:40px 0}.article-page .comment-loading .loading-spinner{width:50px;height:50px;border:5px solid rgba(148,115,88,.2);border-top-color:#947358;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px;width:30px;height:30px;border-width:3px;margin-bottom:15px}.article-page .comment-loading p{color:#888;font-size:14px}.article-page .comment-empty{text-align:center;color:#888;padding:30px 0;font-style:italic}.article-page .comments-list{clear:both}.article-page .comment-item{display:flex;padding:20px 0;border-bottom:1px solid #f5f5f5}.article-page .comment-item:last-child{border-bottom:none}.article-page .comment-avatar{width:40px;height:40px;border-radius:50%;background-color:#947358;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:bold;margin-right:15px;flex-shrink:0;cursor:pointer;overflow:hidden}.article-page .comment-avatar img{width:100%;height:100%;object-fit:cover}.article-page .comment-avatar span{display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:16px;text-transform:uppercase}.article-page .comment-content{flex-grow:1}.article-page .comment-content .comment-header{margin-bottom:8px}.article-page .comment-content .comment-header .comment-username{font-weight:bold;color:#333;margin-right:10px;cursor:pointer}.article-page .comment-content .comment-header .comment-username:hover{color:#947358}.article-page .comment-content .comment-header .comment-time{font-size:12px;color:#888}.article-page .comment-content .comment-text{line-height:1.6;color:#333;word-break:break-word;margin-bottom:10px}.article-page .comment-actions{display:flex;align-items:center;margin-top:10px}.article-page .comment-actions .action-item{display:flex;align-items:center;margin-right:20px;cursor:pointer;color:#888;font-size:13px}.article-page .comment-actions .action-item i{margin-right:5px;font-size:16px}.article-page .comment-actions .action-item i.active{color:#ea7034}.article-page .comment-actions .action-item:hover{color:#947358}.article-page .replies-list{margin-top:10px;background-color:#f8f8f8;border-radius:4px;padding:10px 15px;margin-bottom:10px}.article-page .replies-list .reply-item{padding:8px 0;border-bottom:1px dashed rgba(0,0,0,.05)}.article-page .replies-list .reply-item:last-child{border-bottom:none}.article-page .replies-list .reply-item .reply-content{font-size:13px;line-height:1.5;margin-bottom:5px}.article-page .replies-list .reply-item .reply-content .reply-username{color:#947358;font-weight:bold;cursor:pointer}.article-page .replies-list .reply-item .reply-content .reply-username:hover{text-decoration:underline}.article-page .replies-list .reply-item .reply-content .reply-target{color:#888}.article-page .replies-list .reply-item .reply-content .reply-target-username{color:#947358;cursor:pointer}.article-page .replies-list .reply-item .reply-content .reply-target-username:hover{text-decoration:underline}.article-page .replies-list .reply-item .reply-content .reply-text{color:#333;word-break:break-word}.article-page .replies-list .reply-item .reply-actions{text-align:right}.article-page .replies-list .reply-item .reply-actions .reply-action{color:#888;font-size:12px;cursor:pointer}.article-page .replies-list .reply-item .reply-actions .reply-action:hover{color:#947358}.article-page .reply-input{margin-top:10px;background-color:#f8f8f8;border-radius:4px;padding:10px}.article-page .reply-input .reply-textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;resize:vertical;margin-bottom:10px;font-size:13px;background-color:#fff}.article-page .reply-input .reply-textarea:focus{border-color:#947358;outline:none}.article-page .reply-input .reply-buttons{text-align:right}.article-page .reply-input .reply-buttons button{padding:6px 12px;border-radius:4px;font-size:13px;cursor:pointer;border:none;margin-left:10px}.article-page .reply-input .reply-buttons button.cancel-reply-btn{background-color:#f0f0f0;color:#333}.article-page .reply-input .reply-buttons button.cancel-reply-btn:hover{background-color:#e0e0e0}.article-page .reply-input .reply-buttons button.submit-reply-btn{background-color:#947358;color:#fff}.article-page .reply-input .reply-buttons button.submit-reply-btn:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}.article-page .pagination{margin-top:30px;text-align:center}.article-page .pagination button{display:inline-block;min-width:32px;height:32px;margin:0 5px;padding:0 10px;text-align:center;line-height:32px;background:none;border:1px solid #ddd;border-radius:4px;cursor:pointer;font-size:14px;color:#333}.article-page .pagination button:hover{border-color:#947358;color:#947358}.article-page .pagination button.active{background-color:#947358;border-color:#947358;color:#fff}.article-page .paragraph-floating-panel{position:fixed;background-color:hsla(0,0%,100%,.95);padding:10px;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.15);z-index:1000;display:flex}.article-page .paragraph-floating-panel .panel-button{display:flex;flex-direction:column;align-items:center;padding:8px 12px;cursor:pointer;margin:0 5px;transition:all .2s}.article-page .paragraph-floating-panel .panel-button i{font-size:20px;margin-bottom:5px;color:#947358}.article-page .paragraph-floating-panel .panel-button span{font-size:12px;color:#333}.article-page .paragraph-floating-panel .panel-button:hover{background-color:rgba(148,115,88,.1);border-radius:5px}.article-page .paragraph-comment-drawer{position:fixed;top:0;right:0;bottom:0;width:100%;max-width:450px;background-color:#fff;box-shadow:-5px 0 15px rgba(0,0,0,.1);z-index:1001;transform:translateX(100%);transition:transform .3s ease;display:flex;flex-direction:column}.article-page .paragraph-comment-drawer.active{transform:translateX(0)}.article-page .paragraph-comment-drawer .drawer-header{padding:15px 20px;background-color:#947358;color:#fff;display:flex;align-items:center;justify-content:space-between}.article-page .paragraph-comment-drawer .drawer-header h3{margin:0;font-size:16px}.article-page .paragraph-comment-drawer .drawer-header .close-btn{background:none;border:none;color:#fff;font-size:24px;cursor:pointer;padding:0;line-height:1}.article-page .paragraph-comment-drawer .drawer-content{padding:20px;flex:1;overflow-y:auto}.article-page .paragraph-comment-drawer .drawer-content .paragraph-text{margin-bottom:20px}.article-page .paragraph-comment-drawer .drawer-content .paragraph-text blockquote{border-left:4px solid #947358;padding:10px 15px;background-color:rgba(148,115,88,.05);margin:0 0 20px 0;font-style:italic;color:#666}.article-page .paragraph-comment-drawer .drawer-content .comment-input{margin-bottom:30px}.article-page .paragraph-comment-drawer .drawer-content .comment-input textarea{width:100%;padding:12px;border:1px solid #ddd;border-radius:4px;resize:vertical;margin-bottom:10px}.article-page .paragraph-comment-drawer .drawer-content .comment-input textarea:focus{border-color:#947358;outline:none}.article-page .paragraph-comment-drawer .drawer-content .comment-input button{padding:8px 16px;border-radius:4px;cursor:pointer;transition:all .3s ease;border:none;font-size:14px;background-color:#947358;color:#fff;float:right}.article-page .paragraph-comment-drawer .drawer-content .comment-input button:hover{background-color:hsl(27,25.4237288136%,36.2745098039%)}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list{clear:both}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .empty-comments{padding:30px 0;text-align:center;color:#888;font-style:italic}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .paragraph-comment-item{display:flex;padding:15px 0;border-bottom:1px solid #f5f5f5}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .paragraph-comment-item:last-child{border-bottom:none}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .paragraph-comment-item .comment-avatar{width:36px;height:36px;border-radius:50%;background-color:#947358;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:bold;margin-right:12px;flex-shrink:0}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .paragraph-comment-item .comment-content{flex:1}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .paragraph-comment-item .comment-content .comment-header{margin-bottom:5px}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .paragraph-comment-item .comment-content .comment-header .comment-username{font-weight:bold;margin-right:10px}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .paragraph-comment-item .comment-content .comment-header .comment-time{font-size:12px;color:#888}.article-page .paragraph-comment-drawer .drawer-content .paragraph-comments-list .paragraph-comment-item .comment-content .comment-text{line-height:1.5}@media(max-width: 900px){.article-page .article-header .header-content{flex-direction:column;gap:10px}.article-page .novel-info{width:100%}.article-page .reading-controls{width:100%;justify-content:space-between}.article-page .article-content{padding:20px 30px}.article-page .paragraph-comment-drawer{width:100%}}",""]),e.exports=n},636:function(e,t,r){"use strict";r.r(t);r(27),r(10),r(17),r(41),r(34),r(20),r(36),r(37);var n=r(9),o=r(0);r(6),r(227),r(52),r(18),r(151),r(28),r(500),r(35);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,a){if(e){if("string"==typeof e)return d(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw c}}}}function d(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,r=Array(a);t<a;t++)r[t]=e[t];return r}var h={asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,o,article,c,l,m,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.params,n=e.$api,o=e.error,t.prev=1,t.next=4,n.articles.getArticle(r.id);case 4:if((article=t.sent)&&0!==article.length){t.next=7;break}return t.abrupt("return",o({statusCode:404,message:"找不到该章节"}));case 7:return c=article[0],t.next=10,n.novels.getNovelById(c.novel_id);case 10:if((l=t.sent)&&0!==l.length){t.next=13;break}return t.abrupt("return",o({statusCode:404,message:"找不到该小说"}));case 13:return t.next=15,n.articles.getArticles(c.novel_id);case 15:return m=t.sent,d=m.findIndex((function(e){return e.article_id===c.article_id})),t.abrupt("return",{article:c,novel:l[0],chapters:m||[],currentChapterIndex:d,loading:!1,error:null});case 20:return t.prev=20,t.t0=t.catch(1),console.error("加载章节内容失败",t.t0),t.abrupt("return",{loading:!1,error:"加载章节内容失败，请稍后重试",article:{},novel:{},chapters:[],currentChapterIndex:-1});case 24:case"end":return t.stop()}}),t,null,[[1,20]])})))()},data:function(){return{loading:!1,error:null,isLiked:!1,theme:"light",fontFamily:"default",fontSize:18,defaultFontSize:18,commentText:"",comments:[],showHeader:!0,lastScrollPosition:0,selectionMode:!1,selectedParagraph:null,panelPosition:{x:0,y:0},paragraphComments:{},showCommentDrawer:!1,currentParagraphId:null,paragraphCommentText:"",paragraphCommentsCount:{},commentTotal:0,commentsLoading:!0,pageSize:10,currentPage:1,replyingTo:null,replyText:"",userInfo:null}},computed:{hasPrevious:function(){return this.currentChapterIndex>0},hasNext:function(){return this.currentChapterIndex<this.chapters.length-1},formattedContent:function(){if(!this.article.content)return"";try{return JSON.parse(this.article.content).map((function(e){if("text"===e.type){var t=e.id;return'<p class="article-paragraph" id="paragraph-'.concat(t,'" data-paragraph-id="').concat(t,'" data-paragraph-text="').concat(encodeURIComponent(e.value),'">').concat(e.value,"</p>")}return"image"===e.type&&e.img?'<div class="article-image"><img src="'.concat(e.img,'" alt="文章插图" /></div>'):""})).join("")}catch(e){return this.article.content.split("\n").filter((function(e){return e.trim().length>0})).map((function(e){var t=e.id;return'<p class="article-paragraph" id="paragraph-'.concat(t,'" data-paragraph-id="').concat(t,'" data-paragraph-text="').concat(encodeURIComponent(e),'">').concat(e,"</p>")})).join("")}},getFontFamily:function(){switch(this.fontFamily){case"serif":return'"Noto Serif SC", "Songti SC", SimSun, serif';case"sans-serif":return'"Noto Sans SC", "Heiti SC", "Microsoft YaHei", sans-serif';default:return'"PingFang SC", "Helvetica Neue", Helvetica, Arial, sans-serif'}},totalPages:function(){return Math.ceil(this.commentTotal/this.pageSize)}},head:function(){var e,t;return{title:null!==(e=this.article)&&void 0!==e&&e.title?"".concat(this.article.title," - ").concat(this.novel.name||"阅读"," - 原木社区"):"阅读章节 - 原木社区",meta:[{hid:"description",name:"description",content:null!==(t=this.article)&&void 0!==t&&t.text?this.article.text.substring(0,150)+"...":"原木社区小说阅读"}]}},mounted:function(){this.loadPreferences(),this.recordRead(),this.fetchComments(),this.saveReaderHistory(),this.setupParagraphInteractions(),document.addEventListener("click",this.handleDocumentClick),window.addEventListener("scroll",this.handleScroll),this.fetchParagraphCommentsCount(),this.getUserInfo()},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll),document.removeEventListener("click",this.handleDocumentClick)},methods:{recordRead:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.article.article_id){t.next=9;break}return t.prev=1,t.next=4,e.$api.statistics.novelClicked(e.article.article_id);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.error("记录阅读行为失败",t.t0);case 9:case"end":return t.stop()}}),t,null,[[1,6]])})))()},saveReaderHistory:function(){var e=this;if(this.novel&&this.novel.novel_id)try{var t=JSON.parse(localStorage.getItem("loghomeReaderHistory"))||[];(t=t.filter((function(t){return t.novel_id!==e.novel.novel_id}))).push(this.novel),t.length>10&&(t=t.slice(-10)),localStorage.setItem("loghomeReaderHistory",JSON.stringify(t)),this.article.article_chapter&&localStorage.setItem("ReaderHistory_".concat(this.novel.novel_id),this.article.article_chapter)}catch(e){console.error("保存阅读历史失败",e)}},handleScroll:function(){var e=window.pageYOffset||document.documentElement.scrollTop;e<this.lastScrollPosition?this.showHeader=!0:e>50&&(this.showHeader=!1),this.lastScrollPosition=e},toggleLike:function(){this.isLiked=!this.isLiked},loadPreferences:function(){var e=localStorage.getItem("reading_theme"),t=localStorage.getItem("reading_font_size"),r=localStorage.getItem("reading_font_family");e&&(this.theme=e),t&&(this.fontSize=parseInt(t)),r&&(this.fontFamily=r)},savePreferences:function(){localStorage.setItem("reading_theme",this.theme),localStorage.setItem("reading_font_size",this.fontSize),localStorage.setItem("reading_font_family",this.fontFamily)},setTheme:function(e){this.theme=e,this.savePreferences()},setFont:function(e){this.fontFamily=e,this.savePreferences()},changeFontSize:function(e){this.fontSize=Math.max(14,Math.min(32,this.fontSize+e)),this.savePreferences()},resetFontSize:function(){this.fontSize=this.defaultFontSize,this.savePreferences()},navigateChapter:function(e){if("prev"===e&&this.hasPrevious){var t=this.chapters[this.currentChapterIndex-1];this.$router.push("/article/".concat(t.article_id))}else if("next"===e&&this.hasNext){var r=this.chapters[this.currentChapterIndex+1];this.$router.push("/article/".concat(r.article_id))}},goToNovelDetail:function(){this.$router.push("/novel/".concat(this.article.novel_id))},goBack:function(){this.$router.back()},formatNumber:function(e){return e>=1e4?(e/1e4).toFixed(1)+"万":e>=1e3?(e/1e3).toFixed(1)+"k":e},formatDate:function(e){if(!e)return"";var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"))},fetchComments:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.commentsLoading=!0,t.next=4,e.$api.community.getNovelCommentsAmount(e.novel.novel_id,e.article.article_id);case 4:return(r=t.sent)&&r.length>0&&(e.commentTotal=r[0]["COUNT(*)"]),t.next=8,e.$api.community.getArticleComments(e.novel.novel_id,e.article.article_id,e.currentPage,e.pageSize);case 8:if(!((n=t.sent)&&n.length>0)){t.next=15;break}return t.next=12,e.processComments(n);case 12:e.comments=t.sent,t.next=16;break;case 15:e.comments=[];case 16:t.next=23;break;case 18:t.prev=18,t.t0=t.catch(0),console.error("获取评论失败:",t.t0),e.$message.error("获取评论失败，请稍后重试"),e.comments=[];case 23:return t.prev=23,e.commentsLoading=!1,t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[0,18,23,26]])})))()},processComments:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,c,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=[],o=m(e),r.prev=2,d=regeneratorRuntime.mark((function r(){var o,m,d,h,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=c.value,r.next=3,t.$api.community.novel_commonts_reply_to(o.essay_comment_id);case 3:if(m=r.sent,d=!1,!localStorage.getItem("token")){r.next=10;break}return r.next=8,t.$api.community.getCommentPraiseStatus(o.essay_comment_id);case 8:h=r.sent,d=h&&h.length>0&&0===h[0].type;case 10:f=m?m.map((function(r){return{comment_id:r.essay_comment_id,userName:r.name,userId:r.user_id,targetUserName:t.findTargetUserName(r.reply_to_id,e,m),sendMsg:r.content,article_id:r.article_id}})):[],n.push(l(l({},o),{},{isLiked:d,reviewLess:f}));case 12:case"end":return r.stop()}}),r)})),o.s();case 5:if((c=o.n()).done){r.next=9;break}return r.delegateYield(d(),"t0",7);case 7:r.next=5;break;case 9:r.next=14;break;case 11:r.prev=11,r.t1=r.catch(2),o.e(r.t1);case 14:return r.prev=14,o.f(),r.finish(14);case 17:return r.abrupt("return",n);case 18:case"end":return r.stop()}}),r,null,[[2,11,14,17]])})))()},findTargetUserName:function(e,t,r){var n,o=m(t);try{for(o.s();!(n=o.n()).done;){var c=n.value;if(c.essay_comment_id===e)return c.name}}catch(e){o.e(e)}finally{o.f()}var l,d=m(r);try{for(d.s();!(l=d.n()).done;){var h=l.value;if(h.essay_comment_id===e)return h.name}}catch(e){d.e(e)}finally{d.f()}return null},getUserInfo:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(localStorage.getItem("token")){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,!(r=localStorage.getItem("LogHomeUserInfo"))){t.next=8;break}e.userInfo=JSON.parse(r),t.next=11;break;case 8:return t.next=10,e.$api.users.getUserProfile();case 10:e.userInfo=t.sent;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),console.error("获取用户信息失败:",t.t0);case 16:case"end":return t.stop()}}),t,null,[[2,13]])})))()},submitComment:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.commentText.trim()){t.next=3;break}return e.$message.info("评论内容不能为空"),t.abrupt("return");case 3:if(localStorage.getItem("token")){t.next=7;break}return e.$message.info("请先登录后再评论"),e.$router.push("/login?redirect=".concat(encodeURIComponent(e.$route.path))),t.abrupt("return");case 7:return t.prev=7,t.next=10,e.$api.community.commentOnArticle(e.novel.novel_id,e.article.article_id,e.commentText);case 10:e.commentText="",e.$message.success("评论发表成功"),e.currentPage=1,e.fetchComments(),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(7),console.error("提交评论失败:",t.t0),e.$message.error("评论发表失败，请稍后重试");case 20:case"end":return t.stop()}}),t,null,[[7,16]])})))()},handleLikeComment:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(localStorage.getItem("token")){r.next=4;break}return t.$message.info("请先登录后再点赞"),t.$router.push("/login?redirect=".concat(encodeURIComponent(t.$route.path))),r.abrupt("return");case 4:return r.prev=4,n=e.isLiked?3:0,r.next=8,t.$api.community.praiseComment(e.essay_comment_id,n);case 8:e.isLiked=!e.isLiked,e.likeNum=e.isLiked?(e.likeNum||0)+1:Math.max(0,(e.likeNum||0)-1),t.$message.success(e.isLiked?"点赞成功":"已取消点赞"),r.next=17;break;case 13:r.prev=13,r.t0=r.catch(4),console.error("点赞操作失败:",r.t0),t.$message.error("操作失败，请稍后重试");case 17:case"end":return r.stop()}}),r,null,[[4,13]])})))()},showReplyInput:function(e,t){if(!localStorage.getItem("token"))return this.$message.info("请先登录后再回复"),void this.$router.push("/login?redirect=".concat(encodeURIComponent(this.$route.path)));this.replyText="",this.replyingTo=t?{comment_id:e.essay_comment_id,reply_id:t.comment_id,replyToReply:!0,targetId:t.userId,targetName:t.userName}:{comment_id:e.essay_comment_id,replyToReply:!1,targetId:e.user_id,targetName:e.name}},cancelReply:function(){this.replyingTo=null,this.replyText=""},submitReply:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.replyText.trim()){r.next=3;break}return t.$message.info("回复内容不能为空"),r.abrupt("return");case 3:if(localStorage.getItem("token")){r.next=7;break}return t.$message.info("请先登录后再回复"),t.$router.push("/login?redirect=".concat(encodeURIComponent(t.$route.path))),r.abrupt("return");case 7:return r.prev=7,n=t.replyingTo.replyToReply?t.replyingTo.reply_id:e.essay_comment_id,r.next=11,t.$api.community.replyToComment(n,t.replyText,e.essay_comment_id,t.article.article_id);case 11:t.$message.success("回复发表成功"),t.replyText="",t.replyingTo=null,t.fetchComments(),r.next=21;break;case 17:r.prev=17,r.t0=r.catch(7),console.error("回复评论失败:",r.t0),t.$message.error("回复发表失败，请稍后重试");case 21:case"end":return r.stop()}}),r,null,[[7,17]])})))()},deleteComment:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(localStorage.getItem("token")){r.next=2;break}return r.abrupt("return");case 2:if(r.prev=2,!confirm("确定要删除这条评论吗？")){r.next=8;break}return r.next=6,t.$api.community.deleteComment(e.essay_comment_id);case 6:t.$message.success("评论已删除"),t.fetchComments();case 8:r.next=14;break;case 10:r.prev=10,r.t0=r.catch(2),console.error("删除评论失败:",r.t0),t.$message.error("删除失败，请稍后重试");case 14:case"end":return r.stop()}}),r,null,[[2,10]])})))()},canDeleteComment:function(e){return!(!localStorage.getItem("token")||!this.userInfo)&&(this.userInfo.user_id===e.user_id||this.userInfo.user_id===this.novel.author_id)},findUserIdByName:function(e){if(!e)return null;var t,r=m(this.comments);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.name===e)return n.user_id;if(n.reviewLess){var o,c=m(n.reviewLess);try{for(c.s();!(o=c.n()).done;){var l=o.value;if(l.userName===e)return l.userId}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){r.e(e)}finally{r.f()}return null},changePage:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.currentPage!==e){r.next=2;break}return r.abrupt("return");case 2:return t.currentPage=e,r.next=5,t.fetchComments();case 5:(n=document.querySelector(".comment-section"))&&n.scrollIntoView({behavior:"smooth"});case 7:case"end":return r.stop()}}),r)})))()},fetchParagraphCommentsCount:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,content,n,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.article&&e.article.content){t.next=3;break}return t.abrupt("return");case 3:r=[];try{content=JSON.parse(e.article.content),r=content.filter((function(e){return"text"===e.type})).map((function(e){return e.id}))}catch(e){console.log("not JSON format")}n=m(r),t.prev=6,c=regeneratorRuntime.mark((function t(){var r,n,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.value,t.next=3,e.$api.community.getNovelCommentsAmount(e.novel.novel_id,e.article.article_id,r);case 3:(n=t.sent)&&n.length>0&&(c=n[0]["COUNT(*)"])>0&&(e.$set(e.paragraphCommentsCount,r,c),e.$nextTick((function(){e.addCommentIconToParagraph(r,c)})));case 5:case"end":return t.stop()}}),t)})),n.s();case 9:if((o=n.n()).done){t.next=13;break}return t.delegateYield(c(),"t0",11);case 11:t.next=9;break;case 13:t.next=18;break;case 15:t.prev=15,t.t1=t.catch(6),n.e(t.t1);case 18:return t.prev=18,n.f(),t.finish(18);case 21:t.next=26;break;case 23:t.prev=23,t.t2=t.catch(0),console.error("获取段落评论数量失败",t.t2);case 26:case"end":return t.stop()}}),t,null,[[0,23],[6,15,18,21]])})))()},addCommentIconToParagraph:function(e,t){var r=this,n=document.getElementById("paragraph-".concat(e));if(n&&!n.querySelector(".paragraph-comment-icon")){var o=document.createElement("span");o.className="paragraph-comment-icon",o.innerHTML='<i class="el-icon-chat-line-round"></i> '.concat(t),o.title="".concat(t,"条评论"),o.addEventListener("click",(function(t){t.stopPropagation(),r.openParagraphCommentWindow(e)})),n.appendChild(o)}},openParagraphCommentWindow:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,!localStorage.getItem("token")){r.next=10;break}return r.next=5,t.$api.users.generateCrossSiteToken();case 5:n=r.sent.crossSiteToken,t.$windowManager.createWindow({title:"段落评论",url:"".concat("https://m.loghome.ink","/#/pages/users/external_login?token=").concat(n,"&redirectTo=").concat(encodeURIComponent("/pages/readers/bookComment?id=".concat(t.novel.novel_id,"&articleId=").concat(t.article.article_id,"&paragraphId=").concat(e)),"&hideback=true"),width:400,height:Math.min(800,window.screen.height-200)}),t.selectionMode&&t.clearSelection(),r.next=11;break;case 10:t.$router.push("/login");case 11:r.next=17;break;case 13:r.prev=13,r.t0=r.catch(0),console.error("打开段落评论窗口失败",r.t0),t.$message.error("打开评论窗口失败，请稍后重试");case 17:case"end":return r.stop()}}),r,null,[[0,13]])})))()},setupParagraphInteractions:function(){var e=this;setTimeout((function(){document.querySelectorAll(".article-paragraph").forEach((function(t){var r;t.addEventListener("contextmenu",(function(r){r.preventDefault(),e.handleParagraphRightClick(r,t)}));var n=!1;t.addEventListener("touchstart",(function(o){n=!0,r=setTimeout((function(){n&&e.handleParagraphLongPress(o,t)}),500)})),t.addEventListener("touchend",(function(){n=!1,clearTimeout(r)})),t.addEventListener("touchcancel",(function(){n=!1,clearTimeout(r)})),t.addEventListener("touchmove",(function(){n=!1,clearTimeout(r)}));var o=t.dataset.paragraphId;e.paragraphCommentsCount[o]&&e.addCommentIconToParagraph(o,e.paragraphCommentsCount[o])}))}),500)},handleParagraphRightClick:function(e,t){this.clearSelection();var r=t.dataset.paragraphId,n=decodeURIComponent(t.dataset.paragraphText);this.selectedParagraph={id:r,text:n,element:t},t.classList.add("selected"),this.panelPosition={x:Math.max(20,Math.min(e.clientX,window.innerWidth-300)),y:Math.min(e.clientY,window.innerHeight-100)},this.selectionMode=!0},handleParagraphLongPress:function(e,t){e.preventDefault(),this.clearSelection();var r=t.dataset.paragraphId,n=decodeURIComponent(t.dataset.paragraphText);this.selectedParagraph={id:r,text:n,element:t},t.classList.add("selected");var rect=t.getBoundingClientRect(),o=(rect.left+rect.right)/2-150,c=rect.bottom+10;this.panelPosition={x:Math.max(20,Math.min(o,window.innerWidth-300)),y:Math.min(c,window.innerHeight-100)},this.selectionMode=!0},clearSelection:function(){this.selectedParagraph&&(this.selectedParagraph.element.classList.remove("selected"),this.selectedParagraph=null),this.selectionMode=!1},handleCopy:function(){var e=this;if(this.selectedParagraph){var t="".concat(this.selectedParagraph.text,"\n\n—— 摘自《").concat(this.novel.name,"》");navigator.clipboard.writeText(t).then((function(){e.$message.success("内容已复制"),e.clearSelection()})).catch((function(){e.$message.error("复制失败")}))}},handleDocumentClick:function(e){!this.selectionMode||e.target.closest(".paragraph-floating-panel")||e.target.closest(".article-paragraph.selected")||this.clearSelection()},goToUserPage:function(e){this.$router.push("/users/".concat(e))}}},f=(r(596),r(12)),component=Object(f.a)(h,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"article-page"},[e.loading?t("div",{staticClass:"loading-container"},[t("div",{staticClass:"loading-spinner"}),e._v(" "),t("p",[e._v("正在加载内容...")])]):e.error?t("div",{staticClass:"error-container"},[t("p",[e._v(e._s(e.error))]),e._v(" "),t("button",{staticClass:"back-button",on:{click:e.goBack}},[e._v("返回")])]):t("div",{staticClass:"article-container"},[t("div",{staticClass:"article-header sticky"},[t("div",{staticClass:"header-content"},[t("div",{staticClass:"novel-info"},[t("div",{staticClass:"novel-title",on:{click:e.goToNovelDetail}},[e._v(e._s(e.novel.name))]),e._v(" "),t("div",{staticClass:"chapter-nav"},[t("button",{staticClass:"nav-btn",attrs:{disabled:!e.hasPrevious},on:{click:function(t){return e.navigateChapter("prev")}}},[t("span",{staticClass:"nav-icon"},[e._v("←")]),e._v(" 上一章\n            ")]),e._v(" "),t("button",{staticClass:"chapter-btn",on:{click:e.goToNovelDetail}},[t("span",{staticClass:"nav-icon"},[e._v("≡")]),e._v(" 目录\n            ")]),e._v(" "),t("button",{staticClass:"nav-btn",attrs:{disabled:!e.hasNext},on:{click:function(t){return e.navigateChapter("next")}}},[e._v("\n              下一章 "),t("span",{staticClass:"nav-icon"},[e._v("→")])])])]),e._v(" "),t("div",{staticClass:"reading-controls"},[t("div",{staticClass:"control-item"},[t("span",{staticClass:"control-label"},[e._v("字体：")]),e._v(" "),t("div",{staticClass:"control-buttons"},[t("button",{class:{active:"default"===e.fontFamily},on:{click:function(t){return e.setFont("default")}}},[e._v("默认")]),e._v(" "),t("button",{class:{active:"serif"===e.fontFamily},on:{click:function(t){return e.setFont("serif")}}},[e._v("宋体")]),e._v(" "),t("button",{class:{active:"sans-serif"===e.fontFamily},on:{click:function(t){return e.setFont("sans-serif")}}},[e._v("黑体")])])]),e._v(" "),t("div",{staticClass:"control-item"},[t("span",{staticClass:"control-label"},[e._v("字号：")]),e._v(" "),t("div",{staticClass:"control-buttons"},[t("button",{on:{click:function(t){return e.changeFontSize(-2)}}},[e._v("A-")]),e._v(" "),t("button",{on:{click:e.resetFontSize}},[e._v("A")]),e._v(" "),t("button",{on:{click:function(t){return e.changeFontSize(2)}}},[e._v("A+")])])]),e._v(" "),t("div",{staticClass:"control-item"},[t("span",{staticClass:"control-label"},[e._v("主题：")]),e._v(" "),t("div",{staticClass:"theme-controls"},[t("button",{staticClass:"theme-btn light",class:{active:"light"===e.theme},attrs:{title:"浅色模式"},on:{click:function(t){return e.setTheme("light")}}}),e._v(" "),t("button",{staticClass:"theme-btn sepia",class:{active:"sepia"===e.theme},attrs:{title:"护眼模式"},on:{click:function(t){return e.setTheme("sepia")}}}),e._v(" "),t("button",{staticClass:"theme-btn dark",class:{active:"dark"===e.theme},attrs:{title:"暗黑模式"},on:{click:function(t){return e.setTheme("dark")}}})])])])])]),e._v(" "),t("div",{staticClass:"article-content-wrapper",class:e.theme},[t("div",{staticClass:"article-title-container"},[t("h1",{staticClass:"article-title"},[e._v(e._s(e.article.title))]),e._v(" "),t("div",{staticClass:"article-meta"},[t("span",[e._v("作者: "+e._s(e.novel.author_name||"佚名"))]),e._v(" "),t("span",[e._v("更新: "+e._s(e.formatDate(e.article.update_time)))]),e._v(" "),t("span",[e._v("字数: "+e._s(e.formatNumber(e.article.text_count||0)))])])]),e._v(" "),t("div",{staticClass:"article-content",style:{fontSize:e.fontSize+"px",fontFamily:e.getFontFamily}},[e.article.content?t("div",{domProps:{innerHTML:e._s(e.formattedContent)}}):t("div",{staticClass:"empty-content"},[e._v("\n          暂无内容\n        ")])]),e._v(" "),t("div",{staticClass:"article-footer"},[t("div",{staticClass:"like-action"}),e._v(" "),t("div",{staticClass:"chapter-nav"},[t("button",{staticClass:"nav-btn",attrs:{disabled:!e.hasPrevious},on:{click:function(t){return e.navigateChapter("prev")}}},[t("span",{staticClass:"nav-icon"},[e._v("←")]),e._v(" 上一章\n          ")]),e._v(" "),t("button",{staticClass:"chapter-btn",on:{click:e.goToNovelDetail}},[t("span",{staticClass:"nav-icon"},[e._v("≡")]),e._v(" 目录\n          ")]),e._v(" "),t("button",{staticClass:"nav-btn",attrs:{disabled:!e.hasNext},on:{click:function(t){return e.navigateChapter("next")}}},[e._v("\n            下一章 "),t("span",{staticClass:"nav-icon"},[e._v("→")])])])])]),e._v(" "),t("div",{staticClass:"comment-section"},[t("h3",[e._v("读者评论 "),e.commentTotal>0?t("span",[e._v("("+e._s(e.commentTotal)+")")]):e._e()]),e._v(" "),t("div",{staticClass:"comment-input"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.commentText,expression:"commentText"}],staticClass:"comment-textarea",attrs:{placeholder:"分享你的想法...",rows:"3"},domProps:{value:e.commentText},on:{input:function(t){t.target.composing||(e.commentText=t.target.value)}}}),e._v(" "),t("button",{staticClass:"submit-comment-btn",on:{click:e.submitComment}},[e._v("发表评论")])]),e._v(" "),t("div",{staticClass:"comments-list"},[e.commentsLoading?t("div",{staticClass:"comment-loading"},[t("div",{staticClass:"loading-spinner"}),e._v(" "),t("p",[e._v("正在加载评论...")])]):0===e.comments.length?t("div",{staticClass:"comment-empty"},[e._v("\n          还没有评论，快来发表第一条评论吧！\n        ")]):e._l(e.comments,(function(r,n){return t("div",{key:r.essay_comment_id,staticClass:"comment-item"},[t("div",{staticClass:"comment-avatar",on:{click:function(t){return e.goToUserPage(r.user_id)}}},[r.avatar_url?t("img",{attrs:{src:r.avatar_url,alt:r.name}}):t("span",[e._v(e._s(r.name?r.name.charAt(0):"读"))])]),e._v(" "),t("div",{staticClass:"comment-content"},[t("div",{staticClass:"comment-header"},[t("span",{staticClass:"comment-username",on:{click:function(t){return e.goToUserPage(r.user_id)}}},[e._v(e._s(r.name||"匿名读者"))]),e._v(" "),t("span",{staticClass:"comment-time"},[e._v(e._s(e.formatDate(r.comment_time)))])]),e._v(" "),t("div",{staticClass:"comment-text"},[e._v(e._s(r.content))]),e._v(" "),t("div",{staticClass:"comment-actions"},[t("div",{staticClass:"action-item",on:{click:function(t){return e.handleLikeComment(r)}}},[t("i",{staticClass:"el-icon-thumb",class:{active:r.isLiked}}),e._v(" "),t("span",[e._v(e._s(r.likeNum||0))])]),e._v(" "),t("div",{staticClass:"action-item",on:{click:function(t){return e.showReplyInput(r)}}},[t("i",{staticClass:"el-icon-chat-line-round"}),e._v(" "),t("span",[e._v("回复")])]),e._v(" "),e.canDeleteComment(r)?t("div",{staticClass:"action-item",on:{click:function(t){return e.deleteComment(r)}}},[t("i",{staticClass:"el-icon-delete"}),e._v(" "),t("span",[e._v("删除")])]):e._e()]),e._v(" "),r.reviewLess&&r.reviewLess.length>0?t("div",{staticClass:"replies-list"},e._l(r.reviewLess,(function(n,o){return t("div",{key:n.comment_id,staticClass:"reply-item"},[t("div",{staticClass:"reply-content"},[t("span",{staticClass:"reply-username",on:{click:function(t){return e.goToUserPage(n.userId)}}},[e._v(e._s(n.userName||"匿名读者"))]),e._v(" "),n.targetUserName?t("span",{staticClass:"reply-target"},[e._v(" 回复 ")]):e._e(),e._v(" "),n.targetUserName?t("span",{staticClass:"reply-target-username",on:{click:function(t){e.goToUserPage(e.findUserIdByName(n.targetUserName))}}},[e._v(e._s(n.targetUserName))]):e._e(),e._v(":\n                  "),t("span",{staticClass:"reply-text"},[e._v(e._s(n.sendMsg))])]),e._v(" "),t("div",{staticClass:"reply-actions"},[t("span",{staticClass:"reply-action",on:{click:function(t){return e.showReplyInput(r,n)}}},[e._v("回复")])])])})),0):e._e(),e._v(" "),e.replyingTo&&e.replyingTo.comment_id===r.essay_comment_id?t("div",{staticClass:"reply-input"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.replyText,expression:"replyText"}],staticClass:"reply-textarea",attrs:{placeholder:e.replyingTo.replyToReply?"回复 ".concat(e.replyingTo.targetName):"写下你的回复...",rows:"2"},domProps:{value:e.replyText},on:{input:function(t){t.target.composing||(e.replyText=t.target.value)}}}),e._v(" "),t("div",{staticClass:"reply-buttons"},[t("button",{staticClass:"cancel-reply-btn",on:{click:e.cancelReply}},[e._v("取消")]),e._v(" "),t("button",{staticClass:"submit-reply-btn",on:{click:function(t){return e.submitReply(r)}}},[e._v("回复")])])]):e._e()])])})),e._v(" "),e.commentTotal>e.pageSize?t("div",{staticClass:"pagination"},e._l(e.totalPages,(function(r){return t("button",{key:r,class:{active:e.currentPage===r},on:{click:function(t){return e.changePage(r)}}},[e._v("\n            "+e._s(r)+"\n          ")])})),0):e._e()],2)]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.selectionMode,expression:"selectionMode"}],staticClass:"paragraph-floating-panel",style:{left:e.panelPosition.x+"px",top:e.panelPosition.y+"px"}},[t("div",{staticClass:"panel-button",on:{click:e.handleCopy}},[t("i",{staticClass:"el-icon-document-copy"}),e._v(" "),t("span",[e._v("复制")])]),e._v(" "),t("div",{staticClass:"panel-button",on:{click:function(t){return e.openParagraphCommentWindow(e.selectedParagraph.id)}}},[t("i",{staticClass:"el-icon-chat-line-round"}),e._v(" "),t("span",[e._v("评论")])])])])])}),[],!1,null,null,null);t.default=component.exports}}]);