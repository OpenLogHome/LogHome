(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{511:function(t,e,r){var content=r(550);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(26).default)("b17fe12a",content,!0,{sourceMap:!1})},549:function(t,e,r){"use strict";r(511)},550:function(t,e,r){var o=r(25)(!1);o.push([t.i,'.user-profile-container[data-v-3c2f45fe]{max-width:1200px;margin:0 auto;padding:20px}.profile-header[data-v-3c2f45fe]{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 12px 0 rgba(0,0,0,.1);margin-bottom:20px;position:relative}.header-background[data-v-3c2f45fe]{height:200px;position:relative;overflow:hidden}.header-background .cover-image[data-v-3c2f45fe]{width:100%;height:100%;object-fit:cover}.header-background .edit-cover[data-v-3c2f45fe]{position:absolute;right:20px;bottom:20px;background:rgba(0,0,0,.5);color:#fff;padding:5px 10px;border-radius:4px;cursor:pointer;font-size:14px}.header-background .edit-cover[data-v-3c2f45fe]:hover{background:rgba(0,0,0,.7)}.user-info-box[data-v-3c2f45fe]{padding:20px;display:flex;align-items:flex-start;margin-top:-50px;position:relative;z-index:1}.avatar-box[data-v-3c2f45fe]{position:relative;margin-right:20px}.avatar-box .avatar-image[data-v-3c2f45fe]{width:100px;height:100px;border-radius:8px;border:4px solid #fff;object-fit:cover;background-color:#f5f5f5}.avatar-box .edit-avatar[data-v-3c2f45fe]{position:absolute;right:-10px;bottom:-10px;width:30px;height:30px;border-radius:50%;background:#947358;color:#fff;display:flex;justify-content:center;align-items:center;cursor:pointer}.avatar-box .edit-avatar[data-v-3c2f45fe]:hover{background:#826347}.user-info[data-v-3c2f45fe]{flex:1;padding-top:10px}.user-name[data-v-3c2f45fe]{display:flex;align-items:center;flex-wrap:wrap}.user-name .name[data-v-3c2f45fe]{font-size:24px;font-weight:bold;margin-right:10px}.user-name .user-id[data-v-3c2f45fe]{background:rgba(0,0,0,.1);padding:2px 8px;border-radius:4px;font-size:14px;margin-right:10px}.user-name .user-group[data-v-3c2f45fe]{background:#947358;color:#fff;padding:2px 8px;border-radius:4px;font-size:12px;margin-right:5px;margin-bottom:5px}.user-motto[data-v-3c2f45fe]{color:#666;margin-top:10px;font-size:14px}.profile-body[data-v-3c2f45fe]{display:flex;gap:20px}.profile-body .left-panel[data-v-3c2f45fe]{width:300px;flex-shrink:0}.profile-body .right-panel[data-v-3c2f45fe]{flex:1}.card[data-v-3c2f45fe]{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 12px 0 rgba(0,0,0,.1);margin-bottom:20px;padding:20px}.card .card-title[data-v-3c2f45fe]{font-size:18px;font-weight:bold;margin-bottom:15px;color:#333;border-bottom:1px solid #f0f0f0;padding-bottom:10px}.action-items[data-v-3c2f45fe]{display:grid;grid-template-columns:repeat(3, 1fr);gap:15px}.action-item[data-v-3c2f45fe]{display:flex;flex-direction:column;align-items:center;cursor:pointer;transition:all .3s;padding:10px;border-radius:8px}.action-item[data-v-3c2f45fe]:hover{background:#f9f9f9}.action-item .action-icon[data-v-3c2f45fe]{width:48px;height:48px;background:#f0f0f0;border-radius:50%;display:flex;justify-content:center;align-items:center;margin-bottom:8px;font-size:24px;color:#947358}.action-item .action-icon.warning[data-v-3c2f45fe]{color:#f50;animation:pulse-3c2f45fe 1.5s infinite}.action-item .action-icon.new-message[data-v-3c2f45fe]{position:relative}.action-item .action-icon.new-message[data-v-3c2f45fe]:after{content:"";position:absolute;top:0;right:0;width:10px;height:10px;background:#f50;border-radius:50%}.action-item .action-text[data-v-3c2f45fe]{font-size:14px}.action-item .action-text.warning[data-v-3c2f45fe]{color:#f50;font-weight:bold}.tree-status[data-v-3c2f45fe]{display:flex;align-items:center;margin-bottom:15px;font-size:16px}.tree-status i[data-v-3c2f45fe]{margin-right:10px;font-size:20px;color:#947358}.tree-status.warning[data-v-3c2f45fe]{color:#f50}.tree-status.warning i[data-v-3c2f45fe]{color:#f50;animation:pulse-3c2f45fe 1.5s infinite}.balance-amount[data-v-3c2f45fe]{font-size:24px;font-weight:bold;color:#947358;margin-bottom:15px}.function-list[data-v-3c2f45fe]{display:grid;grid-template-columns:repeat(3, 1fr);gap:15px}.function-item[data-v-3c2f45fe]{display:flex;align-items:center;padding:10px;border-radius:8px;cursor:pointer;transition:all .3s}.function-item[data-v-3c2f45fe]:hover{background:#f9f9f9}.function-item i[data-v-3c2f45fe]{font-size:20px;color:#947358;margin-right:10px}.function-item span[data-v-3c2f45fe]{font-size:14px}.empty-works[data-v-3c2f45fe],.empty-bookcase[data-v-3c2f45fe]{display:flex;flex-direction:column;align-items:center;padding:30px 0;color:#999}.empty-works i[data-v-3c2f45fe],.empty-bookcase i[data-v-3c2f45fe]{font-size:48px;margin-bottom:15px}.empty-works p[data-v-3c2f45fe],.empty-bookcase p[data-v-3c2f45fe]{margin-bottom:15px}.works-grid[data-v-3c2f45fe]{display:grid;grid-template-columns:repeat(auto-fill, minmax(200px, 1fr));gap:20px;margin-top:15px}.work-item[data-v-3c2f45fe]{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.1);cursor:pointer;transition:all .3s ease}.work-item[data-v-3c2f45fe]:hover{transform:translateY(-4px);box-shadow:0 4px 16px rgba(0,0,0,.15)}.work-item .work-cover[data-v-3c2f45fe]{width:100%;height:120px;object-fit:cover;background-color:#f5f5f5}.work-item .work-info[data-v-3c2f45fe]{padding:15px}.work-item .work-info .work-title[data-v-3c2f45fe]{font-size:16px;font-weight:bold;color:#333;margin:0 0 8px 0;line-height:1.4;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.work-item .work-info .work-desc[data-v-3c2f45fe]{font-size:14px;color:#666;margin:0;line-height:1.4;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}@keyframes pulse-3c2f45fe{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}',""]),t.exports=o},623:function(t,e,r){"use strict";r.r(e);r(27),r(28),r(17),r(41),r(33),r(34);var o=r(0);r(6),r(151),r(10),r(53),r(54),r(72);function n(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,a){if(t){if("string"==typeof t)return c(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?c(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw l}}}}function c(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,r=Array(a);e<a;e++)r[e]=t[e];return r}var l={layout:"default",data:function(){return{user:{},userGroups:[],hasNewMessage:!1,hasNewPrivateMessage:!1,treeState:"无",earningsMoney:0,userWorks:[],userBookcase:[],worksLoading:!1,bookcaseLoading:!1}},mounted:function(){this.loadUserInfo(),this.checkMessages(),this.checkTreePlant(),this.refreshResources(),this.loadUserWorks()},methods:{loadUserInfo:function(){var t=localStorage.getItem("LogHomeUserInfo");if(t)return this.user=JSON.parse(t),void(this.user.user_group&&(this.userGroups=this.user.user_group.split(",")));this.fetchUserInfo()},fetchUserInfo:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.users.getUserProfile();case 3:t.user=e.sent,t.user.user_group&&(t.userGroups=t.user.user_group.split(",")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("获取用户资料失败",e.t0),e.t0.response&&401===e.t0.response.status&&(localStorage.removeItem("token"),t.$router.push("/login?msg=unAuthorized"));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getToken:function(){var t=JSON.parse(localStorage.getItem("token"));return t?t.tk:null},checkMessages:function(){""===localStorage.getItem("messages")&&localStorage.setItem("messages","[]");var t,e=n(JSON.parse(localStorage.getItem("messages")||"[]"));try{for(e.s();!(t=e.n()).done;){var r=t.value;if(0===r.is_read&&r.to_id===this.user.user_id){this.hasNewMessage=!0;break}}}catch(t){e.e(t)}finally{e.f()}var o=localStorage.getItem("unreadPrivateMessages");this.hasNewPrivateMessage=o&&parseInt(o)>0},checkTreePlant:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.treePlant.getTreePlantInfo();case 3:r=e.sent,t.treeState=r.treeState,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("获取树场信息失败",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},refreshResources:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$api.resources.getUserResources();case 3:r=e.sent,t.earningsMoney=r.earningsMoney,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("获取资源信息失败",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},loadUserWorks:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.worksLoading=!0,e.prev=1,e.next=4,t.$api.users.getUserNovels(t.user.user_id);case 4:if(0!==(r=e.sent).code){e.next=9;break}t.userWorks=r.data||[],e.next=10;break;case 9:throw new Error(r.message||"获取作品失败");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("加载用户作品失败",e.t0),t.$message.error("作品信息加载失败");case 16:return e.prev=16,t.worksLoading=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,12,16,19]])})))()},bankNum:function(t){if(isNaN(t))return t;var s=t.toFixed(2).toString();return s.substring(0,s.indexOf(".")+3)},changeCoverImage:function(){this.$router.push("/users/top_pic_upload?noneAnimation=1")},changeUserInfo:function(){this.$router.push("/users/change_user_info")},viewUserProfile:function(){this.$router.push("/users/personalPage?id="+this.user.user_id)},gotoMessages:function(){this.$router.push("/community/message"),this.hasNewMessage=!1,this.hasNewPrivateMessage=!1},gotoFriends:function(){this.$router.push("/community/friends")},gotoSettings:function(){this.$router.push("/users/clientSet")},activate:function(){this.$router.push("/users/activateAccount")},gotoTreePlant:function(){this.$router.push("/treePlant/treeplant")},gotoEarnings:function(){this.$router.push("/payments/earnings")},gotoCredits:function(){this.$router.push("/users/user_credit")},gotoRecharge:function(){this.$router.push("/payments/recharge")},gotoAbout:function(){this.$router.push("/apps/about")},gotoFeedback:function(){this.$router.push("/apps/faqs/faq")},gotoClientSet:function(){this.$router.push("/users/clientSet")},gotoAdmin:function(){this.$router.push("/manage/index")},gotoWrite:function(){this.$router.push("/write")},gotoLibrary:function(){this.$router.push("/read")},navigateToWork:function(t){t>0&&this.$router.push("/novel/".concat(t))}}},f=(r(549),r(12)),component=Object(f.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-profile-container"},[e("div",{staticClass:"profile-header"},[e("div",{staticClass:"header-background"},[e("img",{staticClass:"cover-image",attrs:{src:t.user.top_pic_url||"https://i.loli.net/2021/11/29/BxFmtyrS7GolgqM.jpg",alt:"背景图片"}}),t._v(" "),e("div",{staticClass:"edit-cover",on:{click:t.changeCoverImage}},[e("i",{staticClass:"el-icon-camera"}),t._v(" 更换封面\n      ")])]),t._v(" "),e("div",{staticClass:"user-info-box"},[e("div",{staticClass:"avatar-box"},[e("img",{staticClass:"avatar-image",attrs:{src:t.user.avatar_url||"../static/user/defaultAvatar.jpg",alt:"用户头像"}}),t._v(" "),e("div",{staticClass:"edit-avatar",on:{click:t.changeUserInfo}},[e("i",{staticClass:"el-icon-edit"})])]),t._v(" "),e("div",{staticClass:"user-info"},[e("div",{staticClass:"user-name"},[e("span",{staticClass:"name"},[t._v(t._s(t.user.name))]),t._v(" "),e("span",{staticClass:"user-id"},[t._v("ID: "+t._s(t.user.user_id))]),t._v(" "),t._l(t.userGroups,(function(r){return e("span",{key:r,staticClass:"user-group"},[t._v(t._s(r))])}))],2),t._v(" "),e("div",{staticClass:"user-motto"},[t._v(t._s(t.user.motto||"这个人很懒，什么都没留下..."))])])])]),t._v(" "),e("div",{staticClass:"profile-body"},[e("div",{staticClass:"left-panel"},[e("div",{staticClass:"card user-actions"},[e("div",{staticClass:"action-items"},["unbind"===t.user.email?e("div",{staticClass:"action-item",on:{click:t.activate}},[t._m(0),t._v(" "),e("div",{staticClass:"action-text warning"},[t._v("绑定邮箱")])]):t._e(),t._v(" "),e("div",{staticClass:"action-item",on:{click:t.viewUserProfile}},[t._m(1),t._v(" "),e("div",{staticClass:"action-text"},[t._v("个人名片")])]),t._v(" "),e("div",{staticClass:"action-item",on:{click:t.gotoMessages}},[e("div",{staticClass:"action-icon",class:{"new-message":t.hasNewMessage||t.hasNewPrivateMessage}},[e("i",{staticClass:"el-icon-message"})]),t._v(" "),e("div",{staticClass:"action-text"},[t._v("我的消息")])]),t._v(" "),e("div",{staticClass:"action-item",on:{click:t.gotoFriends}},[t._m(2),t._v(" "),e("div",{staticClass:"action-text"},[t._v("我的好友")])]),t._v(" "),e("div",{staticClass:"action-item",on:{click:t.gotoSettings}},[t._m(3),t._v(" "),e("div",{staticClass:"action-text"},[t._v("账号设置")])])])]),t._v(" "),e("div",{staticClass:"card tree-plant"},[e("div",{staticClass:"card-title"},[t._v("原木树场")]),t._v(" "),e("div",{staticClass:"tree-status",class:{warning:"未种植"===t.treeState||"结果"===t.treeState}},[e("i",{staticClass:"el-icon-tree"}),t._v(" "),e("span",[t._v("当前状态："+t._s(t.treeState))])]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.gotoTreePlant}},[t._v("进入树场")])],1),t._v(" "),e("div",{staticClass:"card balance"},[e("div",{staticClass:"card-title"},[t._v("账户余额")]),t._v(" "),e("div",{staticClass:"balance-amount"},[t._v(t._s(t.earningsMoney)+" 元")]),t._v(" "),e("el-button",{on:{click:t.gotoEarnings}},[t._v("余额提现")])],1)]),t._v(" "),e("div",{staticClass:"right-panel"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-title"},[t._v("社区功能")]),t._v(" "),e("div",{staticClass:"function-list"},[e("div",{staticClass:"function-item",on:{click:t.gotoCredits}},[e("i",{staticClass:"el-icon-medal"}),t._v(" "),e("span",[t._v("我的信誉")])]),t._v(" "),e("div",{staticClass:"function-item",on:{click:t.gotoRecharge}},[e("i",{staticClass:"el-icon-coin"}),t._v(" "),e("span",[t._v("支持社区")])]),t._v(" "),e("div",{staticClass:"function-item",on:{click:t.gotoAbout}},[e("i",{staticClass:"el-icon-info"}),t._v(" "),e("span",[t._v("关于社区")])]),t._v(" "),e("div",{staticClass:"function-item",on:{click:t.gotoFeedback}},[e("i",{staticClass:"el-icon-document"}),t._v(" "),e("span",[t._v("意见反馈")])]),t._v(" "),e("div",{staticClass:"function-item",on:{click:t.gotoClientSet}},[e("i",{staticClass:"el-icon-setting"}),t._v(" "),e("span",[t._v("设置")])]),t._v(" "),1===t.user.is_admin?e("div",{staticClass:"function-item",on:{click:t.gotoAdmin}},[e("i",{staticClass:"el-icon-s-tools"}),t._v(" "),e("span",[t._v("平台管理")])]):t._e()])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-title"},[t._v("我的作品")]),t._v(" "),t.userWorks&&0!==t.userWorks.length?e("div",{staticClass:"works-grid"},t._l(t.userWorks,(function(r){return e("div",{directives:[{name:"show",rawName:"v-show",value:!r.is_personal,expression:"!work.is_personal"}],key:r.novel_id,staticClass:"work-item",on:{click:function(e){return t.navigateToWork(r.novel_id)}}},[e("img",{staticClass:"work-cover",attrs:{src:r.picUrl,alt:"作品封面"}}),t._v(" "),e("div",{staticClass:"work-info"},[e("h3",{staticClass:"work-title"},[t._v(t._s(r.name))]),t._v(" "),e("p",{staticClass:"work-desc"},[t._v(t._s(r.content||"暂无简介"))])])])})),0):e("div",{staticClass:"empty-works"},[e("i",{staticClass:"el-icon-document"}),t._v(" "),e("p",[t._v("你还没有创作作品")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.gotoWrite}},[t._v("开始创作")])],1)]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-title"},[t._v("我的书架")]),t._v(" "),t.userBookcase&&0!==t.userBookcase.length?e("div",{staticClass:"bookcase-list"}):e("div",{staticClass:"empty-bookcase"},[e("i",{staticClass:"el-icon-collection"}),t._v(" "),e("p",[t._v("你的书架还是空的")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.gotoLibrary}},[t._v("去看书")])],1)])])])])}),[function(){var t=this._self._c;return t("div",{staticClass:"action-icon warning"},[t("i",{staticClass:"el-icon-warning-outline"})])},function(){var t=this._self._c;return t("div",{staticClass:"action-icon"},[t("i",{staticClass:"el-icon-user"})])},function(){var t=this._self._c;return t("div",{staticClass:"action-icon"},[t("i",{staticClass:"el-icon-user-solid"})])},function(){var t=this._self._c;return t("div",{staticClass:"action-icon"},[t("i",{staticClass:"el-icon-setting"})])}],!1,null,"3c2f45fe",null);e.default=component.exports}}]);