(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{538:function(t,o,r){var content=r(606);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(26).default)("06b2fa50",content,!0,{sourceMap:!1})},605:function(t,o,r){"use strict";r(538)},606:function(t,o,r){var e=r(25)(!1);e.push([t.i,".world-page[data-v-722a71b8]{max-width:1200px;margin:0 auto;padding:20px}.world-page .error-container[data-v-722a71b8]{text-align:center;padding:40px 0}.world-page .error-container p[data-v-722a71b8]{font-size:18px;color:#ff4d4f;margin-bottom:20px}.world-page .error-container .back-button[data-v-722a71b8]{display:inline-block;padding:8px 16px;background-color:#947358;color:#fff;border-radius:4px;text-decoration:none}.world-page .error-container .back-button[data-v-722a71b8]:hover{background-color:#704c35}.world-page .world-container[data-v-722a71b8]{background-color:#fff;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,.1);overflow:hidden}.world-page .world-container .world-header[data-v-722a71b8]{position:relative;display:flex;padding:30px;background-image:linear-gradient(to top, #ffffff, #fff2d0)}.world-page .world-container .world-header .world-cover[data-v-722a71b8]{width:180px;height:240px;border-radius:8px;background-size:cover;background-position:center;box-shadow:0 4px 12px rgba(0,0,0,.15);flex-shrink:0}.world-page .world-container .world-header .world-id-tag[data-v-722a71b8]{position:absolute;top:10px;left:10px;background-color:rgba(0,0,0,.6);color:#fff;padding:2px 8px;border-radius:4px;font-size:12px}.world-page .world-container .world-header .world-info[data-v-722a71b8]{margin-left:30px;flex-grow:1}.world-page .world-container .world-header .world-info .world-title[data-v-722a71b8]{font-size:28px;font-weight:bold;margin-bottom:15px;background-image:linear-gradient(to right, black, #947358);-webkit-background-clip:text;color:rgba(0,0,0,0)}.world-page .world-container .world-header .world-info .world-meta[data-v-722a71b8]{display:flex;align-items:center;margin-bottom:15px}.world-page .world-container .world-header .world-info .world-meta .author-info[data-v-722a71b8]{display:flex;align-items:center;cursor:pointer}.world-page .world-container .world-header .world-info .world-meta .author-info .author-avatar[data-v-722a71b8],.world-page .world-container .world-header .world-info .world-meta .author-info .author-avatar-placeholder[data-v-722a71b8]{width:40px;height:40px;border-radius:50%;margin-right:10px;object-fit:cover}.world-page .world-container .world-header .world-info .world-meta .author-info .author-avatar-placeholder[data-v-722a71b8]{background-color:#947358;color:#fff;display:flex;align-items:center;justify-content:center;font-size:18px}.world-page .world-container .world-header .world-info .world-meta .author-info .author-name[data-v-722a71b8]{font-size:16px;color:#666}.world-page .world-container .world-header .world-info .world-meta .author-info .author-name[data-v-722a71b8]:hover{color:#947358}.world-page .world-container .world-header .world-info .world-update-time[data-v-722a71b8]{font-size:14px;color:#999;margin-bottom:15px}.world-page .world-container .world-header .world-info .world-desc[data-v-722a71b8]{font-size:14px;color:#333;line-height:1.6;margin-bottom:20px;max-height:100px;overflow-y:auto}.world-page .world-container .world-header .world-info .edit-button[data-v-722a71b8]{display:inline-block;padding:8px 20px;background-color:#947358;color:#fff;border:1px solid #947358;border-radius:20px;font-size:14px;cursor:pointer;transition:all .3s}.world-page .world-container .world-header .world-info .edit-button[data-v-722a71b8]:hover{background-color:#704c35;border-color:#704c35}.world-page .world-container .world-content[data-v-722a71b8]{padding:20px 30px 30px}.world-page .world-container .world-content .world-section[data-v-722a71b8]{margin-top:10px}.world-page .world-container .world-content .world-section .section-header[data-v-722a71b8]{display:flex;align-items:center;margin:20px 0 15px}.world-page .world-container .world-content .world-section .section-header .section-line[data-v-722a71b8]{width:4px;height:18px;background-color:#947358;margin-right:10px}.world-page .world-container .world-content .world-section .section-header h3[data-v-722a71b8]{font-size:18px;color:#704c35;font-weight:bold;margin:0}.world-page .world-container .world-content .world-section .vocab-tags[data-v-722a71b8]{display:flex;flex-wrap:wrap;margin-top:15px}.world-page .world-container .world-content .world-section .vocab-tags .vocab-tag[data-v-722a71b8]{margin:0 10px 10px 0;cursor:pointer;background-color:rgba(148,115,88,.1);border-color:rgba(148,115,88,.2);color:#704c35}.world-page .world-container .world-content .world-section .vocab-tags .vocab-tag[data-v-722a71b8]:hover{background-color:rgba(148,115,88,.2);border-color:rgba(148,115,88,.3);color:#704c35}.world-page .world-container .world-content .associated-novels .novel-card[data-v-722a71b8]{display:flex;padding:15px;border-bottom:1px solid #f0f0f0;text-decoration:none;color:inherit}.world-page .world-container .world-content .associated-novels .novel-card[data-v-722a71b8]:last-child{border-bottom:none}.world-page .world-container .world-content .associated-novels .novel-card[data-v-722a71b8]:hover{background-color:#f9f9f9}.world-page .world-container .world-content .associated-novels .novel-card .novel-cover[data-v-722a71b8]{width:120px;height:160px;flex-shrink:0}.world-page .world-container .world-content .associated-novels .novel-card .novel-cover img[data-v-722a71b8]{width:100%;height:100%;object-fit:cover;border-radius:4px}.world-page .world-container .world-content .associated-novels .novel-card .novel-info[data-v-722a71b8]{margin-left:20px;flex-grow:1}.world-page .world-container .world-content .associated-novels .novel-card .novel-info .novel-title[data-v-722a71b8]{font-size:18px;font-weight:bold;margin-bottom:10px;display:flex;align-items:center}.world-page .world-container .world-content .associated-novels .novel-card .novel-info .novel-title .novel-tag[data-v-722a71b8]{font-size:12px;padding:2px 6px;background-color:#ffd591;color:#873800;border-radius:4px;margin-left:10px;font-weight:normal}.world-page .world-container .world-content .associated-novels .novel-card .novel-info .novel-author[data-v-722a71b8]{display:flex;align-items:center;margin-bottom:10px}.world-page .world-container .world-content .associated-novels .novel-card .novel-info .novel-author .author-avatar[data-v-722a71b8]{width:24px;height:24px;border-radius:50%;margin-right:8px}.world-page .world-container .world-content .associated-novels .novel-card .novel-info .novel-author .author-name[data-v-722a71b8]{font-size:14px;color:#666}.world-page .world-container .world-content .associated-novels .novel-card .novel-info .novel-desc[data-v-722a71b8]{font-size:14px;color:#999;line-height:1.5;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3}.world-page .world-container .world-content .nothing[data-v-722a71b8]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 0}.world-page .world-container .world-content .nothing .nothing-img[data-v-722a71b8]{width:80px;height:80px;opacity:.5;margin-bottom:15px}.world-page .world-container .world-content .nothing .nothing-text[data-v-722a71b8]{font-size:14px;color:#999}@media(max-width: 768px){.world-page[data-v-722a71b8]{padding:10px}.world-page .world-container .world-header[data-v-722a71b8]{flex-direction:column;padding:20px}.world-page .world-container .world-header .world-cover[data-v-722a71b8]{width:120px;height:160px;margin-bottom:20px}.world-page .world-container .world-header .world-info[data-v-722a71b8]{margin-left:0}.world-page .world-container .world-header .world-info .world-title[data-v-722a71b8]{font-size:22px}.world-page .world-container .world-content[data-v-722a71b8]{padding:15px}}[data-v-722a71b8] .el-tabs__active-bar{background-color:#947358}[data-v-722a71b8] .el-tabs__item:hover{color:#947358}[data-v-722a71b8] .el-tabs__item.is-active{color:#947358}[data-v-722a71b8] .el-collapse-item__header:hover{color:#947358}[data-v-722a71b8] .el-collapse-item__header.is-active{color:#947358;border-bottom-color:#947358}[data-v-722a71b8] .el-collapse-item__wrap{border-bottom-color:#ebeef5}",""]),t.exports=e},638:function(t,o,r){"use strict";r.r(o);r(27);var e=r(0);r(6),r(18),r(28),r(10),r(17),r(41),r(34),r(35);function n(t,o){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,a){if(t){if("string"==typeof t)return l(t,a);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?l(t,a):void 0}}(t))||o&&t&&"number"==typeof t.length){r&&(t=r);var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,d=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw d}}}}function l(t,a){(null==a||a>t.length)&&(a=t.length);for(var o=0,r=Array(a);o<a;o++)r[o]=t[o];return r}var d={head:function(){return{title:this.world?"".concat(this.world.name," - 世界设定 - 原木社区"):"世界设定 - 原木社区",meta:[{hid:"description",name:"description",content:this.world?this.truncateText(this.world.content,150):"原木社区世界设定"}]}},asyncData:function(t){return Object(e.a)(regeneratorRuntime.mark((function o(){var r,e,l,d,c,w,v,f,h,x,m,_;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=t.params,e=t.$api,t.error,o.prev=1,l=r.id,o.next=5,e.novels.getNovelById(l);case 5:if((d=o.sent)&&0!==d.length){o.next=8;break}return o.abrupt("return",{error:"未找到该世界设定"});case 8:return(c=d[0]).author_name&&!c.user_name&&(c.user_name=c.author_name),o.next=12,e.articles.getArticles(c.novel_id);case 12:if(o.t0=o.sent,o.t0){o.next=15;break}o.t0=[];case 15:return w=o.t0,v=w.filter((function(t){return"worldOutline"===t.article_type})),f=w.filter((function(t){return"worldVocabulary"===t.article_type})),o.next=20,e.worlds.getAssoWorldByWorldId(c.novel_id);case 20:if(o.t1=o.sent,o.t1){o.next=23;break}o.t1=[];case 23:h=o.t1,x=n(h);try{for(x.s();!(m=x.n()).done;)(_=m.value).author_name&&!_.user_name&&(_.user_name=_.author_name)}catch(t){x.e(t)}finally{x.f()}return o.abrupt("return",{world:c,worldOutlines:v,worldVocabs:f,assoNovels:h});case 29:return o.prev=29,o.t2=o.catch(1),console.error("获取世界设定失败:",o.t2),o.abrupt("return",{error:"获取世界设定失败"});case 33:case"end":return o.stop()}}),o,null,[[1,29]])})))()},data:function(){return{error:null,world:null,worldOutlines:[],worldVocabs:[],assoNovels:[],userInfo:null}},computed:{isCreator:function(){return this.userInfo&&this.world&&this.userInfo.user_id===this.world.creator_id}},mounted:function(){this.getUserInfo()},methods:{getUserInfo:function(){var t=this;return Object(e.a)(regeneratorRuntime.mark((function o(){var r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,t.$store.state.auth.token){o.next=4;break}return o.abrupt("return");case 4:return o.next=6,t.$api.users.getUserProfile();case 6:r=o.sent,t.userInfo=r,t.checkCreatorPermission(),o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),console.error("获取用户信息失败:",o.t0);case 14:case"end":return o.stop()}}),o,null,[[0,11]])})))()},formatDate:function(t){return t?new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""},truncateText:function(text,t){return text?text.length<=t?text:text.substring(0,t)+"...":""},gotoUserProfile:function(t){t&&this.$router.push("/users/".concat(t))},gotoArticle:function(t){this.$router.push("/article/".concat(t))},editWorld:function(t){this.$router.push("/write/edit/".concat(t,"?worldId=").concat(this.world.world_id))},checkCreatorPermission:function(){this.userInfo&&this.world&&(this.isCreator=this.userInfo.user_id===this.world.creator_id)}}},c=(r(605),r(12)),component=Object(c.a)(d,(function(){var t=this,o=t._self._c;return o("div",{staticClass:"world-page"},[t.error?o("div",{staticClass:"error-container"},[o("p",[t._v(t._s(t.error))]),t._v(" "),o("nuxt-link",{staticClass:"back-button",attrs:{to:"/read"}},[t._v("返回阅读列表")])],1):t._e(),t._v(" "),!t.error&&t.world?o("div",{staticClass:"world-container"},[o("div",{staticClass:"world-header"},[t.world.picUrl?o("div",{staticClass:"world-cover",style:"background-image: url(".concat(t.world.picUrl,")")}):o("div",{staticClass:"world-cover",style:"background-color: hsl(".concat(30*t.world.novel_id%360,", 70%, 80%)")}),t._v(" "),o("div",{staticClass:"world-id-tag"},[t._v("ID "+t._s(t.world.novel_id))]),t._v(" "),o("div",{staticClass:"world-info"},[o("h1",{staticClass:"world-title"},[t._v(t._s(t.world.name))]),t._v(" "),o("div",{staticClass:"world-meta"},[o("div",{staticClass:"author-info",on:{click:function(o){return t.gotoUserProfile(t.world.author_id||t.world.creator_id)}}},[t.world.avatar_url||t.world.auther_avatar?o("img",{staticClass:"author-avatar",attrs:{src:t.world.avatar_url||t.world.auther_avatar,alt:"作者头像",onerror:"this.onerror=null;this.src='/static/default-avatar.png'"}}):o("div",{staticClass:"author-avatar-placeholder"},[t._v(t._s(t.world.user_name?t.world.user_name.charAt(0):"作"))]),t._v(" "),o("span",{staticClass:"author-name"},[t._v(t._s(t.world.user_name||t.world.author_name||"佚名"))])])]),t._v(" "),o("div",{staticClass:"world-update-time"},[t._v("\n          最近更新："+t._s(t.formatDate(t.world.update_time))+"\n        ")]),t._v(" "),o("div",{staticClass:"world-desc"},[t._v("\n          "+t._s(t.world.content)+"\n        ")]),t._v(" "),t.isCreator?o("div",{staticClass:"edit-button",on:{click:function(o){return t.editWorld(t.world.novel_id)}}},[t._v("\n          编辑设定\n        ")]):t._e()])]),t._v(" "),o("div",{staticClass:"world-content"},[o("el-tabs",[o("el-tab-pane",{attrs:{label:"世界设定"}},[o("div",{staticClass:"world-section"},[o("div",{staticClass:"section-header"},[o("div",{staticClass:"section-line"}),t._v(" "),o("h3",[t._v("世界大纲")])]),t._v(" "),t.worldOutlines.length>0?o("el-collapse",{attrs:{accordion:""}},t._l(t.worldOutlines,(function(r){return o("el-collapse-item",{key:r.article_id,attrs:{title:r.title,name:r.article_id}},[o("div",{staticClass:"article-content",on:{click:function(o){return t.gotoArticle(r.article_id)}}},[t._v("\n                  查看详情\n                ")])])})),1):o("div",{staticClass:"nothing"},[o("img",{staticClass:"nothing-img",attrs:{src:"/static/default-avatar.png",alt:"暂无内容"}}),t._v(" "),o("p",{staticClass:"nothing-text"},[t._v("这是一片什么都没有的荒原")])]),t._v(" "),o("div",{staticClass:"section-header"},[o("div",{staticClass:"section-line"}),t._v(" "),o("h3",[t._v("世界词条")])]),t._v(" "),t.worldVocabs.length>0?o("div",{staticClass:"vocab-tags"},t._l(t.worldVocabs,(function(r){return o("el-tag",{key:r.article_id,staticClass:"vocab-tag",on:{click:function(o){return t.gotoArticle(r.article_id)}}},[t._v("\n                "+t._s(r.title)+"\n              ")])})),1):o("div",{staticClass:"nothing"},[o("img",{staticClass:"nothing-img",attrs:{src:"/static/default-avatar.png",alt:"暂无内容"}}),t._v(" "),o("p",{staticClass:"nothing-text"},[t._v("这是一片什么都没有的荒原")])])],1)]),t._v(" "),o("el-tab-pane",{attrs:{label:"关联作品"}},[t.assoNovels.length>0?o("div",{staticClass:"associated-novels"},t._l(t.assoNovels,(function(r){return o("nuxt-link",{key:r.novel_id,staticClass:"novel-card",attrs:{to:"/novel/".concat(r.novel_id)}},[o("div",{staticClass:"novel-cover"},[o("img",{attrs:{src:r.picUrl?r.picUrl+"?thumbnail=1":"/static/user/defaultCover.jpg",alt:r.name,onerror:"this.onerror=null;this.src='/static/user/defaultCover.jpg'"}})]),t._v(" "),o("div",{staticClass:"novel-info"},[o("h4",{staticClass:"novel-title"},[t._v("\n                  "+t._s(r.name)+"\n                  "),"world"===r.novel_type?o("span",{staticClass:"novel-tag"},[t._v("世界设定")]):t._e()]),t._v(" "),o("div",{staticClass:"novel-author"},[o("img",{staticClass:"author-avatar",attrs:{src:r.avatar_url||r.auther_avatar||"/static/default-avatar.png",alt:"作者头像",onerror:"this.onerror=null;this.src='/static/default-avatar.png'"}}),t._v(" "),o("span",{staticClass:"author-name"},[t._v(t._s(r.user_name||r.author_name||"佚名"))])]),t._v(" "),o("p",{staticClass:"novel-desc"},[t._v(t._s(t.truncateText(r.content,100)))])])])})),1):o("div",{staticClass:"nothing"},[o("img",{staticClass:"nothing-img",attrs:{src:"/static/default-avatar.png",alt:"暂无内容"}}),t._v(" "),o("p",{staticClass:"nothing-text"},[t._v("这是一片什么都没有的荒原")])])])],1)],1)]):t._e()])}),[],!1,null,"722a71b8",null);o.default=component.exports}}]);